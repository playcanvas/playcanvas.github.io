/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { EventHandler } from '../../core/event-handler.js';
import { Color } from '../../core/math/color.js';
import { Vec2 } from '../../core/math/vec2.js';
import { Vec3 } from '../../core/math/vec3.js';
import { Vec4 } from '../../core/math/vec4.js';

class ComponentSystem extends EventHandler {
  constructor(app) {
    super();
    this.app = app;

    this.store = {};
    this.schema = [];
  }

  addComponent(entity, data = {}) {
    const component = new this.ComponentType(this, entity);
    const componentData = new this.DataType();
    this.store[entity.getGuid()] = {
      entity: entity,
      data: componentData
    };
    entity[this.id] = component;
    entity.c[this.id] = component;
    this.initializeComponentData(component, data, []);
    this.fire('add', entity, component);
    return component;
  }

  removeComponent(entity) {
    const record = this.store[entity.getGuid()];
    const component = entity.c[this.id];
    this.fire('beforeremove', entity, component);
    delete this.store[entity.getGuid()];
    entity[this.id] = undefined;
    delete entity.c[this.id];
    this.fire('remove', entity, record.data);
  }

  cloneComponent(entity, clone) {
    const src = this.store[entity.getGuid()];
    return this.addComponent(clone, src.data);
  }

  initializeComponentData(component, data = {}, properties) {
    for (let i = 0, len = properties.length; i < len; i++) {
      const descriptor = properties[i];
      let name, type;

      if (typeof descriptor === 'object') {
        name = descriptor.name;
        type = descriptor.type;
      } else {
        name = descriptor;
        type = undefined;
      }
      let value = data[name];
      if (value !== undefined) {
        if (type !== undefined) {
          value = convertValue(value, type);
        }
        component[name] = value;
      } else {
        component[name] = component.data[name];
      }
    }

    if (component.enabled && component.entity.enabled) {
      component.onEnable();
    }
  }

  getPropertiesOfType(type) {
    const matchingProperties = [];
    const schema = this.schema || [];
    schema.forEach(function (descriptor) {
      if (descriptor && typeof descriptor === 'object' && descriptor.type === type) {
        matchingProperties.push(descriptor);
      }
    });
    return matchingProperties;
  }
  destroy() {
    this.off();
  }
}
function convertValue(value, type) {
  if (!value) {
    return value;
  }
  switch (type) {
    case 'rgb':
      if (value instanceof Color) {
        return value.clone();
      }
      return new Color(value[0], value[1], value[2]);
    case 'rgba':
      if (value instanceof Color) {
        return value.clone();
      }
      return new Color(value[0], value[1], value[2], value[3]);
    case 'vec2':
      if (value instanceof Vec2) {
        return value.clone();
      }
      return new Vec2(value[0], value[1]);
    case 'vec3':
      if (value instanceof Vec3) {
        return value.clone();
      }
      return new Vec3(value[0], value[1], value[2]);
    case 'vec4':
      if (value instanceof Vec4) {
        return value.clone();
      }
      return new Vec4(value[0], value[1], value[2], value[3]);
    case 'boolean':
    case 'number':
    case 'string':
      return value;
    case 'entity':
      return value;
    default:
      throw new Error('Could not convert unhandled type: ' + type);
  }
}

export { ComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV2ZW50SGFuZGxlciB9IGZyb20gJy4uLy4uL2NvcmUvZXZlbnQtaGFuZGxlci5qcyc7XG5cbmltcG9ydCB7IENvbG9yIH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL2NvbG9yLmpzJztcbmltcG9ydCB7IFZlYzIgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgvdmVjMi5qcyc7XG5pbXBvcnQgeyBWZWMzIH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL3ZlYzMuanMnO1xuaW1wb3J0IHsgVmVjNCB9IGZyb20gJy4uLy4uL2NvcmUvbWF0aC92ZWM0LmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gQXBwQmFzZSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50LmpzJykuQ29tcG9uZW50fSBDb21wb25lbnQgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi9lbnRpdHkuanMnKS5FbnRpdHl9IEVudGl0eSAqL1xuXG4vKipcbiAqIENvbXBvbmVudCBTeXN0ZW1zIGNvbnRhaW4gdGhlIGxvZ2ljIGFuZCBmdW5jdGlvbmFsaXR5IHRvIHVwZGF0ZSBhbGwgQ29tcG9uZW50cyBvZiBhIHBhcnRpY3VsYXJcbiAqIHR5cGUuXG4gKlxuICogQGF1Z21lbnRzIEV2ZW50SGFuZGxlclxuICovXG5jbGFzcyBDb21wb25lbnRTeXN0ZW0gZXh0ZW5kcyBFdmVudEhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBDb21wb25lbnRTeXN0ZW0gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FwcEJhc2V9IGFwcCAtIFRoZSBhcHBsaWNhdGlvbiBtYW5hZ2luZyB0aGlzIHN5c3RlbS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcblxuICAgICAgICAvLyBUaGUgc3RvcmUgd2hlcmUgYWxsIENvbXBvbmVudERhdGEgb2JqZWN0cyBhcmUga2VwdFxuICAgICAgICB0aGlzLnN0b3JlID0ge307XG4gICAgICAgIHRoaXMuc2NoZW1hID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIG5ldyB7QGxpbmsgQ29tcG9uZW50fSBhbmQgY29tcG9uZW50IGRhdGEgaW5zdGFuY2VzIGFuZCBhdHRhY2ggdGhlbSB0byB0aGUgZW50aXR5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSAtIFRoZSBFbnRpdHkgdG8gYXR0YWNoIHRoaXMgY29tcG9uZW50IHRvLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbZGF0YV0gLSBUaGUgc291cmNlIGRhdGEgd2l0aCB3aGljaCB0byBjcmVhdGUgdGhlIGNvbXBvbmVudC5cbiAgICAgKiBAcmV0dXJucyB7Q29tcG9uZW50fSBSZXR1cm5zIGEgQ29tcG9uZW50IG9mIHR5cGUgZGVmaW5lZCBieSB0aGUgY29tcG9uZW50IHN5c3RlbS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBlbnRpdHkgPSBuZXcgcGMuRW50aXR5KGFwcCk7XG4gICAgICogYXBwLnN5c3RlbXMubW9kZWwuYWRkQ29tcG9uZW50KGVudGl0eSwgeyB0eXBlOiAnYm94JyB9KTtcbiAgICAgKiAvLyBlbnRpdHkubW9kZWwgaXMgbm93IHNldCB0byBhIHBjLk1vZGVsQ29tcG9uZW50XG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGFkZENvbXBvbmVudChlbnRpdHksIGRhdGEgPSB7fSkge1xuICAgICAgICBjb25zdCBjb21wb25lbnQgPSBuZXcgdGhpcy5Db21wb25lbnRUeXBlKHRoaXMsIGVudGl0eSk7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudERhdGEgPSBuZXcgdGhpcy5EYXRhVHlwZSgpO1xuXG4gICAgICAgIHRoaXMuc3RvcmVbZW50aXR5LmdldEd1aWQoKV0gPSB7XG4gICAgICAgICAgICBlbnRpdHk6IGVudGl0eSxcbiAgICAgICAgICAgIGRhdGE6IGNvbXBvbmVudERhdGFcbiAgICAgICAgfTtcblxuICAgICAgICBlbnRpdHlbdGhpcy5pZF0gPSBjb21wb25lbnQ7XG4gICAgICAgIGVudGl0eS5jW3RoaXMuaWRdID0gY29tcG9uZW50O1xuXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBbXSk7XG5cbiAgICAgICAgdGhpcy5maXJlKCdhZGQnLCBlbnRpdHksIGNvbXBvbmVudCk7XG5cbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIHtAbGluayBDb21wb25lbnR9IGZyb20gdGhlIGVudGl0eSBhbmQgZGVsZXRlIHRoZSBhc3NvY2lhdGVkIGNvbXBvbmVudCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSAtIFRoZSBlbnRpdHkgdG8gcmVtb3ZlIHRoZSBjb21wb25lbnQgZnJvbS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGFwcC5zeXN0ZW1zLm1vZGVsLnJlbW92ZUNvbXBvbmVudChlbnRpdHkpO1xuICAgICAqIC8vIGVudGl0eS5tb2RlbCA9PT0gdW5kZWZpbmVkXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIHJlbW92ZUNvbXBvbmVudChlbnRpdHkpIHtcbiAgICAgICAgY29uc3QgcmVjb3JkID0gdGhpcy5zdG9yZVtlbnRpdHkuZ2V0R3VpZCgpXTtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZW50aXR5LmNbdGhpcy5pZF07XG5cbiAgICAgICAgdGhpcy5maXJlKCdiZWZvcmVyZW1vdmUnLCBlbnRpdHksIGNvbXBvbmVudCk7XG5cbiAgICAgICAgZGVsZXRlIHRoaXMuc3RvcmVbZW50aXR5LmdldEd1aWQoKV07XG5cbiAgICAgICAgZW50aXR5W3RoaXMuaWRdID0gdW5kZWZpbmVkO1xuICAgICAgICBkZWxldGUgZW50aXR5LmNbdGhpcy5pZF07XG5cbiAgICAgICAgdGhpcy5maXJlKCdyZW1vdmUnLCBlbnRpdHksIHJlY29yZC5kYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBjbG9uZSBvZiBjb21wb25lbnQuIFRoaXMgY3JlYXRlcyBhIGNvcHkgb2YgYWxsIGNvbXBvbmVudCBkYXRhIHZhcmlhYmxlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgLSBUaGUgZW50aXR5IHRvIGNsb25lIHRoZSBjb21wb25lbnQgZnJvbS5cbiAgICAgKiBAcGFyYW0ge0VudGl0eX0gY2xvbmUgLSBUaGUgZW50aXR5IHRvIGNsb25lIHRoZSBjb21wb25lbnQgaW50by5cbiAgICAgKiBAcmV0dXJucyB7Q29tcG9uZW50fSBUaGUgbmV3bHkgY2xvbmVkIGNvbXBvbmVudC5cbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgY2xvbmVDb21wb25lbnQoZW50aXR5LCBjbG9uZSkge1xuICAgICAgICAvLyBkZWZhdWx0IGNsb25lIGlzIGp1c3QgdG8gYWRkIGEgbmV3IGNvbXBvbmVudCB3aXRoIGV4aXN0aW5nIGRhdGFcbiAgICAgICAgY29uc3Qgc3JjID0gdGhpcy5zdG9yZVtlbnRpdHkuZ2V0R3VpZCgpXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkQ29tcG9uZW50KGNsb25lLCBzcmMuZGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGR1cmluZyB7QGxpbmsgQ29tcG9uZW50U3lzdGVtI2FkZENvbXBvbmVudH0gdG8gaW5pdGlhbGl6ZSB0aGUgY29tcG9uZW50IGRhdGEgaW4gdGhlXG4gICAgICogc3RvcmUuIFRoaXMgY2FuIGJlIG92ZXJyaWRkZW4gYnkgZGVyaXZlZCBDb21wb25lbnQgU3lzdGVtcyBhbmQgZWl0aGVyIGNhbGxlZCBieSB0aGUgZGVyaXZlZFxuICAgICAqIFN5c3RlbSBvciByZXBsYWNlZCBlbnRpcmVseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q29tcG9uZW50fSBjb21wb25lbnQgLSBUaGUgY29tcG9uZW50IGJlaW5nIGluaXRpYWxpemVkLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gVGhlIGRhdGEgYmxvY2sgdXNlZCB0byBpbml0aWFsaXplIHRoZSBjb21wb25lbnQuXG4gICAgICogQHBhcmFtIHtBcnJheTxzdHJpbmcgfCB7bmFtZTogc3RyaW5nLCB0eXBlOiBzdHJpbmd9Pn0gcHJvcGVydGllcyAtIFRoZSBhcnJheSBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3IgdGhlIGNvbXBvbmVudC5cbiAgICAgKiBBIGRlc2NyaXB0b3IgY2FuIGJlIGVpdGhlciBhIHBsYWluIHByb3BlcnR5IG5hbWUsIG9yIGFuIG9iamVjdCBzcGVjaWZ5aW5nIHRoZSBuYW1lIGFuZCB0eXBlLlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBpbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEgPSB7fSwgcHJvcGVydGllcykge1xuICAgICAgICAvLyBpbml0aWFsaXplXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBwcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gcHJvcGVydGllc1tpXTtcbiAgICAgICAgICAgIGxldCBuYW1lLCB0eXBlO1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgZGVzY3JpcHRvciBpcyBhbiBvYmplY3QsIGl0IHdpbGwgaGF2ZSBgbmFtZWAgYW5kIGB0eXBlYCBtZW1iZXJzXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRlc2NyaXB0b3IgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IGRlc2NyaXB0b3IubmFtZTtcbiAgICAgICAgICAgICAgICB0eXBlID0gZGVzY3JpcHRvci50eXBlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBkZXNjcmlwdG9yIGlzIGp1c3QgdGhlIHByb3BlcnR5IG5hbWVcbiAgICAgICAgICAgICAgICBuYW1lID0gZGVzY3JpcHRvcjtcbiAgICAgICAgICAgICAgICB0eXBlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBkYXRhW25hbWVdO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIGtub3cgdGhlIGludGVuZGVkIHR5cGUgb2YgdGhlIHZhbHVlLCBjb252ZXJ0IHRoZSByYXcgZGF0YVxuICAgICAgICAgICAgICAgIC8vIGludG8gYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWNpZmllZCB0eXBlLlxuICAgICAgICAgICAgICAgIGlmICh0eXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjb252ZXJ0VmFsdWUodmFsdWUsIHR5cGUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbXBvbmVudFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRbbmFtZV0gPSBjb21wb25lbnQuZGF0YVtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFmdGVyIGNvbXBvbmVudCBpcyBpbml0aWFsaXplZCBjYWxsIG9uRW5hYmxlXG4gICAgICAgIGlmIChjb21wb25lbnQuZW5hYmxlZCAmJiBjb21wb25lbnQuZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5vbkVuYWJsZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VhcmNoZXMgdGhlIGNvbXBvbmVudCBzY2hlbWEgZm9yIHByb3BlcnRpZXMgdGhhdCBtYXRjaCB0aGUgc3BlY2lmaWVkIHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSB0eXBlIHRvIHNlYXJjaCBmb3IuXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfG9iamVjdFtdfSBBbiBhcnJheSBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyBtYXRjaGluZyB0aGUgc3BlY2lmaWVkIHR5cGUuXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGdldFByb3BlcnRpZXNPZlR5cGUodHlwZSkge1xuICAgICAgICBjb25zdCBtYXRjaGluZ1Byb3BlcnRpZXMgPSBbXTtcbiAgICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy5zY2hlbWEgfHwgW107XG5cbiAgICAgICAgc2NoZW1hLmZvckVhY2goZnVuY3Rpb24gKGRlc2NyaXB0b3IpIHtcbiAgICAgICAgICAgIGlmIChkZXNjcmlwdG9yICYmIHR5cGVvZiBkZXNjcmlwdG9yID09PSAnb2JqZWN0JyAmJiBkZXNjcmlwdG9yLnR5cGUgPT09IHR5cGUpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGluZ1Byb3BlcnRpZXMucHVzaChkZXNjcmlwdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIG1hdGNoaW5nUHJvcGVydGllcztcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLm9mZigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY29udmVydFZhbHVlKHZhbHVlLCB0eXBlKSB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ3JnYic6XG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBDb2xvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5jbG9uZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcih2YWx1ZVswXSwgdmFsdWVbMV0sIHZhbHVlWzJdKTtcbiAgICAgICAgY2FzZSAncmdiYSc6XG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBDb2xvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5jbG9uZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xvcih2YWx1ZVswXSwgdmFsdWVbMV0sIHZhbHVlWzJdLCB2YWx1ZVszXSk7XG4gICAgICAgIGNhc2UgJ3ZlYzInOlxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVmVjMikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5jbG9uZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWZWMyKHZhbHVlWzBdLCB2YWx1ZVsxXSk7XG4gICAgICAgIGNhc2UgJ3ZlYzMnOlxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVmVjMykge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5jbG9uZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWZWMzKHZhbHVlWzBdLCB2YWx1ZVsxXSwgdmFsdWVbMl0pO1xuICAgICAgICBjYXNlICd2ZWM0JzpcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFZlYzQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUuY2xvbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgVmVjNCh2YWx1ZVswXSwgdmFsdWVbMV0sIHZhbHVlWzJdLCB2YWx1ZVszXSk7XG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICBjYXNlICdlbnRpdHknOlxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlOyAvLyBFbnRpdHkgZmllbGRzIHNob3VsZCBqdXN0IGJlIGEgc3RyaW5nIGd1aWRcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGNvbnZlcnQgdW5oYW5kbGVkIHR5cGU6ICcgKyB0eXBlKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IENvbXBvbmVudFN5c3RlbSB9O1xuIl0sIm5hbWVzIjpbIkNvbXBvbmVudFN5c3RlbSIsIkV2ZW50SGFuZGxlciIsImNvbnN0cnVjdG9yIiwiYXBwIiwic3RvcmUiLCJzY2hlbWEiLCJhZGRDb21wb25lbnQiLCJlbnRpdHkiLCJkYXRhIiwiY29tcG9uZW50IiwiQ29tcG9uZW50VHlwZSIsImNvbXBvbmVudERhdGEiLCJEYXRhVHlwZSIsImdldEd1aWQiLCJpZCIsImMiLCJpbml0aWFsaXplQ29tcG9uZW50RGF0YSIsImZpcmUiLCJyZW1vdmVDb21wb25lbnQiLCJyZWNvcmQiLCJ1bmRlZmluZWQiLCJjbG9uZUNvbXBvbmVudCIsImNsb25lIiwic3JjIiwicHJvcGVydGllcyIsImkiLCJsZW4iLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwibmFtZSIsInR5cGUiLCJ2YWx1ZSIsImNvbnZlcnRWYWx1ZSIsImVuYWJsZWQiLCJvbkVuYWJsZSIsImdldFByb3BlcnRpZXNPZlR5cGUiLCJtYXRjaGluZ1Byb3BlcnRpZXMiLCJmb3JFYWNoIiwicHVzaCIsImRlc3Ryb3kiLCJvZmYiLCJDb2xvciIsIlZlYzIiLCJWZWMzIiwiVmVjNCIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWlCQSxNQUFNQSxlQUFlLFNBQVNDLFlBQVksQ0FBQztFQU12Q0MsV0FBVyxDQUFDQyxHQUFHLEVBQUU7QUFDYixJQUFBLEtBQUssRUFBRSxDQUFBO0lBRVAsSUFBSSxDQUFDQSxHQUFHLEdBQUdBLEdBQUcsQ0FBQTs7QUFHZCxJQUFBLElBQUks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
