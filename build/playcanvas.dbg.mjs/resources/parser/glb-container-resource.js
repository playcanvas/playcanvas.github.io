/**
 * @license
 * PlayCanvas Engine v1.58.0-dev revision e102f2b2a (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Asset } from '../../asset/asset.js';
import { Entity } from '../../framework/entity.js';
import { MeshInstance } from '../../scene/mesh-instance.js';
import { MorphInstance } from '../../scene/morph-instance.js';
import { SkinInstance } from '../../scene/skin-instance.js';
import { SkinInstanceCache } from '../../scene/skin-instance-cache.js';
import { Model } from '../../scene/model.js';
import { Debug } from '../../core/debug.js';

class GlbContainerResource {
  constructor(data, asset, assets, defaultMaterial) {
    const createAsset = function createAsset(type, resource, index) {
      const subAsset = GlbContainerResource.createAsset(asset.name, type, resource, index);
      assets.add(subAsset);
      return subAsset;
    };

    const renders = [];

    for (let i = 0; i < data.renders.length; ++i) {
      renders.push(createAsset('render', data.renders[i], i));
    }

    const materials = [];

    for (let i = 0; i < data.materials.length; ++i) {
      materials.push(createAsset('material', data.materials[i], i));
    }

    const animations = [];

    for (let i = 0; i < data.animations.length; ++i) {
      animations.push(createAsset('animation', data.animations[i], i));
    }

    this.data = data;
    this._model = null;
    this._assetName = asset.name;
    this._assets = assets;
    this._defaultMaterial = defaultMaterial;
    this.renders = renders;
    this.materials = materials;
    this.textures = data.textures;
    this.animations = animations;
  }

  get model() {
    if (!this._model) {
      const model = GlbContainerResource.createModel(this.data, this._defaultMaterial);
      const modelAsset = GlbContainerResource.createAsset(this._assetName, 'model', model, 0);

      this._assets.add(modelAsset);

      this._model = modelAsset;
    }

    return this._model;
  }

  static createAsset(assetName, type, resource, index) {
    const subAsset = new Asset(assetName + '/' + type + '/' + index, type, {
      url: ''
    });
    subAsset.resource = resource;
    subAsset.loaded = true;
    return subAsset;
  }

  instantiateModelEntity(options) {
    const entity = new Entity();
    entity.addComponent('model', Object.assign({
      type: 'asset',
      asset: this.model
    }, options));
    return entity;
  }

  instantiateRenderEntity(options) {
    const defaultMaterial = this._defaultMaterial;
    const skinnedMeshInstances = [];

    const createMeshInstance = function createMeshInstance(root, entity, mesh, materials, meshDefaultMaterials, skins, gltfNode) {
      const materialIndex = meshDefaultMaterials[mesh.id];
      const material = materialIndex === undefined ? defaultMaterial : materials[materialIndex];
      const meshInstance = new MeshInstance(mesh, material);

      if (mesh.morph) {
        meshInstance.morphInstance = new MorphInstance(mesh.morph);
      }

      if (gltfNode.hasOwnProperty('skin')) {
        skinnedMeshInstances.push({
          meshInstance: meshInstance,
          rootBone: root,
          entity: entity
        });
      }

      return meshInstance;
    };

    const cloneHierarchy = (root, node, glb) => {
      const entity = new Entity();

      node._cloneInternal(entity);

      if (!root) root = entity;
      let attachedMi = null;
      let renderAsset = null;

      for (let i = 0; i < glb.nodes.length; i++) {
        const glbNode = glb.nodes[i];

        if (glbNode === node) {
          const gltfNode = glb.gltf.nodes[i];

          if (gltfNode.hasOwnProperty('mesh')) {
            const meshGroup = glb.renders[gltfNode.mesh].meshes;
            renderAsset = this.renders[gltfNode.mesh];

            for (var mi = 0; mi < meshGroup.length; mi++) {
              const mesh = meshGroup[mi];

              if (mesh) {
                const cloneMi = createMeshInstance(root, entity, mesh, glb.materials, glb.meshDefaultMaterials, glb.skins, gltfNode);

                if (!attachedMi) {
                  attachedMi = [];
                }

                attachedMi.push(cloneMi);
              }
            }
          }

          if (glb.lights) {
            const lightEntity = glb.lights.get(gltfNode);

            if (lightEntity) {
              entity.addChild(lightEntity.clone());
            }
          }

          if (glb.cameras) {
            const cameraEntity = glb.cameras.get(gltfNode);

            if (cameraEntity) {
              cameraEntity.camera.system.cloneComponent(cameraEntity, entity);
            }
          }
        }
      }

      if (attachedMi) {
        entity.addComponent('render', Object.assign({
          type: 'asset',
          meshInstances: attachedMi,
          rootBone: root
        }, options));
        entity.render.assignAsset(renderAsset);
      }

      const children = node.children;

      for (let i = 0; i < children.length; i++) {
        const childClone = cloneHierarchy(root, children[i], glb);
        entity.addChild(childClone);
      }

      return entity;
    };

    const sceneClones = [];

    for (const scene of this.data.scenes) {
      sceneClones.push(cloneHierarchy(null, scene, this.data));
    }

    skinnedMeshInstances.forEach(data => {
      data.meshInstance.skinInstance = SkinInstanceCache.createCachedSkinInstance(data.meshInstance.mesh.skin, data.rootBone, data.entity);
    });
    return GlbContainerResource.createSceneHierarchy(sceneClones, 'Entity');
  }

  getMaterialVariants() {
    return this.data.variants ? Object.keys(this.data.variants) : [];
  }

  applyMaterialVariant(entity, name) {
    const variant = name ? this.data.variants[name] : null;

    if (variant === undefined) {
      Debug.warn(`No variant named ${name} exists in resource`);
      return;
    }

    const renders = entity.findComponents("render");

    for (let i = 0; i < renders.length; i++) {
      const renderComponent = renders[i];

      this._applyMaterialVariant(variant, renderComponent.meshInstances);
    }
  }

  applyMaterialVariantInstances(instances, name) {
    const variant = name ? this.data.variants[name] : null;

    if (variant === undefined) {
      Debug.warn(`No variant named ${name} exists in resource`);
      return;
    }

    this._applyMaterialVariant(variant, instances);
  }

  _applyMaterialVariant(variant, instances) {
    instances.forEach(instance => {
      if (variant === null) {
        instance.material = this._defaultMaterial;
      } else {
        const meshVariants = this.data.meshVariants[instance.mesh.id];

        if (meshVariants) {
          instance.material = this.data.materials[meshVariants[variant]];
        }
      }

      Debug.assert(instance.material);
    });
  }

  static createSceneHierarchy(sceneNodes, nodeType) {
    let root = null;

    if (sceneNodes.length === 1) {
      root = sceneNodes[0];
    } else {
      root = new nodeType('SceneGroup');

      for (const scene of sceneNodes) {
        root.addChild(scene);
      }
    }

    return root;
  }

  static createModel(glb, defaultMaterial) {
    const createMeshInstance = function createMeshInstance(model, mesh, skins, skinInstances, materials, node, gltfNode) {
      const materialIndex = glb.meshDefaultMaterials[mesh.id];
      const material = materialIndex === undefined ? defaultMaterial : materials[materialIndex];
      const meshInstance = new MeshInstance(mesh, material, node);

      if (mesh.morph) {
        const morphInstance = new MorphInstance(mesh.morph);
        meshInstance.morphInstance = morphInstance;
        model.morphInstances.push(morphInstance);
      }

      if (gltfNode.hasOwnProperty('skin')) {
        const skinIndex = gltfNode.skin;
        const skin = skins[skinIndex];
        mesh.skin = skin;
        const skinInstance = skinInstances[skinIndex];
        meshInstance.skinInstance = skinInstance;
        model.skinInstances.push(skinInstance);
      }

      model.meshInstances.push(meshInstance);
    };

    const model = new Model();
    const skinInstances = [];

    for (const skin of glb.skins) {
      const skinInstance = new SkinInstance(skin);
      skinInstance.bones = skin.bones;
      skinInstances.push(skinInstance);
    }

    model.graph = GlbContainerResource.createSceneHierarchy(glb.scenes, 'GraphNode');

    for (let i = 0; i < glb.nodes.length; i++) {
      const node = glb.nodes[i];

      if (node.root === model.graph) {
        const gltfNode = glb.gltf.nodes[i];

        if (gltfNode.hasOwnProperty('mesh')) {
          const meshGroup = glb.renders[gltfNode.mesh].meshes;

          for (var mi = 0; mi < meshGroup.length; mi++) {
            const mesh = meshGroup[mi];

            if (mesh) {
              createMeshInstance(model, mesh, glb.skins, skinInstances, glb.materials, node, gltfNode);
            }
          }
        }
      }
    }

    return model;
  }

  destroy() {
    const registry = this._assets;

    const destroyAsset = function destroyAsset(asset) {
      registry.remove(asset);
      asset.unload();
    };

    const destroyAssets = function destroyAssets(assets) {
      assets.forEach(function (asset) {
        destroyAsset(asset);
      });
    };

    if (this.animations) {
      destroyAssets(this.animations);
      this.animations = null;
    }

    if (this.textures) {
      destroyAssets(this.textures);
      this.textures = null;
    }

    if (this.materials) {
      destroyAssets(this.materials);
      this.materials = null;
    }

    if (this.renders) {
      destroyAssets(this.renders);
      this.renders = null;
    }

    if (this._model) {
      destroyAsset(this._model);
      this._model = null;
    }

    this.data = null;
    this.assets = null;
  }

}

export { GlbContainerResource };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xiLWNvbnRhaW5lci1yZXNvdXJjZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL3Jlc291cmNlcy9wYXJzZXIvZ2xiLWNvbnRhaW5lci1yZXNvdXJjZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3NldCB9IGZyb20gJy4uLy4uL2Fzc2V0L2Fzc2V0LmpzJztcbmltcG9ydCB7IEVudGl0eSB9IGZyb20gJy4uLy4uL2ZyYW1ld29yay9lbnRpdHkuanMnO1xuaW1wb3J0IHsgTWVzaEluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2NlbmUvbWVzaC1pbnN0YW5jZS5qcyc7XG5pbXBvcnQgeyBNb3JwaEluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2NlbmUvbW9ycGgtaW5zdGFuY2UuanMnO1xuaW1wb3J0IHsgU2tpbkluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2NlbmUvc2tpbi1pbnN0YW5jZS5qcyc7XG5pbXBvcnQgeyBTa2luSW5zdGFuY2VDYWNoZSB9IGZyb20gJy4uLy4uL3NjZW5lL3NraW4taW5zdGFuY2UtY2FjaGUuanMnO1xuaW1wb3J0IHsgTW9kZWwgfSBmcm9tICcuLi8uLi9zY2VuZS9tb2RlbC5qcyc7XG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG4vLyBDb250YWluZXIgcmVzb3VyY2UgcmV0dXJuZWQgYnkgdGhlIEdsYlBhcnNlci4gSW1wbGVtZW50cyB0aGUgQ29udGFpbmVyUmVzb3VyY2UgaW50ZXJmYWNlLlxuY2xhc3MgR2xiQ29udGFpbmVyUmVzb3VyY2Uge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEsIGFzc2V0LCBhc3NldHMsIGRlZmF1bHRNYXRlcmlhbCkge1xuICAgICAgICBjb25zdCBjcmVhdGVBc3NldCA9IGZ1bmN0aW9uICh0eXBlLCByZXNvdXJjZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1YkFzc2V0ID0gR2xiQ29udGFpbmVyUmVzb3VyY2UuY3JlYXRlQXNzZXQoYXNzZXQubmFtZSwgdHlwZSwgcmVzb3VyY2UsIGluZGV4KTtcbiAgICAgICAgICAgIGFzc2V0cy5hZGQoc3ViQXNzZXQpO1xuICAgICAgICAgICAgcmV0dXJuIHN1YkFzc2V0O1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHJlbmRlciBhc3NldHNcbiAgICAgICAgY29uc3QgcmVuZGVycyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEucmVuZGVycy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgcmVuZGVycy5wdXNoKGNyZWF0ZUFzc2V0KCdyZW5kZXInLCBkYXRhLnJlbmRlcnNbaV0sIGkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNyZWF0ZSBtYXRlcmlhbCBhc3NldHNcbiAgICAgICAgY29uc3QgbWF0ZXJpYWxzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5tYXRlcmlhbHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIG1hdGVyaWFscy5wdXNoKGNyZWF0ZUFzc2V0KCdtYXRlcmlhbCcsIGRhdGEubWF0ZXJpYWxzW2ldLCBpKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjcmVhdGUgYW5pbWF0aW9uIGFzc2V0c1xuICAgICAgICBjb25zdCBhbmltYXRpb25zID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5hbmltYXRpb25zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBhbmltYXRpb25zLnB1c2goY3JlYXRlQXNzZXQoJ2FuaW1hdGlvbicsIGRhdGEuYW5pbWF0aW9uc1tpXSwgaSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5fbW9kZWwgPSBudWxsO1xuICAgICAgICB0aGlzLl9hc3NldE5hbWUgPSBhc3NldC5uYW1lO1xuICAgICAgICB0aGlzLl9hc3NldHMgPSBhc3NldHM7XG4gICAgICAgIHRoaXMuX2RlZmF1bHRNYXRlcmlhbCA9IGRlZmF1bHRNYXRlcmlhbDtcbiAgICAgICAgdGhpcy5yZW5kZXJzID0gcmVuZGVycztcbiAgICAgICAgdGhpcy5tYXRlcmlhbHMgPSBtYXRlcmlhbHM7XG4gICAgICAgIHRoaXMudGV4dHVyZXMgPSBkYXRhLnRleHR1cmVzOyAvLyB0ZXh0dXJlIGFzc2V0cyBhcmUgY3JlYXRlZCBkaXJlY3RseVxuICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBhbmltYXRpb25zO1xuICAgIH1cblxuICAgIGdldCBtb2RlbCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9tb2RlbCkge1xuICAgICAgICAgICAgLy8gY3JlYXRlIG1vZGVsIG9ubHkgd2hlbiBuZWVkZWRcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsID0gR2xiQ29udGFpbmVyUmVzb3VyY2UuY3JlYXRlTW9kZWwodGhpcy5kYXRhLCB0aGlzLl9kZWZhdWx0TWF0ZXJpYWwpO1xuICAgICAgICAgICAgY29uc3QgbW9kZWxBc3NldCA9IEdsYkNvbnRhaW5lclJlc291cmNlLmNyZWF0ZUFzc2V0KHRoaXMuX2Fzc2V0TmFtZSwgJ21vZGVsJywgbW9kZWwsIDApO1xuICAgICAgICAgICAgdGhpcy5fYXNzZXRzLmFkZChtb2RlbEFzc2V0KTtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsID0gbW9kZWxBc3NldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbW9kZWw7XG4gICAgfVxuXG4gICAgc3RhdGljIGNyZWF0ZUFzc2V0KGFzc2V0TmFtZSwgdHlwZSwgcmVzb3VyY2UsIGluZGV4KSB7XG4gICAgICAgIGNvbnN0IHN1YkFzc2V0ID0gbmV3IEFzc2V0KGFzc2V0TmFtZSArICcvJyArIHR5cGUgKyAnLycgKyBpbmRleCwgdHlwZSwge1xuICAgICAgICAgICAgdXJsOiAnJ1xuICAgICAgICB9KTtcbiAgICAgICAgc3ViQXNzZXQucmVzb3VyY2UgPSByZXNvdXJjZTtcbiAgICAgICAgc3ViQXNzZXQubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHN1YkFzc2V0O1xuICAgIH1cblxuICAgIGluc3RhbnRpYXRlTW9kZWxFbnRpdHkob3B0aW9ucykge1xuICAgICAgICBjb25zdCBlbnRpdHkgPSBuZXcgRW50aXR5KCk7XG4gICAgICAgIGVudGl0eS5hZGRDb21wb25lbnQoJ21vZGVsJywgT2JqZWN0LmFzc2lnbih7IHR5cGU6ICdhc3NldCcsIGFzc2V0OiB0aGlzLm1vZGVsIH0sIG9wdGlvbnMpKTtcbiAgICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICB9XG5cbiAgICBpbnN0YW50aWF0ZVJlbmRlckVudGl0eShvcHRpb25zKSB7XG5cbiAgICAgICAgY29uc3QgZGVmYXVsdE1hdGVyaWFsID0gdGhpcy5fZGVmYXVsdE1hdGVyaWFsO1xuICAgICAgICBjb25zdCBza2lubmVkTWVzaEluc3RhbmNlcyA9IFtdO1xuXG4gICAgICAgIGNvbnN0IGNyZWF0ZU1lc2hJbnN0YW5jZSA9IGZ1bmN0aW9uIChyb290LCBlbnRpdHksIG1lc2gsIG1hdGVyaWFscywgbWVzaERlZmF1bHRNYXRlcmlhbHMsIHNraW5zLCBnbHRmTm9kZSkge1xuXG4gICAgICAgICAgICAvLyBjbG9uZSBtZXNoIGluc3RhbmNlXG4gICAgICAgICAgICBjb25zdCBtYXRlcmlhbEluZGV4ID0gbWVzaERlZmF1bHRNYXRlcmlhbHNbbWVzaC5pZF07XG4gICAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IChtYXRlcmlhbEluZGV4ID09PSB1bmRlZmluZWQpID8gZGVmYXVsdE1hdGVyaWFsIDogbWF0ZXJpYWxzW21hdGVyaWFsSW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgbWVzaEluc3RhbmNlID0gbmV3IE1lc2hJbnN0YW5jZShtZXNoLCBtYXRlcmlhbCk7XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSBtb3JwaCBpbnN0YW5jZVxuICAgICAgICAgICAgaWYgKG1lc2gubW9ycGgpIHtcbiAgICAgICAgICAgICAgICBtZXNoSW5zdGFuY2UubW9ycGhJbnN0YW5jZSA9IG5ldyBNb3JwaEluc3RhbmNlKG1lc2gubW9ycGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzdG9yZSBkYXRhIHRvIGNyZWF0ZSBza2luIGluc3RhbmNlIGFmdGVyIHRoZSBoaWVyYXJjaHkgaXMgY3JlYXRlZFxuICAgICAgICAgICAgaWYgKGdsdGZOb2RlLmhhc093blByb3BlcnR5KCdza2luJykpIHtcbiAgICAgICAgICAgICAgICBza2lubmVkTWVzaEluc3RhbmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlOiBtZXNoSW5zdGFuY2UsXG4gICAgICAgICAgICAgICAgICAgIHJvb3RCb25lOiByb290LFxuICAgICAgICAgICAgICAgICAgICBlbnRpdHk6IGVudGl0eVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbWVzaEluc3RhbmNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGhlbHBlciBmdW5jdGlvbiB0byByZWN1cnNpdmVseSBjbG9uZSBhIGhpZXJhcmNoeSBvZiBHcmFwaE5vZGVzIHRvIEVudGl0aWVzXG4gICAgICAgIGNvbnN0IGNsb25lSGllcmFyY2h5ID0gKHJvb3QsIG5vZGUsIGdsYikgPT4ge1xuXG4gICAgICAgICAgICBjb25zdCBlbnRpdHkgPSBuZXcgRW50aXR5KCk7XG4gICAgICAgICAgICBub2RlLl9jbG9uZUludGVybmFsKGVudGl0eSk7XG5cbiAgICAgICAgICAgIC8vIGZpcnN0IGVudGl0eSBiZWNvbWVzIHRoZSByb290XG4gICAgICAgICAgICBpZiAoIXJvb3QpIHJvb3QgPSBlbnRpdHk7XG5cbiAgICAgICAgICAgIC8vIGZpbmQgYWxsIGNvbXBvbmVudHMgbmVlZGVkIGZvciB0aGlzIG5vZGVcbiAgICAgICAgICAgIGxldCBhdHRhY2hlZE1pID0gbnVsbDtcbiAgICAgICAgICAgIGxldCByZW5kZXJBc3NldCA9IG51bGw7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdsYi5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdsYk5vZGUgPSBnbGIubm9kZXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGdsYk5vZGUgPT09IG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2x0Zk5vZGUgPSBnbGIuZ2x0Zi5ub2Rlc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBtZXNoXG4gICAgICAgICAgICAgICAgICAgIGlmIChnbHRmTm9kZS5oYXNPd25Qcm9wZXJ0eSgnbWVzaCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNoR3JvdXAgPSBnbGIucmVuZGVyc1tnbHRmTm9kZS5tZXNoXS5tZXNoZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJBc3NldCA9IHRoaXMucmVuZGVyc1tnbHRmTm9kZS5tZXNoXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG1pID0gMDsgbWkgPCBtZXNoR3JvdXAubGVuZ3RoOyBtaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzaCA9IG1lc2hHcm91cFttaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xvbmVNaSA9IGNyZWF0ZU1lc2hJbnN0YW5jZShyb290LCBlbnRpdHksIG1lc2gsIGdsYi5tYXRlcmlhbHMsIGdsYi5tZXNoRGVmYXVsdE1hdGVyaWFscywgZ2xiLnNraW5zLCBnbHRmTm9kZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGl0IHRvIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdHRhY2hlZE1pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2hlZE1pID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNoZWRNaS5wdXNoKGNsb25lTWkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpZ2h0IC0gY2xvbmUgKGFkZGl0aW9uYWwgY2hpbGQpIGVudGl0eSB3aXRoIHRoZSBsaWdodCBjb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgLy8gY2Fubm90IGNsb25lIHRoZSBjb21wb25lbnQgYXMgYWRkaXRpb25hbCBlbnRpdHkgaGFzIGEgcm90YXRpb24gdG8gaGFuZGxlIGRpZmZlcmVudCBsaWdodCBkaXJlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdsYi5saWdodHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpZ2h0RW50aXR5ID0gZ2xiLmxpZ2h0cy5nZXQoZ2x0Zk5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpZ2h0RW50aXR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LmFkZENoaWxkKGxpZ2h0RW50aXR5LmNsb25lKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY2FtZXJhXG4gICAgICAgICAgICAgICAgICAgIGlmIChnbGIuY2FtZXJhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FtZXJhRW50aXR5ID0gZ2xiLmNhbWVyYXMuZ2V0KGdsdGZOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW1lcmFFbnRpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbG9uZSBjYW1lcmEgY29tcG9uZW50IGludG8gdGhlIGVudGl0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbWVyYUVudGl0eS5jYW1lcmEuc3lzdGVtLmNsb25lQ29tcG9uZW50KGNhbWVyYUVudGl0eSwgZW50aXR5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY3JlYXRlIHJlbmRlciBjb21wb25lbnRzIGZvciBtZXNoIGluc3RhbmNlc1xuICAgICAgICAgICAgaWYgKGF0dGFjaGVkTWkpIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkuYWRkQ29tcG9uZW50KCdyZW5kZXInLCBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Fzc2V0JyxcbiAgICAgICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlczogYXR0YWNoZWRNaSxcbiAgICAgICAgICAgICAgICAgICAgcm9vdEJvbmU6IHJvb3RcbiAgICAgICAgICAgICAgICB9LCBvcHRpb25zKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBhc3NpZ24gYXNzZXQgaWQgd2l0aG91dCByZWNyZWF0aW5nIG1lc2ggaW5zdGFuY2VzIHdoaWNoIGFyZSBhbHJlYWR5IHNldCB1cCB3aXRoIG1hdGVyaWFsc1xuICAgICAgICAgICAgICAgIGVudGl0eS5yZW5kZXIuYXNzaWduQXNzZXQocmVuZGVyQXNzZXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZWN1cnNpdmVseSBjbG9uZSBjaGlsZHJlblxuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkQ2xvbmUgPSBjbG9uZUhpZXJhcmNoeShyb290LCBjaGlsZHJlbltpXSwgZ2xiKTtcbiAgICAgICAgICAgICAgICBlbnRpdHkuYWRkQ2hpbGQoY2hpbGRDbG9uZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBlbnRpdHk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gY2xvbmUgc2NlbmVzIGhpZXJhcmNoaWVzXG4gICAgICAgIGNvbnN0IHNjZW5lQ2xvbmVzID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgc2NlbmUgb2YgdGhpcy5kYXRhLnNjZW5lcykge1xuICAgICAgICAgICAgc2NlbmVDbG9uZXMucHVzaChjbG9uZUhpZXJhcmNoeShudWxsLCBzY2VuZSwgdGhpcy5kYXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBub3cgdGhhdCB0aGUgaGllcmFyY2h5IGlzIGNyZWF0ZWQsIGNyZWF0ZSBza2luIGluc3RhbmNlcyBhbmQgcmVzb2x2ZSBib25lcyB1c2luZyB0aGUgaGllcmFyY2h5XG4gICAgICAgIHNraW5uZWRNZXNoSW5zdGFuY2VzLmZvckVhY2goKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGRhdGEubWVzaEluc3RhbmNlLnNraW5JbnN0YW5jZSA9IFNraW5JbnN0YW5jZUNhY2hlLmNyZWF0ZUNhY2hlZFNraW5JbnN0YW5jZShkYXRhLm1lc2hJbnN0YW5jZS5tZXNoLnNraW4sIGRhdGEucm9vdEJvbmUsIGRhdGEuZW50aXR5KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzY2VuZSBoaWVyYXJjaHkgY3JlYXRlZCBmcm9tIHNjZW5lIGNsb25lc1xuICAgICAgICByZXR1cm4gR2xiQ29udGFpbmVyUmVzb3VyY2UuY3JlYXRlU2NlbmVIaWVyYXJjaHkoc2NlbmVDbG9uZXMsICdFbnRpdHknKTtcbiAgICB9XG5cbiAgICAvLyBnZXQgbWF0ZXJpYWwgdmFyaWFudHNcbiAgICBnZXRNYXRlcmlhbFZhcmlhbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnZhcmlhbnRzID8gT2JqZWN0LmtleXModGhpcy5kYXRhLnZhcmlhbnRzKSA6IFtdO1xuICAgIH1cblxuICAgIC8vIGFwcGx5IG1hdGVyaWFsIHZhcmlhbnQgdG8gZW50aXR5XG4gICAgYXBwbHlNYXRlcmlhbFZhcmlhbnQoZW50aXR5LCBuYW1lKSB7XG4gICAgICAgIGNvbnN0IHZhcmlhbnQgPSBuYW1lID8gdGhpcy5kYXRhLnZhcmlhbnRzW25hbWVdIDogbnVsbDtcbiAgICAgICAgaWYgKHZhcmlhbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgRGVidWcud2FybihgTm8gdmFyaWFudCBuYW1lZCAke25hbWV9IGV4aXN0cyBpbiByZXNvdXJjZWApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlbmRlcnMgPSBlbnRpdHkuZmluZENvbXBvbmVudHMoXCJyZW5kZXJcIik7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyQ29tcG9uZW50ID0gcmVuZGVyc1tpXTtcbiAgICAgICAgICAgIHRoaXMuX2FwcGx5TWF0ZXJpYWxWYXJpYW50KHZhcmlhbnQsIHJlbmRlckNvbXBvbmVudC5tZXNoSW5zdGFuY2VzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGFwcGx5IG1hdGVyaWFsIHZhcmlhbnQgdG8gbWVzaCBpbnN0YW5jZXNcbiAgICBhcHBseU1hdGVyaWFsVmFyaWFudEluc3RhbmNlcyhpbnN0YW5jZXMsIG5hbWUpIHtcbiAgICAgICAgY29uc3QgdmFyaWFudCA9IG5hbWUgPyB0aGlzLmRhdGEudmFyaWFudHNbbmFtZV0gOiBudWxsO1xuICAgICAgICBpZiAodmFyaWFudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBEZWJ1Zy53YXJuKGBObyB2YXJpYW50IG5hbWVkICR7bmFtZX0gZXhpc3RzIGluIHJlc291cmNlYCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYXBwbHlNYXRlcmlhbFZhcmlhbnQodmFyaWFudCwgaW5zdGFuY2VzKTtcbiAgICB9XG5cbiAgICAvLyBpbnRlcm5hbGx5IGFwcGx5IHZhcmlhbnQgdG8gaW5zdGFuY2VzXG4gICAgX2FwcGx5TWF0ZXJpYWxWYXJpYW50KHZhcmlhbnQsIGluc3RhbmNlcykge1xuICAgICAgICBpbnN0YW5jZXMuZm9yRWFjaCgoaW5zdGFuY2UpID0+IHtcbiAgICAgICAgICAgIGlmICh2YXJpYW50ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UubWF0ZXJpYWwgPSB0aGlzLl9kZWZhdWx0TWF0ZXJpYWw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc2hWYXJpYW50cyA9IHRoaXMuZGF0YS5tZXNoVmFyaWFudHNbaW5zdGFuY2UubWVzaC5pZF07XG4gICAgICAgICAgICAgICAgaWYgKG1lc2hWYXJpYW50cykge1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5tYXRlcmlhbCA9IHRoaXMuZGF0YS5tYXRlcmlhbHNbbWVzaFZhcmlhbnRzW3ZhcmlhbnRdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBEZWJ1Zy5hc3NlcnQoaW5zdGFuY2UubWF0ZXJpYWwpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBoZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgc2luZ2xlIGhpZXJhcmNoeSBmcm9tIGFuIGFycmF5IG9mIG5vZGVzXG4gICAgc3RhdGljIGNyZWF0ZVNjZW5lSGllcmFyY2h5KHNjZW5lTm9kZXMsIG5vZGVUeXBlKSB7XG5cbiAgICAgICAgLy8gY3JlYXRlIGEgc2luZ2xlIHJvb3Qgb2YgdGhlIGhpZXJhcmNoeSAtIGVpdGhlciB0aGUgc2luZ2xlIHNjZW5lLCBvciBhIG5ldyBFbnRpdHkgcGFyZW50IGlmIG11bHRpcGxlIHNjZW5lc1xuICAgICAgICBsZXQgcm9vdCA9IG51bGw7XG4gICAgICAgIGlmIChzY2VuZU5vZGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gdXNlIHNjZW5lIGlmIG9ubHkgb25lXG4gICAgICAgICAgICByb290ID0gc2NlbmVOb2Rlc1swXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBncm91cCBub2RlIGZvciBhbGwgc2NlbmVzXG4gICAgICAgICAgICByb290ID0gbmV3IG5vZGVUeXBlKCdTY2VuZUdyb3VwJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNjZW5lIG9mIHNjZW5lTm9kZXMpIHtcbiAgICAgICAgICAgICAgICByb290LmFkZENoaWxkKHNjZW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByb290O1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZSBhIHBjLk1vZGVsIGZyb20gdGhlIHBhcnNlZCBHTEIgZGF0YSBzdHJ1Y3R1cmVzXG4gICAgc3RhdGljIGNyZWF0ZU1vZGVsKGdsYiwgZGVmYXVsdE1hdGVyaWFsKSB7XG5cbiAgICAgICAgY29uc3QgY3JlYXRlTWVzaEluc3RhbmNlID0gZnVuY3Rpb24gKG1vZGVsLCBtZXNoLCBza2lucywgc2tpbkluc3RhbmNlcywgbWF0ZXJpYWxzLCBub2RlLCBnbHRmTm9kZSkge1xuICAgICAgICAgICAgY29uc3QgbWF0ZXJpYWxJbmRleCA9IGdsYi5tZXNoRGVmYXVsdE1hdGVyaWFsc1ttZXNoLmlkXTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGVyaWFsID0gKG1hdGVyaWFsSW5kZXggPT09IHVuZGVmaW5lZCkgPyBkZWZhdWx0TWF0ZXJpYWwgOiBtYXRlcmlhbHNbbWF0ZXJpYWxJbmRleF07XG4gICAgICAgICAgICBjb25zdCBtZXNoSW5zdGFuY2UgPSBuZXcgTWVzaEluc3RhbmNlKG1lc2gsIG1hdGVyaWFsLCBub2RlKTtcblxuICAgICAgICAgICAgaWYgKG1lc2gubW9ycGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb3JwaEluc3RhbmNlID0gbmV3IE1vcnBoSW5zdGFuY2UobWVzaC5tb3JwaCk7XG4gICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlLm1vcnBoSW5zdGFuY2UgPSBtb3JwaEluc3RhbmNlO1xuICAgICAgICAgICAgICAgIG1vZGVsLm1vcnBoSW5zdGFuY2VzLnB1c2gobW9ycGhJbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnbHRmTm9kZS5oYXNPd25Qcm9wZXJ0eSgnc2tpbicpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpbkluZGV4ID0gZ2x0Zk5vZGUuc2tpbjtcbiAgICAgICAgICAgICAgICBjb25zdCBza2luID0gc2tpbnNbc2tpbkluZGV4XTtcbiAgICAgICAgICAgICAgICBtZXNoLnNraW4gPSBza2luO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2tpbkluc3RhbmNlID0gc2tpbkluc3RhbmNlc1tza2luSW5kZXhdO1xuICAgICAgICAgICAgICAgIG1lc2hJbnN0YW5jZS5za2luSW5zdGFuY2UgPSBza2luSW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgbW9kZWwuc2tpbkluc3RhbmNlcy5wdXNoKHNraW5JbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vZGVsLm1lc2hJbnN0YW5jZXMucHVzaChtZXNoSW5zdGFuY2UpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG1vZGVsID0gbmV3IE1vZGVsKCk7XG5cbiAgICAgICAgLy8gY3JlYXRlIHNraW5JbnN0YW5jZSBmb3IgZWFjaCBza2luXG4gICAgICAgIGNvbnN0IHNraW5JbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBza2luIG9mIGdsYi5za2lucykge1xuICAgICAgICAgICAgY29uc3Qgc2tpbkluc3RhbmNlID0gbmV3IFNraW5JbnN0YW5jZShza2luKTtcbiAgICAgICAgICAgIHNraW5JbnN0YW5jZS5ib25lcyA9IHNraW4uYm9uZXM7XG4gICAgICAgICAgICBza2luSW5zdGFuY2VzLnB1c2goc2tpbkluc3RhbmNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG5vZGUgaGllcmFyY2h5IGZvciB0aGUgbW9kZWxcbiAgICAgICAgbW9kZWwuZ3JhcGggPSBHbGJDb250YWluZXJSZXNvdXJjZS5jcmVhdGVTY2VuZUhpZXJhcmNoeShnbGIuc2NlbmVzLCAnR3JhcGhOb2RlJyk7XG5cbiAgICAgICAgLy8gY3JlYXRlIG1lc2ggaW5zdGFuY2UgZm9yIG1lc2hlcyBvbiBub2RlcyB0aGF0IGFyZSBwYXJ0IG9mIGhpZXJhcmNoeVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdsYi5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGdsYi5ub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChub2RlLnJvb3QgPT09IG1vZGVsLmdyYXBoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZ2x0Zk5vZGUgPSBnbGIuZ2x0Zi5ub2Rlc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoZ2x0Zk5vZGUuaGFzT3duUHJvcGVydHkoJ21lc2gnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNoR3JvdXAgPSBnbGIucmVuZGVyc1tnbHRmTm9kZS5tZXNoXS5tZXNoZXM7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG1pID0gMDsgbWkgPCBtZXNoR3JvdXAubGVuZ3RoOyBtaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNoID0gbWVzaEdyb3VwW21pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTWVzaEluc3RhbmNlKG1vZGVsLCBtZXNoLCBnbGIuc2tpbnMsIHNraW5JbnN0YW5jZXMsIGdsYi5tYXRlcmlhbHMsIG5vZGUsIGdsdGZOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBjb25zdCByZWdpc3RyeSA9IHRoaXMuX2Fzc2V0cztcblxuICAgICAgICBjb25zdCBkZXN0cm95QXNzZXQgPSBmdW5jdGlvbiAoYXNzZXQpIHtcbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlbW92ZShhc3NldCk7XG4gICAgICAgICAgICBhc3NldC51bmxvYWQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBkZXN0cm95QXNzZXRzID0gZnVuY3Rpb24gKGFzc2V0cykge1xuICAgICAgICAgICAgYXNzZXRzLmZvckVhY2goZnVuY3Rpb24gKGFzc2V0KSB7XG4gICAgICAgICAgICAgICAgZGVzdHJveUFzc2V0KGFzc2V0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHVubG9hZCBhbmQgZGVzdHJveSBhc3NldHNcbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9ucykge1xuICAgICAgICAgICAgZGVzdHJveUFzc2V0cyh0aGlzLmFuaW1hdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnRleHR1cmVzKSB7XG4gICAgICAgICAgICBkZXN0cm95QXNzZXRzKHRoaXMudGV4dHVyZXMpO1xuICAgICAgICAgICAgdGhpcy50ZXh0dXJlcyA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5tYXRlcmlhbHMpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lBc3NldHModGhpcy5tYXRlcmlhbHMpO1xuICAgICAgICAgICAgdGhpcy5tYXRlcmlhbHMgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmVuZGVycykge1xuICAgICAgICAgICAgZGVzdHJveUFzc2V0cyh0aGlzLnJlbmRlcnMpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJzID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9tb2RlbCkge1xuICAgICAgICAgICAgZGVzdHJveUFzc2V0KHRoaXMuX21vZGVsKTtcbiAgICAgICAgICAgIHRoaXMuX21vZGVsID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuYXNzZXRzID0gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEdsYkNvbnRhaW5lclJlc291cmNlIH07XG4iXSwibmFtZXMiOlsiR2xiQ29udGFpbmVyUmVzb3VyY2UiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJhc3NldCIsImFzc2V0cyIsImRlZmF1bHRNYXRlcmlhbCIsImNyZWF0ZUFzc2V0IiwidHlwZSIsInJlc291cmNlIiwiaW5kZXgiLCJzdWJBc3NldCIsIm5hbWUiLCJhZGQiLCJyZW5kZXJzIiwiaSIsImxlbmd0aCIsInB1c2giLCJtYXRlcmlhbHMiLCJhbmltYXRpb25zIiwiX21vZGVsIiwiX2Fzc2V0TmFtZSIsIl9hc3NldHMiLCJfZGVmYXVsdE1hdGVyaWFsIiwidGV4dHVyZXMiLCJtb2RlbCIsImNyZWF0ZU1vZGVsIiwibW9kZWxBc3NldCIsImFzc2V0TmFtZSIsIkFzc2V0IiwidXJsIiwibG9hZGVkIiwiaW5zdGFudGlhdGVNb2RlbEVudGl0eSIsIm9wdGlvbnMiLCJlbnRpdHkiLCJFbnRpdHkiLCJhZGRDb21wb25lbnQiLCJPYmplY3QiLCJhc3NpZ24iLCJpbnN0YW50aWF0ZVJlbmRlckVudGl0eSIsInNraW5uZWRNZXNoSW5zdGFuY2VzIiwiY3JlYXRlTWVzaEluc3RhbmNlIiwicm9vdCIsIm1lc2giLCJtZXNoRGVmYXVsdE1hdGVyaWFscyIsInNraW5zIiwiZ2x0Zk5vZGUiLCJtYXRlcmlhbEluZGV4IiwiaWQiLCJtYXRlcmlhbCIsInVuZGVmaW5lZCIsIm1lc2hJbnN0YW5jZSIsIk1lc2hJbnN0YW5jZSIsIm1vcnBoIiwibW9ycGhJbnN0YW5jZSIsIk1vcnBoSW5zdGFuY2UiLCJoYXNPd25Qcm9wZXJ0eSIsInJvb3RCb25lIiwiY2xvbmVIaWVyYXJjaHkiLCJub2RlIiwiZ2xiIiwiX2Nsb25lSW50ZXJuYWwiLCJhdHRhY2hlZE1pIiwicmVuZGVyQXNzZXQiLCJub2RlcyIsImdsYk5vZGUiLCJnbHRmIiwibWVzaEdyb3VwIiwibWVzaGVzIiwibWkiLCJjbG9uZU1pIiwibGlnaHRzIiwibGlnaHRFbnRpdHkiLCJnZXQiLCJhZGRDaGlsZCIsImNsb25lIiwiY2FtZXJhcyIsImNhbWVyYUVudGl0eSIsImNhbWVyYSIsInN5c3RlbSIsImNsb25lQ29tcG9uZW50IiwibWVzaEluc3RhbmNlcyIsInJlbmRlciIsImFzc2lnbkFzc2V0IiwiY2hpbGRyZW4iLCJjaGlsZENsb25lIiwic2NlbmVDbG9uZXMiLCJzY2VuZSIsInNjZW5lcyIsImZvckVhY2giLCJza2luSW5zdGFuY2UiLCJTa2luSW5zdGFuY2VDYWNoZSIsImNyZWF0ZUNhY2hlZFNraW5JbnN0YW5jZSIsInNraW4iLCJjcmVhdGVTY2VuZUhpZXJhcmNoeSIsImdldE1hdGVyaWFsVmFyaWFudHMiLCJ2YXJpYW50cyIsImtleXMiLCJhcHBseU1hdGVyaWFsVmFyaWFudCIsInZhcmlhbnQiLCJEZWJ1ZyIsIndhcm4iLCJmaW5kQ29tcG9uZW50cyIsInJlbmRlckNvbXBvbmVudCIsIl9hcHBseU1hdGVyaWFsVmFyaWFudCIsImFwcGx5TWF0ZXJpYWxWYXJpYW50SW5zdGFuY2VzIiwiaW5zdGFuY2VzIiwiaW5zdGFuY2UiLCJtZXNoVmFyaWFudHMiLCJhc3NlcnQiLCJzY2VuZU5vZGVzIiwibm9kZVR5cGUiLCJza2luSW5zdGFuY2VzIiwibW9ycGhJbnN0YW5jZXMiLCJza2luSW5kZXgiLCJNb2RlbCIsIlNraW5JbnN0YW5jZSIsImJvbmVzIiwiZ3JhcGgiLCJkZXN0cm95IiwicmVnaXN0cnkiLCJkZXN0cm95QXNzZXQiLCJyZW1vdmUiLCJ1bmxvYWQiLCJkZXN0cm95QXNzZXRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQVVBLE1BQU1BLG9CQUFOLENBQTJCO0VBQ3ZCQyxXQUFXLENBQUNDLElBQUQsRUFBT0MsS0FBUCxFQUFjQyxNQUFkLEVBQXNCQyxlQUF0QixFQUF1QztJQUM5QyxNQUFNQyxXQUFXLEdBQUcsU0FBZEEsV0FBYyxDQUFVQyxJQUFWLEVBQWdCQyxRQUFoQixFQUEwQkMsS0FBMUIsRUFBaUM7QUFDakQsTUFBQSxNQUFNQyxRQUFRLEdBQUdWLG9CQUFvQixDQUFDTSxXQUFyQixDQUFpQ0gsS0FBSyxDQUFDUSxJQUF2QyxFQUE2Q0osSUFBN0MsRUFBbURDLFFBQW5ELEVBQTZEQyxLQUE3RCxDQUFqQixDQUFBO01BQ0FMLE1BQU0sQ0FBQ1EsR0FBUCxDQUFXRixRQUFYLENBQUEsQ0FBQTtBQUNBLE1BQUEsT0FBT0EsUUFBUCxDQUFBO0tBSEosQ0FBQTs7SUFPQSxNQUFNRyxPQUFPLEdBQUcsRUFBaEIsQ0FBQTs7QUFDQSxJQUFBLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR1osSUFBSSxDQUFDVyxPQUFMLENBQWFFLE1BQWpDLEVBQXlDLEVBQUVELENBQTNDLEVBQThDO0FBQzFDRCxNQUFBQSxPQUFPLENBQUNHLElBQVIsQ0FBYVYsV0FBVyxDQUFDLFFBQUQsRUFBV0osSUFBSSxDQUFDVyxPQUFMLENBQWFDLENBQWIsQ0FBWCxFQUE0QkEsQ0FBNUIsQ0FBeEIsQ0FBQSxDQUFBO0FBQ0gsS0FBQTs7SUFHRCxNQUFNRyxTQUFTLEdBQUcsRUFBbEIsQ0FBQTs7QUFDQSxJQUFBLEtBQUssSUFBSUgsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR1osSUFBSSxDQUFDZSxTQUFMLENBQWVGLE1BQW5DLEVBQTJDLEVBQUVELENBQTdDLEVBQWdEO0FBQzVDRyxNQUFBQSxTQUFTLENBQUNELElBQVYsQ0FBZVYsV0FBVyxDQUFDLFVBQUQsRUFBYUosSUFBSSxDQUFDZSxTQUFMLENBQWVILENBQWYsQ0FBYixFQUFnQ0EsQ0FBaEMsQ0FBMUIsQ0FBQSxDQUFBO0FBQ0gsS0FBQTs7SUFHRCxNQUFNSSxVQUFVLEdBQUcsRUFBbkIsQ0FBQTs7QUFDQSxJQUFBLEtBQUssSUFBSUosQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR1osSUFBSSxDQUFDZ0IsVUFBTCxDQUFnQkgsTUFBcEMsRUFBNEMsRUFBRUQsQ0FBOUMsRUFBaUQ7QUFDN0NJLE1BQUFBLFVBQVUsQ0FBQ0YsSUFBWCxDQUFnQlYsV0FBVyxDQUFDLFdBQUQsRUFBY0osSUFBSSxDQUFDZ0IsVUFBTCxDQUFnQkosQ0FBaEIsQ0FBZCxFQUFrQ0EsQ0FBbEMsQ0FBM0IsQ0FBQSxDQUFBO0FBQ0gsS0FBQTs7SUFFRCxJQUFLWixDQUFBQSxJQUFMLEdBQVlBLElBQVosQ0FBQTtJQUNBLElBQUtpQixDQUFBQSxNQUFMLEdBQWMsSUFBZCxDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUtDLFVBQUwsR0FBa0JqQixLQUFLLENBQUNRLElBQXhCLENBQUE7SUFDQSxJQUFLVSxDQUFBQSxPQUFMLEdBQWVqQixNQUFmLENBQUE7SUFDQSxJQUFLa0IsQ0FBQUEsZ0JBQUwsR0FBd0JqQixlQUF4QixDQUFBO0lBQ0EsSUFBS1EsQ0FBQUEsT0FBTCxHQUFlQSxPQUFmLENBQUE7SUFDQSxJQUFLSSxDQUFBQSxTQUFMLEdBQWlCQSxTQUFqQixDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUtNLFFBQUwsR0FBZ0JyQixJQUFJLENBQUNxQixRQUFyQixDQUFBO0lBQ0EsSUFBS0wsQ0FBQUEsVUFBTCxHQUFrQkEsVUFBbEIsQ0FBQTtBQUNILEdBQUE7O0FBRVEsRUFBQSxJQUFMTSxLQUFLLEdBQUc7SUFDUixJQUFJLENBQUMsSUFBS0wsQ0FBQUEsTUFBVixFQUFrQjtNQUVkLE1BQU1LLEtBQUssR0FBR3hCLG9CQUFvQixDQUFDeUIsV0FBckIsQ0FBaUMsSUFBQSxDQUFLdkIsSUFBdEMsRUFBNEMsSUFBS29CLENBQUFBLGdCQUFqRCxDQUFkLENBQUE7QUFDQSxNQUFBLE1BQU1JLFVBQVUsR0FBRzFCLG9CQUFvQixDQUFDTSxXQUFyQixDQUFpQyxJQUFBLENBQUtjLFVBQXRDLEVBQWtELE9BQWxELEVBQTJESSxLQUEzRCxFQUFrRSxDQUFsRSxDQUFuQixDQUFBOztBQUNBLE1BQUEsSUFBQSxDQUFLSCxPQUFMLENBQWFULEdBQWIsQ0FBaUJjLFVBQWpCLENBQUEsQ0FBQTs7TUFDQSxJQUFLUCxDQUFBQSxNQUFMLEdBQWNPLFVBQWQsQ0FBQTtBQUNILEtBQUE7O0FBQ0QsSUFBQSxPQUFPLEtBQUtQLE1BQVosQ0FBQTtBQUNILEdBQUE7O0VBRWlCLE9BQVhiLFdBQVcsQ0FBQ3FCLFNBQUQsRUFBWXBCLElBQVosRUFBa0JDLFFBQWxCLEVBQTRCQyxLQUE1QixFQUFtQztBQUNqRCxJQUFBLE1BQU1DLFFBQVEsR0FBRyxJQUFJa0IsS0FBSixDQUFVRCxTQUFTLEdBQUcsR0FBWixHQUFrQnBCLElBQWxCLEdBQXlCLEdBQXpCLEdBQStCRSxLQUF6QyxFQUFnREYsSUFBaEQsRUFBc0Q7QUFDbkVzQixNQUFBQSxHQUFHLEVBQUUsRUFBQTtBQUQ4RCxLQUF0RCxDQUFqQixDQUFBO0lBR0FuQixRQUFRLENBQUNGLFFBQVQsR0FBb0JBLFFBQXBCLENBQUE7SUFDQUUsUUFBUSxDQUFDb0IsTUFBVCxHQUFrQixJQUFsQixDQUFBO0FBQ0EsSUFBQSxPQUFPcEIsUUFBUCxDQUFBO0FBQ0gsR0FBQTs7RUFFRHFCLHNCQUFzQixDQUFDQyxPQUFELEVBQVU7QUFDNUIsSUFBQSxNQUFNQyxNQUFNLEdBQUcsSUFBSUMsTUFBSixFQUFmLENBQUE7SUFDQUQsTUFBTSxDQUFDRSxZQUFQLENBQW9CLE9BQXBCLEVBQTZCQyxNQUFNLENBQUNDLE1BQVAsQ0FBYztBQUFFOUIsTUFBQUEsSUFBSSxFQUFFLE9BQVI7QUFBaUJKLE1BQUFBLEtBQUssRUFBRSxJQUFLcUIsQ0FBQUEsS0FBQUE7S0FBM0MsRUFBb0RRLE9BQXBELENBQTdCLENBQUEsQ0FBQTtBQUNBLElBQUEsT0FBT0MsTUFBUCxDQUFBO0FBQ0gsR0FBQTs7RUFFREssdUJBQXVCLENBQUNOLE9BQUQsRUFBVTtJQUU3QixNQUFNM0IsZUFBZSxHQUFHLElBQUEsQ0FBS2lCLGdCQUE3QixDQUFBO0lBQ0EsTUFBTWlCLG9CQUFvQixHQUFHLEVBQTdCLENBQUE7O0FBRUEsSUFBQSxNQUFNQyxrQkFBa0IsR0FBRyxTQUFyQkEsa0JBQXFCLENBQVVDLElBQVYsRUFBZ0JSLE1BQWhCLEVBQXdCUyxJQUF4QixFQUE4QnpCLFNBQTlCLEVBQXlDMEIsb0JBQXpDLEVBQStEQyxLQUEvRCxFQUFzRUMsUUFBdEUsRUFBZ0Y7QUFHdkcsTUFBQSxNQUFNQyxhQUFhLEdBQUdILG9CQUFvQixDQUFDRCxJQUFJLENBQUNLLEVBQU4sQ0FBMUMsQ0FBQTtNQUNBLE1BQU1DLFFBQVEsR0FBSUYsYUFBYSxLQUFLRyxTQUFuQixHQUFnQzVDLGVBQWhDLEdBQWtEWSxTQUFTLENBQUM2QixhQUFELENBQTVFLENBQUE7TUFDQSxNQUFNSSxZQUFZLEdBQUcsSUFBSUMsWUFBSixDQUFpQlQsSUFBakIsRUFBdUJNLFFBQXZCLENBQXJCLENBQUE7O01BR0EsSUFBSU4sSUFBSSxDQUFDVSxLQUFULEVBQWdCO1FBQ1pGLFlBQVksQ0FBQ0csYUFBYixHQUE2QixJQUFJQyxhQUFKLENBQWtCWixJQUFJLENBQUNVLEtBQXZCLENBQTdCLENBQUE7QUFDSCxPQUFBOztBQUdELE1BQUEsSUFBSVAsUUFBUSxDQUFDVSxjQUFULENBQXdCLE1BQXhCLENBQUosRUFBcUM7UUFDakNoQixvQkFBb0IsQ0FBQ3ZCLElBQXJCLENBQTBCO0FBQ3RCa0MsVUFBQUEsWUFBWSxFQUFFQSxZQURRO0FBRXRCTSxVQUFBQSxRQUFRLEVBQUVmLElBRlk7QUFHdEJSLFVBQUFBLE1BQU0sRUFBRUEsTUFBQUE7U0FIWixDQUFBLENBQUE7QUFLSCxPQUFBOztBQUVELE1BQUEsT0FBT2lCLFlBQVAsQ0FBQTtLQXJCSixDQUFBOztJQXlCQSxNQUFNTyxjQUFjLEdBQUcsQ0FBQ2hCLElBQUQsRUFBT2lCLElBQVAsRUFBYUMsR0FBYixLQUFxQjtBQUV4QyxNQUFBLE1BQU0xQixNQUFNLEdBQUcsSUFBSUMsTUFBSixFQUFmLENBQUE7O01BQ0F3QixJQUFJLENBQUNFLGNBQUwsQ0FBb0IzQixNQUFwQixDQUFBLENBQUE7O0FBR0EsTUFBQSxJQUFJLENBQUNRLElBQUwsRUFBV0EsSUFBSSxHQUFHUixNQUFQLENBQUE7TUFHWCxJQUFJNEIsVUFBVSxHQUFHLElBQWpCLENBQUE7TUFDQSxJQUFJQyxXQUFXLEdBQUcsSUFBbEIsQ0FBQTs7QUFDQSxNQUFBLEtBQUssSUFBSWhELENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUc2QyxHQUFHLENBQUNJLEtBQUosQ0FBVWhELE1BQTlCLEVBQXNDRCxDQUFDLEVBQXZDLEVBQTJDO0FBQ3ZDLFFBQUEsTUFBTWtELE9BQU8sR0FBR0wsR0FBRyxDQUFDSSxLQUFKLENBQVVqRCxDQUFWLENBQWhCLENBQUE7O1FBQ0EsSUFBSWtELE9BQU8sS0FBS04sSUFBaEIsRUFBc0I7VUFDbEIsTUFBTWIsUUFBUSxHQUFHYyxHQUFHLENBQUNNLElBQUosQ0FBU0YsS0FBVCxDQUFlakQsQ0FBZixDQUFqQixDQUFBOztBQUdBLFVBQUEsSUFBSStCLFFBQVEsQ0FBQ1UsY0FBVCxDQUF3QixNQUF4QixDQUFKLEVBQXFDO1lBQ2pDLE1BQU1XLFNBQVMsR0FBR1AsR0FBRyxDQUFDOUMsT0FBSixDQUFZZ0MsUUFBUSxDQUFDSCxJQUFyQixDQUFBLENBQTJCeUIsTUFBN0MsQ0FBQTtBQUNBTCxZQUFBQSxXQUFXLEdBQUcsSUFBS2pELENBQUFBLE9BQUwsQ0FBYWdDLFFBQVEsQ0FBQ0gsSUFBdEIsQ0FBZCxDQUFBOztBQUNBLFlBQUEsS0FBSyxJQUFJMEIsRUFBRSxHQUFHLENBQWQsRUFBaUJBLEVBQUUsR0FBR0YsU0FBUyxDQUFDbkQsTUFBaEMsRUFBd0NxRCxFQUFFLEVBQTFDLEVBQThDO0FBQzFDLGNBQUEsTUFBTTFCLElBQUksR0FBR3dCLFNBQVMsQ0FBQ0UsRUFBRCxDQUF0QixDQUFBOztBQUNBLGNBQUEsSUFBSTFCLElBQUosRUFBVTtnQkFDTixNQUFNMkIsT0FBTyxHQUFHN0Isa0JBQWtCLENBQUNDLElBQUQsRUFBT1IsTUFBUCxFQUFlUyxJQUFmLEVBQXFCaUIsR0FBRyxDQUFDMUMsU0FBekIsRUFBb0MwQyxHQUFHLENBQUNoQixvQkFBeEMsRUFBOERnQixHQUFHLENBQUNmLEtBQWxFLEVBQXlFQyxRQUF6RSxDQUFsQyxDQUFBOztnQkFHQSxJQUFJLENBQUNnQixVQUFMLEVBQWlCO0FBQ2JBLGtCQUFBQSxVQUFVLEdBQUcsRUFBYixDQUFBO0FBQ0gsaUJBQUE7O2dCQUNEQSxVQUFVLENBQUM3QyxJQUFYLENBQWdCcUQsT0FBaEIsQ0FBQSxDQUFBO0FBQ0gsZUFBQTtBQUNKLGFBQUE7QUFDSixXQUFBOztVQUlELElBQUlWLEdBQUcsQ0FBQ1csTUFBUixFQUFnQjtZQUNaLE1BQU1DLFdBQVcsR0FBR1osR0FBRyxDQUFDVyxNQUFKLENBQVdFLEdBQVgsQ0FBZTNCLFFBQWYsQ0FBcEIsQ0FBQTs7QUFDQSxZQUFBLElBQUkwQixXQUFKLEVBQWlCO0FBQ2J0QyxjQUFBQSxNQUFNLENBQUN3QyxRQUFQLENBQWdCRixXQUFXLENBQUNHLEtBQVosRUFBaEIsQ0FBQSxDQUFBO0FBQ0gsYUFBQTtBQUNKLFdBQUE7O1VBR0QsSUFBSWYsR0FBRyxDQUFDZ0IsT0FBUixFQUFpQjtZQUNiLE1BQU1DLFlBQVksR0FBR2pCLEdBQUcsQ0FBQ2dCLE9BQUosQ0FBWUgsR0FBWixDQUFnQjNCLFFBQWhCLENBQXJCLENBQUE7O0FBQ0EsWUFBQSxJQUFJK0IsWUFBSixFQUFrQjtjQUVkQSxZQUFZLENBQUNDLE1BQWIsQ0FBb0JDLE1BQXBCLENBQTJCQyxjQUEzQixDQUEwQ0gsWUFBMUMsRUFBd0QzQyxNQUF4RCxDQUFBLENBQUE7QUFDSCxhQUFBO0FBQ0osV0FBQTtBQUNKLFNBQUE7QUFDSixPQUFBOztBQUdELE1BQUEsSUFBSTRCLFVBQUosRUFBZ0I7UUFDWjVCLE1BQU0sQ0FBQ0UsWUFBUCxDQUFvQixRQUFwQixFQUE4QkMsTUFBTSxDQUFDQyxNQUFQLENBQWM7QUFDeEM5QixVQUFBQSxJQUFJLEVBQUUsT0FEa0M7QUFFeEN5RSxVQUFBQSxhQUFhLEVBQUVuQixVQUZ5QjtBQUd4Q0wsVUFBQUEsUUFBUSxFQUFFZixJQUFBQTtTQUhnQixFQUkzQlQsT0FKMkIsQ0FBOUIsQ0FBQSxDQUFBO0FBT0FDLFFBQUFBLE1BQU0sQ0FBQ2dELE1BQVAsQ0FBY0MsV0FBZCxDQUEwQnBCLFdBQTFCLENBQUEsQ0FBQTtBQUNILE9BQUE7O0FBR0QsTUFBQSxNQUFNcUIsUUFBUSxHQUFHekIsSUFBSSxDQUFDeUIsUUFBdEIsQ0FBQTs7QUFDQSxNQUFBLEtBQUssSUFBSXJFLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUdxRSxRQUFRLENBQUNwRSxNQUE3QixFQUFxQ0QsQ0FBQyxFQUF0QyxFQUEwQztBQUN0QyxRQUFBLE1BQU1zRSxVQUFVLEdBQUczQixjQUFjLENBQUNoQixJQUFELEVBQU8wQyxRQUFRLENBQUNyRSxDQUFELENBQWYsRUFBb0I2QyxHQUFwQixDQUFqQyxDQUFBO1FBQ0ExQixNQUFNLENBQUN3QyxRQUFQLENBQWdCVyxVQUFoQixDQUFBLENBQUE7QUFDSCxPQUFBOztBQUVELE1BQUEsT0FBT25ELE1BQVAsQ0FBQTtLQXpFSixDQUFBOztJQTZFQSxNQUFNb0QsV0FBVyxHQUFHLEVBQXBCLENBQUE7O0FBQ0EsSUFBQSxLQUFLLE1BQU1DLEtBQVgsSUFBb0IsS0FBS3BGLElBQUwsQ0FBVXFGLE1BQTlCLEVBQXNDO01BQ2xDRixXQUFXLENBQUNyRSxJQUFaLENBQWlCeUMsY0FBYyxDQUFDLElBQUQsRUFBTzZCLEtBQVAsRUFBYyxJQUFLcEYsQ0FBQUEsSUFBbkIsQ0FBL0IsQ0FBQSxDQUFBO0FBQ0gsS0FBQTs7QUFHRHFDLElBQUFBLG9CQUFvQixDQUFDaUQsT0FBckIsQ0FBOEJ0RixJQUFELElBQVU7TUFDbkNBLElBQUksQ0FBQ2dELFlBQUwsQ0FBa0J1QyxZQUFsQixHQUFpQ0MsaUJBQWlCLENBQUNDLHdCQUFsQixDQUEyQ3pGLElBQUksQ0FBQ2dELFlBQUwsQ0FBa0JSLElBQWxCLENBQXVCa0QsSUFBbEUsRUFBd0UxRixJQUFJLENBQUNzRCxRQUE3RSxFQUF1RnRELElBQUksQ0FBQytCLE1BQTVGLENBQWpDLENBQUE7S0FESixDQUFBLENBQUE7QUFLQSxJQUFBLE9BQU9qQyxvQkFBb0IsQ0FBQzZGLG9CQUFyQixDQUEwQ1IsV0FBMUMsRUFBdUQsUUFBdkQsQ0FBUCxDQUFBO0FBQ0gsR0FBQTs7QUFHRFMsRUFBQUEsbUJBQW1CLEdBQUc7QUFDbEIsSUFBQSxPQUFPLElBQUs1RixDQUFBQSxJQUFMLENBQVU2RixRQUFWLEdBQXFCM0QsTUFBTSxDQUFDNEQsSUFBUCxDQUFZLEtBQUs5RixJQUFMLENBQVU2RixRQUF0QixDQUFyQixHQUF1RCxFQUE5RCxDQUFBO0FBQ0gsR0FBQTs7QUFHREUsRUFBQUEsb0JBQW9CLENBQUNoRSxNQUFELEVBQVN0QixJQUFULEVBQWU7QUFDL0IsSUFBQSxNQUFNdUYsT0FBTyxHQUFHdkYsSUFBSSxHQUFHLElBQUtULENBQUFBLElBQUwsQ0FBVTZGLFFBQVYsQ0FBbUJwRixJQUFuQixDQUFILEdBQThCLElBQWxELENBQUE7O0lBQ0EsSUFBSXVGLE9BQU8sS0FBS2pELFNBQWhCLEVBQTJCO0FBQ3ZCa0QsTUFBQUEsS0FBSyxDQUFDQyxJQUFOLENBQVksQ0FBQSxpQkFBQSxFQUFtQnpGLElBQUssQ0FBcEMsbUJBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxNQUFBLE9BQUE7QUFDSCxLQUFBOztBQUNELElBQUEsTUFBTUUsT0FBTyxHQUFHb0IsTUFBTSxDQUFDb0UsY0FBUCxDQUFzQixRQUF0QixDQUFoQixDQUFBOztBQUNBLElBQUEsS0FBSyxJQUFJdkYsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR0QsT0FBTyxDQUFDRSxNQUE1QixFQUFvQ0QsQ0FBQyxFQUFyQyxFQUF5QztBQUNyQyxNQUFBLE1BQU13RixlQUFlLEdBQUd6RixPQUFPLENBQUNDLENBQUQsQ0FBL0IsQ0FBQTs7QUFDQSxNQUFBLElBQUEsQ0FBS3lGLHFCQUFMLENBQTJCTCxPQUEzQixFQUFvQ0ksZUFBZSxDQUFDdEIsYUFBcEQsQ0FBQSxDQUFBO0FBQ0gsS0FBQTtBQUNKLEdBQUE7O0FBR0R3QixFQUFBQSw2QkFBNkIsQ0FBQ0MsU0FBRCxFQUFZOUYsSUFBWixFQUFrQjtBQUMzQyxJQUFBLE1BQU11RixPQUFPLEdBQUd2RixJQUFJLEdBQUcsSUFBS1QsQ0FBQUEsSUFBTCxDQUFVNkYsUUFBVixDQUFtQnBGLElBQW5CLENBQUgsR0FBOEIsSUFBbEQsQ0FBQTs7SUFDQSxJQUFJdUYsT0FBTyxLQUFLakQsU0FBaEIsRUFBMkI7QUFDdkJrRCxNQUFBQSxLQUFLLENBQUNDLElBQU4sQ0FBWSxDQUFBLGlCQUFBLEVBQW1CekYsSUFBSyxDQUFwQyxtQkFBQSxDQUFBLENBQUEsQ0FBQTtBQUNBLE1BQUEsT0FBQTtBQUNILEtBQUE7O0FBQ0QsSUFBQSxJQUFBLENBQUs0RixxQkFBTCxDQUEyQkwsT0FBM0IsRUFBb0NPLFNBQXBDLENBQUEsQ0FBQTtBQUNILEdBQUE7O0FBR0RGLEVBQUFBLHFCQUFxQixDQUFDTCxPQUFELEVBQVVPLFNBQVYsRUFBcUI7QUFDdENBLElBQUFBLFNBQVMsQ0FBQ2pCLE9BQVYsQ0FBbUJrQixRQUFELElBQWM7TUFDNUIsSUFBSVIsT0FBTyxLQUFLLElBQWhCLEVBQXNCO0FBQ2xCUSxRQUFBQSxRQUFRLENBQUMxRCxRQUFULEdBQW9CLElBQUEsQ0FBSzFCLGdCQUF6QixDQUFBO0FBQ0gsT0FGRCxNQUVPO0FBQ0gsUUFBQSxNQUFNcUYsWUFBWSxHQUFHLElBQUt6RyxDQUFBQSxJQUFMLENBQVV5RyxZQUFWLENBQXVCRCxRQUFRLENBQUNoRSxJQUFULENBQWNLLEVBQXJDLENBQXJCLENBQUE7O0FBQ0EsUUFBQSxJQUFJNEQsWUFBSixFQUFrQjtBQUNkRCxVQUFBQSxRQUFRLENBQUMxRCxRQUFULEdBQW9CLElBQUEsQ0FBSzlDLElBQUwsQ0FBVWUsU0FBVixDQUFvQjBGLFlBQVksQ0FBQ1QsT0FBRCxDQUFoQyxDQUFwQixDQUFBO0FBQ0gsU0FBQTtBQUNKLE9BQUE7O0FBQ0RDLE1BQUFBLEtBQUssQ0FBQ1MsTUFBTixDQUFhRixRQUFRLENBQUMxRCxRQUF0QixDQUFBLENBQUE7S0FUSixDQUFBLENBQUE7QUFXSCxHQUFBOztBQUcwQixFQUFBLE9BQXBCNkMsb0JBQW9CLENBQUNnQixVQUFELEVBQWFDLFFBQWIsRUFBdUI7SUFHOUMsSUFBSXJFLElBQUksR0FBRyxJQUFYLENBQUE7O0FBQ0EsSUFBQSxJQUFJb0UsVUFBVSxDQUFDOUYsTUFBWCxLQUFzQixDQUExQixFQUE2QjtBQUV6QjBCLE1BQUFBLElBQUksR0FBR29FLFVBQVUsQ0FBQyxDQUFELENBQWpCLENBQUE7QUFDSCxLQUhELE1BR087QUFFSHBFLE1BQUFBLElBQUksR0FBRyxJQUFJcUUsUUFBSixDQUFhLFlBQWIsQ0FBUCxDQUFBOztBQUNBLE1BQUEsS0FBSyxNQUFNeEIsS0FBWCxJQUFvQnVCLFVBQXBCLEVBQWdDO1FBQzVCcEUsSUFBSSxDQUFDZ0MsUUFBTCxDQUFjYSxLQUFkLENBQUEsQ0FBQTtBQUNILE9BQUE7QUFDSixLQUFBOztBQUVELElBQUEsT0FBTzdDLElBQVAsQ0FBQTtBQUNILEdBQUE7O0FBR2lCLEVBQUEsT0FBWGhCLFdBQVcsQ0FBQ2tDLEdBQUQsRUFBTXRELGVBQU4sRUFBdUI7QUFFckMsSUFBQSxNQUFNbUMsa0JBQWtCLEdBQUcsU0FBckJBLGtCQUFxQixDQUFVaEIsS0FBVixFQUFpQmtCLElBQWpCLEVBQXVCRSxLQUF2QixFQUE4Qm1FLGFBQTlCLEVBQTZDOUYsU0FBN0MsRUFBd0R5QyxJQUF4RCxFQUE4RGIsUUFBOUQsRUFBd0U7TUFDL0YsTUFBTUMsYUFBYSxHQUFHYSxHQUFHLENBQUNoQixvQkFBSixDQUF5QkQsSUFBSSxDQUFDSyxFQUE5QixDQUF0QixDQUFBO01BQ0EsTUFBTUMsUUFBUSxHQUFJRixhQUFhLEtBQUtHLFNBQW5CLEdBQWdDNUMsZUFBaEMsR0FBa0RZLFNBQVMsQ0FBQzZCLGFBQUQsQ0FBNUUsQ0FBQTtNQUNBLE1BQU1JLFlBQVksR0FBRyxJQUFJQyxZQUFKLENBQWlCVCxJQUFqQixFQUF1Qk0sUUFBdkIsRUFBaUNVLElBQWpDLENBQXJCLENBQUE7O01BRUEsSUFBSWhCLElBQUksQ0FBQ1UsS0FBVCxFQUFnQjtRQUNaLE1BQU1DLGFBQWEsR0FBRyxJQUFJQyxhQUFKLENBQWtCWixJQUFJLENBQUNVLEtBQXZCLENBQXRCLENBQUE7UUFDQUYsWUFBWSxDQUFDRyxhQUFiLEdBQTZCQSxhQUE3QixDQUFBO0FBQ0E3QixRQUFBQSxLQUFLLENBQUN3RixjQUFOLENBQXFCaEcsSUFBckIsQ0FBMEJxQyxhQUExQixDQUFBLENBQUE7QUFDSCxPQUFBOztBQUVELE1BQUEsSUFBSVIsUUFBUSxDQUFDVSxjQUFULENBQXdCLE1BQXhCLENBQUosRUFBcUM7QUFDakMsUUFBQSxNQUFNMEQsU0FBUyxHQUFHcEUsUUFBUSxDQUFDK0MsSUFBM0IsQ0FBQTtBQUNBLFFBQUEsTUFBTUEsSUFBSSxHQUFHaEQsS0FBSyxDQUFDcUUsU0FBRCxDQUFsQixDQUFBO1FBQ0F2RSxJQUFJLENBQUNrRCxJQUFMLEdBQVlBLElBQVosQ0FBQTtBQUVBLFFBQUEsTUFBTUgsWUFBWSxHQUFHc0IsYUFBYSxDQUFDRSxTQUFELENBQWxDLENBQUE7UUFDQS9ELFlBQVksQ0FBQ3VDLFlBQWIsR0FBNEJBLFlBQTVCLENBQUE7QUFDQWpFLFFBQUFBLEtBQUssQ0FBQ3VGLGFBQU4sQ0FBb0IvRixJQUFwQixDQUF5QnlFLFlBQXpCLENBQUEsQ0FBQTtBQUNILE9BQUE7O0FBRURqRSxNQUFBQSxLQUFLLENBQUN3RCxhQUFOLENBQW9CaEUsSUFBcEIsQ0FBeUJrQyxZQUF6QixDQUFBLENBQUE7S0FyQkosQ0FBQTs7QUF3QkEsSUFBQSxNQUFNMUIsS0FBSyxHQUFHLElBQUkwRixLQUFKLEVBQWQsQ0FBQTtJQUdBLE1BQU1ILGFBQWEsR0FBRyxFQUF0QixDQUFBOztBQUNBLElBQUEsS0FBSyxNQUFNbkIsSUFBWCxJQUFtQmpDLEdBQUcsQ0FBQ2YsS0FBdkIsRUFBOEI7QUFDMUIsTUFBQSxNQUFNNkMsWUFBWSxHQUFHLElBQUkwQixZQUFKLENBQWlCdkIsSUFBakIsQ0FBckIsQ0FBQTtBQUNBSCxNQUFBQSxZQUFZLENBQUMyQixLQUFiLEdBQXFCeEIsSUFBSSxDQUFDd0IsS0FBMUIsQ0FBQTtNQUNBTCxhQUFhLENBQUMvRixJQUFkLENBQW1CeUUsWUFBbkIsQ0FBQSxDQUFBO0FBQ0gsS0FBQTs7QUFHRGpFLElBQUFBLEtBQUssQ0FBQzZGLEtBQU4sR0FBY3JILG9CQUFvQixDQUFDNkYsb0JBQXJCLENBQTBDbEMsR0FBRyxDQUFDNEIsTUFBOUMsRUFBc0QsV0FBdEQsQ0FBZCxDQUFBOztBQUdBLElBQUEsS0FBSyxJQUFJekUsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRzZDLEdBQUcsQ0FBQ0ksS0FBSixDQUFVaEQsTUFBOUIsRUFBc0NELENBQUMsRUFBdkMsRUFBMkM7QUFDdkMsTUFBQSxNQUFNNEMsSUFBSSxHQUFHQyxHQUFHLENBQUNJLEtBQUosQ0FBVWpELENBQVYsQ0FBYixDQUFBOztBQUNBLE1BQUEsSUFBSTRDLElBQUksQ0FBQ2pCLElBQUwsS0FBY2pCLEtBQUssQ0FBQzZGLEtBQXhCLEVBQStCO1FBQzNCLE1BQU14RSxRQUFRLEdBQUdjLEdBQUcsQ0FBQ00sSUFBSixDQUFTRixLQUFULENBQWVqRCxDQUFmLENBQWpCLENBQUE7O0FBQ0EsUUFBQSxJQUFJK0IsUUFBUSxDQUFDVSxjQUFULENBQXdCLE1BQXhCLENBQUosRUFBcUM7VUFDakMsTUFBTVcsU0FBUyxHQUFHUCxHQUFHLENBQUM5QyxPQUFKLENBQVlnQyxRQUFRLENBQUNILElBQXJCLENBQUEsQ0FBMkJ5QixNQUE3QyxDQUFBOztBQUNBLFVBQUEsS0FBSyxJQUFJQyxFQUFFLEdBQUcsQ0FBZCxFQUFpQkEsRUFBRSxHQUFHRixTQUFTLENBQUNuRCxNQUFoQyxFQUF3Q3FELEVBQUUsRUFBMUMsRUFBOEM7QUFDMUMsWUFBQSxNQUFNMUIsSUFBSSxHQUFHd0IsU0FBUyxDQUFDRSxFQUFELENBQXRCLENBQUE7O0FBQ0EsWUFBQSxJQUFJMUIsSUFBSixFQUFVO0FBQ05GLGNBQUFBLGtCQUFrQixDQUFDaEIsS0FBRCxFQUFRa0IsSUFBUixFQUFjaUIsR0FBRyxDQUFDZixLQUFsQixFQUF5Qm1FLGFBQXpCLEVBQXdDcEQsR0FBRyxDQUFDMUMsU0FBNUMsRUFBdUR5QyxJQUF2RCxFQUE2RGIsUUFBN0QsQ0FBbEIsQ0FBQTtBQUNILGFBQUE7QUFDSixXQUFBO0FBQ0osU0FBQTtBQUNKLE9BQUE7QUFDSixLQUFBOztBQUVELElBQUEsT0FBT3JCLEtBQVAsQ0FBQTtBQUNILEdBQUE7O0FBRUQ4RixFQUFBQSxPQUFPLEdBQUc7SUFDTixNQUFNQyxRQUFRLEdBQUcsSUFBQSxDQUFLbEcsT0FBdEIsQ0FBQTs7QUFFQSxJQUFBLE1BQU1tRyxZQUFZLEdBQUcsU0FBZkEsWUFBZSxDQUFVckgsS0FBVixFQUFpQjtNQUNsQ29ILFFBQVEsQ0FBQ0UsTUFBVCxDQUFnQnRILEtBQWhCLENBQUEsQ0FBQTtBQUNBQSxNQUFBQSxLQUFLLENBQUN1SCxNQUFOLEVBQUEsQ0FBQTtLQUZKLENBQUE7O0FBS0EsSUFBQSxNQUFNQyxhQUFhLEdBQUcsU0FBaEJBLGFBQWdCLENBQVV2SCxNQUFWLEVBQWtCO0FBQ3BDQSxNQUFBQSxNQUFNLENBQUNvRixPQUFQLENBQWUsVUFBVXJGLEtBQVYsRUFBaUI7UUFDNUJxSCxZQUFZLENBQUNySCxLQUFELENBQVosQ0FBQTtPQURKLENBQUEsQ0FBQTtLQURKLENBQUE7O0lBT0EsSUFBSSxJQUFBLENBQUtlLFVBQVQsRUFBcUI7TUFDakJ5RyxhQUFhLENBQUMsSUFBS3pHLENBQUFBLFVBQU4sQ0FBYixDQUFBO01BQ0EsSUFBS0EsQ0FBQUEsVUFBTCxHQUFrQixJQUFsQixDQUFBO0FBQ0gsS0FBQTs7SUFFRCxJQUFJLElBQUEsQ0FBS0ssUUFBVCxFQUFtQjtNQUNmb0csYUFBYSxDQUFDLElBQUtwRyxDQUFBQSxRQUFOLENBQWIsQ0FBQTtNQUNBLElBQUtBLENBQUFBLFFBQUwsR0FBZ0IsSUFBaEIsQ0FBQTtBQUNILEtBQUE7O0lBRUQsSUFBSSxJQUFBLENBQUtOLFNBQVQsRUFBb0I7TUFDaEIwRyxhQUFhLENBQUMsSUFBSzFHLENBQUFBLFNBQU4sQ0FBYixDQUFBO01BQ0EsSUFBS0EsQ0FBQUEsU0FBTCxHQUFpQixJQUFqQixDQUFBO0FBQ0gsS0FBQTs7SUFFRCxJQUFJLElBQUEsQ0FBS0osT0FBVCxFQUFrQjtNQUNkOEcsYUFBYSxDQUFDLElBQUs5RyxDQUFBQSxPQUFOLENBQWIsQ0FBQTtNQUNBLElBQUtBLENBQUFBLE9BQUwsR0FBZSxJQUFmLENBQUE7QUFDSCxLQUFBOztJQUVELElBQUksSUFBQSxDQUFLTSxNQUFULEVBQWlCO01BQ2JxRyxZQUFZLENBQUMsSUFBS3JHLENBQUFBLE1BQU4sQ0FBWixDQUFBO01BQ0EsSUFBS0EsQ0FBQUEsTUFBTCxHQUFjLElBQWQsQ0FBQTtBQUNILEtBQUE7O0lBRUQsSUFBS2pCLENBQUFBLElBQUwsR0FBWSxJQUFaLENBQUE7SUFDQSxJQUFLRSxDQUFBQSxNQUFMLEdBQWMsSUFBZCxDQUFBO0FBQ0gsR0FBQTs7QUE3VnNCOzs7OyJ9
