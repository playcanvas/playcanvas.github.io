/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { math } from '../math/math.js';
import { hasAudioContext } from './capabilities.js';

class Channel {
  constructor(manager, sound, options = {}) {
    this.volume = options.volume === undefined ? 1 : options.volume;
    this.loop = options.loop === undefined ? false : options.loop;
    this.pitch = options.pitch === undefined ? 1 : options.pitch;
    this.sound = sound;
    this.paused = false;
    this.suspended = false;
    this.manager = manager;
    this.source = null;

    if (hasAudioContext()) {
      this.startTime = 0;
      this.startOffset = 0;
      const context = manager.context;
      this.gain = context.createGain();
    } else if (sound.audio) {
      this.source = sound.audio.cloneNode(false);
      this.source.pause();
    }
  }

  getVolume() {
    return this.volume;
  }

  getLoop() {
    return this.loop;
  }

  setLoop(loop) {
    this.loop = loop;

    if (this.source) {
      this.source.loop = loop;
    }
  }

  getPitch() {
    return this.pitch;
  }

  onManagerVolumeChange() {
    this.setVolume(this.getVolume());
  }

  onManagerSuspend() {
    if (this.isPlaying() && !this.suspended) {
      this.suspended = true;
      this.pause();
    }
  }

  onManagerResume() {
    if (this.suspended) {
      this.suspended = false;
      this.unpause();
    }
  }

  play() {
    if (this.source) {
      throw new Error('Call stop() before calling play()');
    }

    this._createSource();

    if (!this.source) {
      return;
    }

    this.startTime = this.manager.context.currentTime;
    this.source.start(0, this.startOffset % this.source.buffer.duration);
    this.setVolume(this.volume);
    this.setLoop(this.loop);
    this.setPitch(this.pitch);
    this.manager.on('volumechange', this.onManagerVolumeChange, this);
    this.manager.on('suspend', this.onManagerSuspend, this);
    this.manager.on('resume', this.onManagerResume, this);
    if (this.manager.suspended) this.onManagerSuspend();
  }

  pause() {
    if (this.source) {
      this.paused = true;
      this.startOffset += this.manager.context.currentTime - this.startTime;
      this.source.stop(0);
      this.source = null;
    }
  }

  unpause() {
    if (this.source || !this.paused) {
      console.warn('Call pause() before unpausing.');
      return;
    }

    this._createSource();

    if (!this.source) {
      return;
    }

    this.startTime = this.manager.context.currentTime;
    this.source.start(0, this.startOffset % this.source.buffer.duration);
    this.setVolume(this.volume);
    this.setLoop(this.loop);
    this.setPitch(this.pitch);
    this.paused = false;
  }

  stop() {
    if (this.source) {
      this.source.stop(0);
      this.source = null;
    }

    this.manager.off('volumechange', this.onManagerVolumeChange, this);
    this.manager.off('suspend', this.onManagerSuspend, this);
    this.manager.off('resume', this.onManagerResume, this);
  }

  setVolume(volume) {
    volume = math.clamp(volume, 0, 1);
    this.volume = volume;

    if (this.gain) {
      this.gain.gain.value = volume * this.manager.volume;
    }
  }

  setPitch(pitch) {
    this.pitch = pitch;

    if (this.source) {
      this.source.playbackRate.value = pitch;
    }
  }

  isPlaying() {
    return !this.paused && this.source.playbackState === this.source.PLAYING_STATE;
  }

  getDuration() {
    return this.source ? this.source.buffer.duration : 0;
  }

  _createSource() {
    const context = this.manager.context;

    if (this.sound.buffer) {
      this.source = context.createBufferSource();
      this.source.buffer = this.sound.buffer;
      this.source.connect(this.gain);
      this.gain.connect(context.destination);

      if (!this.loop) {
        this.source.onended = this.pause.bind(this);
      }
    }
  }

}

if (!hasAudioContext()) {
  Object.assign(Channel.prototype, {
    play: function () {
      if (this.source) {
        this.paused = false;
        this.setVolume(this.volume);
        this.setLoop(this.loop);
        this.setPitch(this.pitch);
        this.source.play();
      }

      this.manager.on('volumechange', this.onManagerVolumeChange, this);
      this.manager.on('suspend', this.onManagerSuspend, this);
      this.manager.on('resume', this.onManagerResume, this);
      if (this.manager.suspended) this.onManagerSuspend();
    },
    pause: function () {
      if (this.source) {
        this.paused = true;
        this.source.pause();
      }
    },
    unpause: function () {
      if (this.source) {
        this.paused = false;
        this.source.play();
      }
    },
    stop: function () {
      if (this.source) {
        this.source.pause();
      }

      this.manager.off('volumechange', this.onManagerVolumeChange, this);
      this.manager.off('suspend', this.onManagerSuspend, this);
      this.manager.off('resume', this.onManagerResume, this);
    },
    setVolume: function (volume) {
      volume = math.clamp(volume, 0, 1);
      this.volume = volume;

      if (this.source) {
        this.source.volume = volume * this.manager.volume;
      }
    },
    setPitch: function (pitch) {
      this.pitch = pitch;

      if (this.source) {
        this.source.playbackRate = pitch;
      }
    },
    getDuration: function () {
      return this.source && !isNaN(this.source.duration) ? this.source.duration : 0;
    },
    isPlaying: function () {
      return !this.source.paused;
    }
  });
}

export { Channel };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbm5lbC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2F1ZGlvL2NoYW5uZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbWF0aCB9IGZyb20gJy4uL21hdGgvbWF0aC5qcyc7XG5cbmltcG9ydCB7IGhhc0F1ZGlvQ29udGV4dCB9IGZyb20gJy4vY2FwYWJpbGl0aWVzLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uL3NvdW5kL3NvdW5kLmpzJykuU291bmR9IFNvdW5kICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vc291bmQvbWFuYWdlci5qcycpLlNvdW5kTWFuYWdlcn0gU291bmRNYW5hZ2VyICovXG5cbi8qKlxuICogQSBjaGFubmVsIGlzIGNyZWF0ZWQgd2hlbiB0aGUge0BsaW5rIFNvdW5kTWFuYWdlcn0gYmVnaW5zIHBsYXliYWNrIG9mIGEge0BsaW5rIFNvdW5kfS4gVXN1YWxseVxuICogY3JlYXRlZCBpbnRlcm5hbGx5IGJ5IHtAbGluayBTb3VuZE1hbmFnZXIjcGxheVNvdW5kfSBvciB7QGxpbmsgU291bmRNYW5hZ2VyI3BsYXlTb3VuZDNkfS5cbiAqIERldmVsb3BlcnMgdXN1YWxseSB3b24ndCBoYXZlIHRvIGNyZWF0ZSBDaGFubmVscyBtYW51YWxseS5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIENoYW5uZWwge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBDaGFubmVsIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTb3VuZE1hbmFnZXJ9IG1hbmFnZXIgLSBUaGUgU291bmRNYW5hZ2VyIGluc3RhbmNlLlxuICAgICAqIEBwYXJhbSB7U291bmR9IHNvdW5kIC0gVGhlIHNvdW5kIHRvIHBsYXliYWNrLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBPcHRpb25hbCBvcHRpb25zIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMudm9sdW1lPTFdIC0gVGhlIHBsYXliYWNrIHZvbHVtZSwgYmV0d2VlbiAwIGFuZCAxLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5waXRjaD0xXSAtIFRoZSByZWxhdGl2ZSBwaXRjaCwgZGVmYXVsdCBvZiAxLCBwbGF5cyBhdCBub3JtYWwgcGl0Y2guXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5sb29wPWZhbHNlXSAtIFdoZXRoZXIgdGhlIHNvdW5kIHNob3VsZCBsb29wIHdoZW4gaXQgcmVhY2hlcyB0aGVcbiAgICAgKiBlbmQgb3Igbm90LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG1hbmFnZXIsIHNvdW5kLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgdGhpcy52b2x1bWUgPSAob3B0aW9ucy52b2x1bWUgPT09IHVuZGVmaW5lZCkgPyAxIDogb3B0aW9ucy52b2x1bWU7XG4gICAgICAgIHRoaXMubG9vcCA9IChvcHRpb25zLmxvb3AgPT09IHVuZGVmaW5lZCkgPyBmYWxzZSA6IG9wdGlvbnMubG9vcDtcbiAgICAgICAgdGhpcy5waXRjaCA9IChvcHRpb25zLnBpdGNoID09PSB1bmRlZmluZWQgPyAxIDogb3B0aW9ucy5waXRjaCk7XG5cbiAgICAgICAgdGhpcy5zb3VuZCA9IHNvdW5kO1xuXG4gICAgICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3VzcGVuZGVkID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5tYW5hZ2VyID0gbWFuYWdlcjtcblxuICAgICAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG5cbiAgICAgICAgaWYgKGhhc0F1ZGlvQ29udGV4dCgpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IDA7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0T2Zmc2V0ID0gMDtcblxuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IG1hbmFnZXIuY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMuZ2FpbiA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgICAgICB9IGVsc2UgaWYgKHNvdW5kLmF1ZGlvKSB7XG4gICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgc291bmQgd2FzXG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdW5kLmF1ZGlvLmNsb25lTm9kZShmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5wYXVzZSgpOyAvLyBub3QgaW5pdGlhbGx5IHBsYXlpbmdcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCB2YWx1ZSBmb3IgdGhlIHZvbHVtZS4gQmV0d2VlbiAwIGFuZCAxLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gVGhlIHZvbHVtZSBvZiB0aGUgY2hhbm5lbC5cbiAgICAgKi9cbiAgICBnZXRWb2x1bWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZvbHVtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgbG9vcGluZyBzdGF0ZSBvZiB0aGUgQ2hhbm5lbC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUaGUgbG9vcCBwcm9wZXJ0eSBmb3IgdGhlIGNoYW5uZWwuXG4gICAgICovXG4gICAgZ2V0TG9vcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9vcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUvZGlzYWJsZSB0aGUgbG9vcCBwcm9wZXJ0eSB0byBtYWtlIHRoZSBzb3VuZCByZXN0YXJ0IGZyb20gdGhlIGJlZ2lubmluZyB3aGVuIGl0XG4gICAgICogcmVhY2hlcyB0aGUgZW5kLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBsb29wIC0gVHJ1ZSB0byBsb29wIHRoZSBzb3VuZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIHNldExvb3AobG9vcCkge1xuICAgICAgICB0aGlzLmxvb3AgPSBsb29wO1xuICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlLmxvb3AgPSBsb29wO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHBpdGNoIG9mIHRoZSBDaGFubmVsLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gVGhlIHBpdGNoIG9mIHRoZSBjaGFubmVsLlxuICAgICAqL1xuICAgIGdldFBpdGNoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5waXRjaDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIG1hbmFnZXIncyAndm9sdW1lY2hhbmdlJyBldmVudC5cbiAgICAgKi9cbiAgICBvbk1hbmFnZXJWb2x1bWVDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMuc2V0Vm9sdW1lKHRoaXMuZ2V0Vm9sdW1lKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgbWFuYWdlcidzICdzdXNwZW5kJyBldmVudC5cbiAgICAgKi9cbiAgICBvbk1hbmFnZXJTdXNwZW5kKCkge1xuICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcoKSAmJiAhdGhpcy5zdXNwZW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3VzcGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgbWFuYWdlcidzICdyZXN1bWUnIGV2ZW50LlxuICAgICAqL1xuICAgIG9uTWFuYWdlclJlc3VtZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VzcGVuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN1c3BlbmRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy51bnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCZWdpbiBwbGF5YmFjayBvZiBzb3VuZC5cbiAgICAgKi9cbiAgICBwbGF5KCkge1xuICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FsbCBzdG9wKCkgYmVmb3JlIGNhbGxpbmcgcGxheSgpJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jcmVhdGVTb3VyY2UoKTtcbiAgICAgICAgaWYgKCF0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cblxuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMubWFuYWdlci5jb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICB0aGlzLnNvdXJjZS5zdGFydCgwLCB0aGlzLnN0YXJ0T2Zmc2V0ICUgdGhpcy5zb3VyY2UuYnVmZmVyLmR1cmF0aW9uKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIHZvbHVtZSBhbmQgbG9vcCAtIG5vdGUgbW92ZWQgdG8gYmUgYWZ0ZXIgc3RhcnQoKSBiZWNhdXNlIG9mIENocm9tZSBidWdcbiAgICAgICAgdGhpcy5zZXRWb2x1bWUodGhpcy52b2x1bWUpO1xuICAgICAgICB0aGlzLnNldExvb3AodGhpcy5sb29wKTtcbiAgICAgICAgdGhpcy5zZXRQaXRjaCh0aGlzLnBpdGNoKTtcblxuICAgICAgICB0aGlzLm1hbmFnZXIub24oJ3ZvbHVtZWNoYW5nZScsIHRoaXMub25NYW5hZ2VyVm9sdW1lQ2hhbmdlLCB0aGlzKTtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLm9uKCdzdXNwZW5kJywgdGhpcy5vbk1hbmFnZXJTdXNwZW5kLCB0aGlzKTtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLm9uKCdyZXN1bWUnLCB0aGlzLm9uTWFuYWdlclJlc3VtZSwgdGhpcyk7XG5cbiAgICAgICAgLy8gc3VzcGVuZCBpbW1lZGlhdGVseSBpZiBtYW5hZ2VyIGlzIHN1c3BlbmRlZFxuICAgICAgICBpZiAodGhpcy5tYW5hZ2VyLnN1c3BlbmRlZClcbiAgICAgICAgICAgIHRoaXMub25NYW5hZ2VyU3VzcGVuZCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhdXNlIHBsYXliYWNrIG9mIHNvdW5kLiBDYWxsIHVucGF1c2UoKSB0byByZXN1bWUgcGxheWJhY2sgZnJvbSB0aGUgc2FtZSBwb3NpdGlvbi5cbiAgICAgKi9cbiAgICBwYXVzZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIHRoaXMuc3RhcnRPZmZzZXQgKz0gdGhpcy5tYW5hZ2VyLmNvbnRleHQuY3VycmVudFRpbWUgLSB0aGlzLnN0YXJ0VGltZTtcbiAgICAgICAgICAgIHRoaXMuc291cmNlLnN0b3AoMCk7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXN1bWUgcGxheWJhY2sgb2YgdGhlIHNvdW5kLiBQbGF5YmFjayByZXN1bWVzIGF0IHRoZSBwb2ludCB0aGF0IHRoZSBhdWRpbyB3YXMgcGF1c2VkLlxuICAgICAqL1xuICAgIHVucGF1c2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZSB8fCAhdGhpcy5wYXVzZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignQ2FsbCBwYXVzZSgpIGJlZm9yZSB1bnBhdXNpbmcuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jcmVhdGVTb3VyY2UoKTtcbiAgICAgICAgaWYgKCF0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLm1hbmFnZXIuY29udGV4dC5jdXJyZW50VGltZTtcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3RhcnQoMCwgdGhpcy5zdGFydE9mZnNldCAlIHRoaXMuc291cmNlLmJ1ZmZlci5kdXJhdGlvbik7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBwYXJhbWV0ZXJzXG4gICAgICAgIHRoaXMuc2V0Vm9sdW1lKHRoaXMudm9sdW1lKTtcbiAgICAgICAgdGhpcy5zZXRMb29wKHRoaXMubG9vcCk7XG4gICAgICAgIHRoaXMuc2V0UGl0Y2godGhpcy5waXRjaCk7XG5cbiAgICAgICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHBsYXliYWNrIG9mIHNvdW5kLiBDYWxsaW5nIHBsYXkoKSBhZ2FpbiB3aWxsIHJlc3RhcnQgcGxheWJhY2sgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZVxuICAgICAqIHNvdW5kLlxuICAgICAqL1xuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2Uuc3RvcCgwKTtcbiAgICAgICAgICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubWFuYWdlci5vZmYoJ3ZvbHVtZWNoYW5nZScsIHRoaXMub25NYW5hZ2VyVm9sdW1lQ2hhbmdlLCB0aGlzKTtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLm9mZignc3VzcGVuZCcsIHRoaXMub25NYW5hZ2VyU3VzcGVuZCwgdGhpcyk7XG4gICAgICAgIHRoaXMubWFuYWdlci5vZmYoJ3Jlc3VtZScsIHRoaXMub25NYW5hZ2VyUmVzdW1lLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHZvbHVtZSBvZiBwbGF5YmFjayBiZXR3ZWVuIDAgYW5kIDEuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdm9sdW1lIC0gVGhlIHZvbHVtZSBvZiB0aGUgc291bmQuIFdpbGwgYmUgY2xhbXBlZCBiZXR3ZWVuIDAgYW5kIDEuXG4gICAgICovXG4gICAgc2V0Vm9sdW1lKHZvbHVtZSkge1xuICAgICAgICB2b2x1bWUgPSBtYXRoLmNsYW1wKHZvbHVtZSwgMCwgMSk7XG4gICAgICAgIHRoaXMudm9sdW1lID0gdm9sdW1lO1xuICAgICAgICBpZiAodGhpcy5nYWluKSB7XG4gICAgICAgICAgICB0aGlzLmdhaW4uZ2Fpbi52YWx1ZSA9IHZvbHVtZSAqIHRoaXMubWFuYWdlci52b2x1bWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRQaXRjaChwaXRjaCkge1xuICAgICAgICB0aGlzLnBpdGNoID0gcGl0Y2g7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UucGxheWJhY2tSYXRlLnZhbHVlID0gcGl0Y2g7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpc1BsYXlpbmcoKSB7XG4gICAgICAgIHJldHVybiAoIXRoaXMucGF1c2VkICYmICh0aGlzLnNvdXJjZS5wbGF5YmFja1N0YXRlID09PSB0aGlzLnNvdXJjZS5QTEFZSU5HX1NUQVRFKSk7XG4gICAgfVxuXG4gICAgZ2V0RHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZSA/IHRoaXMuc291cmNlLmJ1ZmZlci5kdXJhdGlvbiA6IDA7XG4gICAgfVxuXG4gICAgX2NyZWF0ZVNvdXJjZSgpIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMubWFuYWdlci5jb250ZXh0O1xuXG4gICAgICAgIGlmICh0aGlzLnNvdW5kLmJ1ZmZlcikge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UuYnVmZmVyID0gdGhpcy5zb3VuZC5idWZmZXI7XG5cbiAgICAgICAgICAgIC8vIENvbm5lY3QgdXAgdGhlIG5vZGVzXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbik7XG4gICAgICAgICAgICB0aGlzLmdhaW4uY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmxvb3ApIHtcbiAgICAgICAgICAgICAgICAvLyBtYXJrIHNvdXJjZSBhcyBwYXVzZWQgd2hlbiBpdCBlbmRzXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2Uub25lbmRlZCA9IHRoaXMucGF1c2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuaWYgKCFoYXNBdWRpb0NvbnRleHQoKSkge1xuICAgIE9iamVjdC5hc3NpZ24oQ2hhbm5lbC5wcm90b3R5cGUsIHtcbiAgICAgICAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZvbHVtZSh0aGlzLnZvbHVtZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMb29wKHRoaXMubG9vcCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQaXRjaCh0aGlzLnBpdGNoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZS5wbGF5KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5vbigndm9sdW1lY2hhbmdlJywgdGhpcy5vbk1hbmFnZXJWb2x1bWVDaGFuZ2UsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLm9uKCdzdXNwZW5kJywgdGhpcy5vbk1hbmFnZXJTdXNwZW5kLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5vbigncmVzdW1lJywgdGhpcy5vbk1hbmFnZXJSZXN1bWUsIHRoaXMpO1xuXG4gICAgICAgICAgICAvLyBzdXNwZW5kIGltbWVkaWF0ZWx5IGlmIG1hbmFnZXIgaXMgc3VzcGVuZGVkXG4gICAgICAgICAgICBpZiAodGhpcy5tYW5hZ2VyLnN1c3BlbmRlZClcbiAgICAgICAgICAgICAgICB0aGlzLm9uTWFuYWdlclN1c3BlbmQoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2UucGF1c2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1bnBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlLnBsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZS5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIub2ZmKCd2b2x1bWVjaGFuZ2UnLCB0aGlzLm9uTWFuYWdlclZvbHVtZUNoYW5nZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIub2ZmKCdzdXNwZW5kJywgdGhpcy5vbk1hbmFnZXJTdXNwZW5kLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5vZmYoJ3Jlc3VtZScsIHRoaXMub25NYW5hZ2VyUmVzdW1lLCB0aGlzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWb2x1bWU6IGZ1bmN0aW9uICh2b2x1bWUpIHtcbiAgICAgICAgICAgIHZvbHVtZSA9IG1hdGguY2xhbXAodm9sdW1lLCAwLCAxKTtcbiAgICAgICAgICAgIHRoaXMudm9sdW1lID0gdm9sdW1lO1xuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2Uudm9sdW1lID0gdm9sdW1lICogdGhpcy5tYW5hZ2VyLnZvbHVtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRQaXRjaDogZnVuY3Rpb24gKHBpdGNoKSB7XG4gICAgICAgICAgICB0aGlzLnBpdGNoID0gcGl0Y2g7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZS5wbGF5YmFja1JhdGUgPSBwaXRjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBnZXREdXJhdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlICYmICFpc05hTih0aGlzLnNvdXJjZS5kdXJhdGlvbikgPyB0aGlzLnNvdXJjZS5kdXJhdGlvbiA6IDA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNQbGF5aW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuc291cmNlLnBhdXNlZDtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5leHBvcnQgeyBDaGFubmVsIH07XG4iXSwibmFtZXMiOlsiQ2hhbm5lbCIsImNvbnN0cnVjdG9yIiwibWFuYWdlciIsInNvdW5kIiwib3B0aW9ucyIsInZvbHVtZSIsInVuZGVmaW5lZCIsImxvb3AiLCJwaXRjaCIsInBhdXNlZCIsInN1c3BlbmRlZCIsInNvdXJjZSIsImhhc0F1ZGlvQ29udGV4dCIsInN0YXJ0VGltZSIsInN0YXJ0T2Zmc2V0IiwiY29udGV4dCIsImdhaW4iLCJjcmVhdGVHYWluIiwiYXVkaW8iLCJjbG9uZU5vZGUiLCJwYXVzZSIsImdldFZvbHVtZSIsImdldExvb3AiLCJzZXRMb29wIiwiZ2V0UGl0Y2giLCJvbk1hbmFnZXJWb2x1bWVDaGFuZ2UiLCJzZXRWb2x1bWUiLCJvbk1hbmFnZXJTdXNwZW5kIiwiaXNQbGF5aW5nIiwib25NYW5hZ2VyUmVzdW1lIiwidW5wYXVzZSIsInBsYXkiLCJFcnJvciIsIl9jcmVhdGVTb3VyY2UiLCJjdXJyZW50VGltZSIsInN0YXJ0IiwiYnVmZmVyIiwiZHVyYXRpb24iLCJzZXRQaXRjaCIsIm9uIiwic3RvcCIsImNvbnNvbGUiLCJ3YXJuIiwib2ZmIiwibWF0aCIsImNsYW1wIiwidmFsdWUiLCJwbGF5YmFja1JhdGUiLCJwbGF5YmFja1N0YXRlIiwiUExBWUlOR19TVEFURSIsImdldER1cmF0aW9uIiwiY3JlYXRlQnVmZmVyU291cmNlIiwiY29ubmVjdCIsImRlc3RpbmF0aW9uIiwib25lbmRlZCIsImJpbmQiLCJPYmplY3QiLCJhc3NpZ24iLCJwcm90b3R5cGUiLCJpc05hTiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFjQSxNQUFNQSxPQUFOLENBQWM7RUFZVkMsV0FBVyxDQUFDQyxPQUFELEVBQVVDLEtBQVYsRUFBaUJDLE9BQU8sR0FBRyxFQUEzQixFQUErQjtBQUN0QyxJQUFBLElBQUEsQ0FBS0MsTUFBTCxHQUFlRCxPQUFPLENBQUNDLE1BQVIsS0FBbUJDLFNBQXBCLEdBQWlDLENBQWpDLEdBQXFDRixPQUFPLENBQUNDLE1BQTNELENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBS0UsSUFBTCxHQUFhSCxPQUFPLENBQUNHLElBQVIsS0FBaUJELFNBQWxCLEdBQStCLEtBQS9CLEdBQXVDRixPQUFPLENBQUNHLElBQTNELENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBS0MsS0FBTCxHQUFjSixPQUFPLENBQUNJLEtBQVIsS0FBa0JGLFNBQWxCLEdBQThCLENBQTlCLEdBQWtDRixPQUFPLENBQUNJLEtBQXhELENBQUE7SUFFQSxJQUFLTCxDQUFBQSxLQUFMLEdBQWFBLEtBQWIsQ0FBQTtJQUVBLElBQUtNLENBQUFBLE1BQUwsR0FBYyxLQUFkLENBQUE7SUFDQSxJQUFLQyxDQUFBQSxTQUFMLEdBQWlCLEtBQWpCLENBQUE7SUFFQSxJQUFLUixDQUFBQSxPQUFMLEdBQWVBLE9BQWYsQ0FBQTtJQUVBLElBQUtTLENBQUFBLE1BQUwsR0FBYyxJQUFkLENBQUE7O0lBRUEsSUFBSUMsZUFBZSxFQUFuQixFQUF1QjtNQUNuQixJQUFLQyxDQUFBQSxTQUFMLEdBQWlCLENBQWpCLENBQUE7TUFDQSxJQUFLQyxDQUFBQSxXQUFMLEdBQW1CLENBQW5CLENB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
