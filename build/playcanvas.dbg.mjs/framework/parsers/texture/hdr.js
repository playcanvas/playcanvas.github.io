/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { ReadStream } from '../../../core/read-stream.js';
import { Debug } from '../../../core/debug.js';
import { Texture } from '../../../platform/graphics/texture.js';
import { TEXHINT_ASSET, ADDRESS_REPEAT, ADDRESS_CLAMP_TO_EDGE, FILTER_NEAREST, PIXELFORMAT_R8_G8_B8_A8, TEXTURETYPE_RGBE } from '../../../platform/graphics/constants.js';
import { Asset } from '../../asset/asset.js';

class HdrParser {
  constructor(registry) {
    this.maxRetries = 0;
  }
  load(url, callback, asset) {
    Asset.fetchArrayBuffer(url.load, callback, asset, this.maxRetries);
  }
  open(url, data, device) {
    const textureData = this.parse(data);
    if (!textureData) {
      return null;
    }
    const texture = new Texture(device, {
      name: url,
      profilerHint: TEXHINT_ASSET,
      addressU: ADDRESS_REPEAT,
      addressV: ADDRESS_CLAMP_TO_EDGE,
      minFilter: FILTER_NEAREST,
      magFilter: FILTER_NEAREST,
      width: textureData.width,
      height: textureData.height,
      levels: textureData.levels,
      format: PIXELFORMAT_R8_G8_B8_A8,
      type: TEXTURETYPE_RGBE,
      mipmaps: false
    });
    texture.upload();
    return texture;
  }

  parse(data) {
    const readStream = new ReadStream(data);

    const magic = readStream.readLine();
    if (!magic.startsWith('#?RADIANCE')) {
      Debug.error('radiance header has invalid magic');
      return null;
    }

    const variables = {};
    while (true) {
      const line = readStream.readLine();
      if (line.length === 0) {
        break;
      } else {
        const parts = line.split('=');
        if (parts.length === 2) {
          variables[parts[0]] = parts[1];
        }
      }
    }

    if (!variables.hasOwnProperty('FORMAT')) {
      Debug.error('radiance header missing FORMAT variable');
      return null;
    }

    const resolution = readStream.readLine().split(' ');
    if (resolution.length !== 4) {
      Debug.error('radiance header has invalid resolution');
      return null;
    }
    const height = parseInt(resolution[1], 10);
    const width = parseInt(resolution[3], 10);
    const pixels = this._readPixels(readStream, width, height, resolution[0] === '-Y');
    if (!pixels) {
      return null;
    }

    return {
      width: width,
      height: height,
      levels: [pixels]
    };
  }
  _readPixels(readStream, width, height, flipY) {
    if (width < 8 || width > 0x7fff) {
      return this._readPixelsFlat(readStream, width, height);
    }
    const rgbe = [0, 0, 0, 0];

    readStream.readArray(rgbe);
    if (rgbe[0] !== 2 || rgbe[1] !== 2 || (rgbe[2] & 0x80) !== 0) {
      readStream.skip(-4);
      return this._readPixelsFlat(readStream, width, height);
    }

    const buffer = new ArrayBuffer(width * height * 4);
    const view = new Uint8Array(buffer);
    let scanstart = flipY ? 0 : width * 4 * (height - 1);
    let x, y, i, channel, count, value;
    for (y = 0; y < height; ++y) {
      if (y) {
        readStream.readArray(rgbe);
      }

      if ((rgbe[2] << 8) + rgbe[3] !== width) {
        Debug.error('radiance has invalid scanline width');
        return null;
      }

      for (channel = 0; channel < 4; ++channel) {
        x = 0;
        while (x < width) {
          count = readStream.readU8();
          if (count > 128) {
            count -= 128;
            if (x + count > width) {
              Debug.error('radiance has invalid scanline data');
              return null;
            }
            value = readStream.readU8();
            for (i = 0; i < count; ++i) {
              view[scanstart + channel + 4 * x++] = value;
            }
          } else {
            if (count === 0 || x + count > width) {
              Debug.error('radiance has invalid scanline data');
              return null;
            }
            for (i = 0; i < count; ++i) {
              view[scanstart + channel + 4 * x++] = readStream.readU8();
            }
          }
        }
      }
      scanstart += width * 4 * (flipY ? 1 : -1);
    }
    return view;
  }
  _readPixelsFlat(readStream, width, height) {
    return readStream.remainingBytes === width * height * 4 ? new Uint8Array(readStream.arraybuffer, readStream.offset) : null;
  }
}

export { HdrParser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGRyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL3BhcnNlcnMvdGV4dHVyZS9oZHIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVhZFN0cmVhbSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvcmVhZC1zdHJlYW0uanMnO1xuaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuLi8uLi8uLi9jb3JlL2RlYnVnLmpzJztcblxuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL3RleHR1cmUuanMnO1xuaW1wb3J0IHtcbiAgICBURVhISU5UX0FTU0VULFxuICAgIEFERFJFU1NfUkVQRUFULCBBRERSRVNTX0NMQU1QX1RPX0VER0UsXG4gICAgRklMVEVSX05FQVJFU1QsXG4gICAgUElYRUxGT1JNQVRfUjhfRzhfQjhfQTgsXG4gICAgVEVYVFVSRVRZUEVfUkdCRVxufSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9jb25zdGFudHMuanMnO1xuXG5pbXBvcnQgeyBBc3NldCB9IGZyb20gJy4uLy4uLy4uL2ZyYW1ld29yay9hc3NldC9hc3NldC5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi9oYW5kbGVycy90ZXh0dXJlLmpzJykuVGV4dHVyZVBhcnNlcn0gVGV4dHVyZVBhcnNlciAqL1xuXG4vKipcbiAqIFRleHR1cmUgcGFyc2VyIGZvciBoZHIgZmlsZXMuXG4gKlxuICogQGltcGxlbWVudHMge1RleHR1cmVQYXJzZXJ9XG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIEhkclBhcnNlciB7XG4gICAgY29uc3RydWN0b3IocmVnaXN0cnkpIHtcbiAgICAgICAgdGhpcy5tYXhSZXRyaWVzID0gMDtcbiAgICB9XG5cbiAgICBsb2FkKHVybCwgY2FsbGJhY2ssIGFzc2V0KSB7XG4gICAgICAgIEFzc2V0LmZldGNoQXJyYXlCdWZmZXIodXJsLmxvYWQsIGNhbGxiYWNrLCBhc3NldCwgdGhpcy5tYXhSZXRyaWVzKTtcbiAgICB9XG5cbiAgICBvcGVuKHVybCwgZGF0YSwgZGV2aWNlKSB7XG4gICAgICAgIGNvbnN0IHRleHR1cmVEYXRhID0gdGhpcy5wYXJzZShkYXRhKTtcblxuICAgICAgICBpZiAoIXRleHR1cmVEYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRleHR1cmUgPSBuZXcgVGV4dHVyZShkZXZpY2UsIHtcbiAgICAgICAgICAgIG5hbWU6IHVybCxcbiAgICAgICAgICAgIC8vICNpZiBfUFJPRklMRVJcbiAgICAgICAgICAgIHByb2ZpbGVySGludDogVEVYSElOVF9BU1NFVCxcbiAgICAgICAgICAgIC8vICNlbmRpZlxuICAgICAgICAgICAgYWRkcmVzc1U6IEFERFJFU1NfUkVQRUFULFxuICAgICAgICAgICAgYWRkcmVzc1Y6IEFERFJFU1NfQ0xBTVBfVE9fRURHRSxcbiAgICAgICAgICAgIG1pbkZpbHRlcjogRklMVEVSX05FQVJFU1QsXG4gICAgICAgICAgICBtYWdGaWx0ZXI6IEZJTFRFUl9ORUFSRVNULFxuICAgICAgICAgICAgd2lkdGg6IHRleHR1cmVEYXRhLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiB0ZXh0dXJlRGF0YS5oZWlnaHQsXG4gICAgICAgICAgICBsZXZlbHM6IHRleHR1cmVEYXRhLmxldmVscyxcbiAgICAgICAgICAgIGZvcm1hdDogUElYRUxGT1JNQVRfUjhfRzhfQjhfQTgsXG4gICAgICAgICAgICB0eXBlOiBURVhUVVJFVFlQRV9SR0JFLFxuICAgICAgICAgICAgLy8gUkdCRSBjYW4ndCBiZSBmaWx0ZXJlZCwgc28gbWlwbWFwcyBhcmUgb3V0IG9mIHRoZSBxdWVzdGlvbiEgKHVubGVzcyB3ZSBnZW5lcmF0ZWQgdGhlbSBvdXJzZWx2ZXMpXG4gICAgICAgICAgICBtaXBtYXBzOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICB0ZXh0dXJlLnVwbG9hZCgpO1xuXG4gICAgICAgIHJldHVybiB0ZXh0dXJlO1xuICAgIH1cblxuICAgIC8vIGh0dHBzOi8vZmxveWQubGJsLmdvdi9yYWRpYW5jZS9yZWZlci9maWxlZm10cy5wZGYgd2l0aCBoZWxwIGZyb20gaHR0cDovL3d3dy5ncmFwaGljcy5jb3JuZWxsLmVkdS9+Ymp3L3JnYmUvcmdiZS5jXG4gICAgcGFyc2UoZGF0YSkge1xuICAgICAgICBjb25zdCByZWFkU3RyZWFtID0gbmV3IFJlYWRTdHJlYW0oZGF0YSk7XG5cbiAgICAgICAgLy8gcmVxdWlyZSBtYWdpY1xuICAgICAgICBjb25zdCBtYWdpYyA9IHJlYWRTdHJlYW0ucmVhZExpbmUoKTtcbiAgICAgICAgaWYgKCFtYWdpYy5zdGFydHNXaXRoKCcjP1JBRElBTkNFJykpIHtcbiAgICAgICAgICAgIERlYnVnLmVycm9yKCdyYWRpYW5jZSBoZWFkZXIgaGFzIGludmFsaWQgbWFnaWMnKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVhZCBoZWFkZXIgdmFyaWFibGVzXG4gICAgICAgIGNvbnN0IHZhcmlhYmxlcyA9IHsgfTtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSByZWFkU3RyZWFtLnJlYWRMaW5lKCk7XG4gICAgICAgICAgICBpZiAobGluZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBlbXB0eSBsaW5lIHNpZ25hbHMgZW5kIG9mIGhlYWRlclxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlc1twYXJ0c1swXV0gPSBwYXJ0c1sxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyB3ZSByZXF1aXJlIEZPUk1BVCB2YXJpYWJsZVxuICAgICAgICBpZiAoIXZhcmlhYmxlcy5oYXNPd25Qcm9wZXJ0eSgnRk9STUFUJykpIHtcbiAgICAgICAgICAgIERlYnVnLmVycm9yKCdyYWRpYW5jZSBoZWFkZXIgbWlzc2luZyBGT1JNQVQgdmFyaWFibGUnKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVhZCB0aGUgcmVzb2x1dGlvbiBzcGVjaWZpZXJcbiAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IHJlYWRTdHJlYW0ucmVhZExpbmUoKS5zcGxpdCgnICcpO1xuICAgICAgICBpZiAocmVzb2x1dGlvbi5sZW5ndGggIT09IDQpIHtcbiAgICAgICAgICAgIERlYnVnLmVycm9yKCdyYWRpYW5jZSBoZWFkZXIgaGFzIGludmFsaWQgcmVzb2x1dGlvbicpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBoZWlnaHQgPSBwYXJzZUludChyZXNvbHV0aW9uWzFdLCAxMCk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gcGFyc2VJbnQocmVzb2x1dGlvblszXSwgMTApO1xuICAgICAgICBjb25zdCBwaXhlbHMgPSB0aGlzLl9yZWFkUGl4ZWxzKHJlYWRTdHJlYW0sIHdpZHRoLCBoZWlnaHQsIHJlc29sdXRpb25bMF0gPT09ICctWScpO1xuXG4gICAgICAgIGlmICghcGl4ZWxzKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNyZWF0ZSB0ZXh0dXJlXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgIGxldmVsczogW3BpeGVsc11cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBfcmVhZFBpeGVscyhyZWFkU3RyZWFtLCB3aWR0aCwgaGVpZ2h0LCBmbGlwWSkge1xuICAgICAgICAvLyBvdXQgb2YgYm91bmRzXG4gICAgICAgIGlmICh3aWR0aCA8IDggfHwgd2lkdGggPiAweDdmZmYpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkUGl4ZWxzRmxhdChyZWFkU3RyZWFtLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJnYmUgPSBbMCwgMCwgMCwgMF07XG5cbiAgICAgICAgLy8gY2hlY2sgZmlyc3Qgc2NhbmxpbmUgd2lkdGggdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGZpbGUgaXMgUkxFXG4gICAgICAgIHJlYWRTdHJlYW0ucmVhZEFycmF5KHJnYmUpO1xuICAgICAgICBpZiAoKHJnYmVbMF0gIT09IDIgfHwgcmdiZVsxXSAhPT0gMiB8fCAocmdiZVsyXSAmIDB4ODApICE9PSAwKSkge1xuICAgICAgICAgICAgLy8gbm90IFJMRVxuICAgICAgICAgICAgcmVhZFN0cmVhbS5za2lwKC00KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkUGl4ZWxzRmxhdChyZWFkU3RyZWFtLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFsbG9jYXRlIHRleHR1cmUgYnVmZmVyXG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcih3aWR0aCAqIGhlaWdodCAqIDQpO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgbGV0IHNjYW5zdGFydCA9IGZsaXBZID8gMCA6IHdpZHRoICogNCAqIChoZWlnaHQgLSAxKTtcbiAgICAgICAgbGV0IHgsIHksIGksIGNoYW5uZWwsIGNvdW50LCB2YWx1ZTtcblxuICAgICAgICBmb3IgKHkgPSAwOyB5IDwgaGVpZ2h0OyArK3kpIHtcbiAgICAgICAgICAgIC8vIHJlYWQgc2NhbmxpbmUgd2lkdGggc3BlY2lmaWVyXG4gICAgICAgICAgICBpZiAoeSkge1xuICAgICAgICAgICAgICAgIHJlYWRTdHJlYW0ucmVhZEFycmF5KHJnYmUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzYW5pdHkgY2hlY2sgaXRcbiAgICAgICAgICAgIGlmICgocmdiZVsyXSA8PCA4KSArIHJnYmVbM10gIT09IHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgRGVidWcuZXJyb3IoJ3JhZGlhbmNlIGhhcyBpbnZhbGlkIHNjYW5saW5lIHdpZHRoJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGVhY2ggc2NhbmxpbmUgaXMgc3RvcmVkIGJ5IGNoYW5uZWxcbiAgICAgICAgICAgIGZvciAoY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCA0OyArK2NoYW5uZWwpIHtcbiAgICAgICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoeCA8IHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gcmVhZFN0cmVhbS5yZWFkVTgoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gMTI4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBydW4gb2YgdGhlIHNhbWUgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50IC09IDEyODtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4ICsgY291bnQgPiB3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlYnVnLmVycm9yKCdyYWRpYW5jZSBoYXMgaW52YWxpZCBzY2FubGluZSBkYXRhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHJlYWRTdHJlYW0ucmVhZFU4KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2NhbnN0YXJ0ICsgY2hhbm5lbCArIDQgKiB4KytdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub24tcnVuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPT09IDAgfHwgeCArIGNvdW50ID4gd2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5lcnJvcigncmFkaWFuY2UgaGFzIGludmFsaWQgc2NhbmxpbmUgZGF0YScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NjYW5zdGFydCArIGNoYW5uZWwgKyA0ICogeCsrXSA9IHJlYWRTdHJlYW0ucmVhZFU4KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNjYW5zdGFydCArPSB3aWR0aCAqIDQgKiAoZmxpcFkgPyAxIDogLTEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfVxuXG4gICAgX3JlYWRQaXhlbHNGbGF0KHJlYWRTdHJlYW0sIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIHJlYWRTdHJlYW0ucmVtYWluaW5nQnl0ZXMgPT09IHdpZHRoICogaGVpZ2h0ICogNCA/IG5ldyBVaW50OEFycmF5KHJlYWRTdHJlYW0uYXJyYXlidWZmZXIsIHJlYWRTdHJlYW0ub2Zmc2V0KSA6IG51bGw7XG4gICAgfVxufVxuXG5leHBvcnQgeyBIZHJQYXJzZXIgfTtcbiJdLCJuYW1lcyI6WyJIZHJQYXJzZXIiLCJjb25zdHJ1Y3RvciIsInJlZ2lzdHJ5IiwibWF4UmV0cmllcyIsImxvYWQiLCJ1cmwiLCJjYWxsYmFjayIsImFzc2V0IiwiQXNzZXQiLCJmZXRjaEFycmF5QnVmZmVyIiwib3BlbiIsImRhdGEiLCJkZXZpY2UiLCJ0ZXh0dXJlRGF0YSIsInBhcnNlIiwidGV4dHVyZSIsIlRleHR1cmUiLCJuYW1lIiwicHJvZmlsZXJIaW50IiwiVEVYSElOVF9BU1NFVCIsImFkZHJlc3NVIiwiQUREUkVTU19SRVBFQVQiLCJhZGRyZXNzViIsIkFERFJFU1NfQ0xBTVBfVE9fRURHRSIsIm1pbkZpbHRlciIsIkZJTFRFUl9ORUFSRVNUIiwibWFnRmlsdGVyIiwid2lkdGgiLCJoZWlnaHQiLCJsZXZlbHMiLCJmb3JtYXQiLCJQSVhFTEZPUk1BVF9SOF9HOF9COF9BOCIsInR5cGUiLCJURVhUVVJFVFlQRV9SR0JFIiwibWlwbWFwcyIsInVwbG9hZCIsInJlYWRTdHJlYW0iLCJSZWFkU3RyZWFtIiwibWFnaWMiLCJyZWFkTGluZSIsInN0YXJ0c1dpdGgiLCJEZWJ1ZyIsImVycm9yIiwidmFyaWFibGVzIiwibGluZSIsImxlbmd0aCIsInBhcnRzIiwic3BsaXQiLCJoYXNPd25Qcm9wZXJ0eSIsInJlc29sdXRpb24iLCJwYXJzZUludCIsInBpeGVscyIsIl9yZWFkUGl4ZWxzIiwiZmxpcFkiLCJfcmVhZFBpeGVsc0ZsYXQiLCJyZ2JlIiwicmVhZEFycmF5Iiwic2tpcCIsImJ1ZmZlciIsIkFycmF5QnVmZmVyIiwidmlldyIsIlVpbnQ4QXJyYXkiLCJzY2Fuc3RhcnQiLCJ4IiwieSIsImkiLCJjaGFubmVsIiwiY291bnQiLCJ2YWx1ZSIsInJlYWRVOCIsInJlbWFpbmluZ0J5dGVzIiwiYXJyYXlidWZmZXIiLCJvZmZzZXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7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
