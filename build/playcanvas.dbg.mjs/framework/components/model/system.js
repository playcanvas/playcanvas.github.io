/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { extend } from '../../../core/core.js';
import { Vec3 } from '../../../core/math/vec3.js';
import { BoundingBox } from '../../../core/shape/bounding-box.js';
import { getDefaultMaterial } from '../../../scene/materials/default-material.js';
import { Asset } from '../../asset/asset.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { ModelComponent } from './component.js';
import { ModelComponentData } from './data.js';

const _schema = ['enabled'];

class ModelComponentSystem extends ComponentSystem {
  constructor(app) {
    super(app);
    this.id = 'model';
    this.ComponentType = ModelComponent;
    this.DataType = ModelComponentData;
    this.schema = _schema;
    this.defaultMaterial = getDefaultMaterial(app.graphicsDevice);
    this.on('beforeremove', this.onRemove, this);
  }
  initializeComponentData(component, _data, properties) {
    properties = ['material', 'materialAsset', 'asset', 'castShadows', 'receiveShadows', 'castShadowsLightmap', 'lightmapped', 'lightmapSizeMultiplier', 'type', 'mapping', 'layers', 'isStatic', 'batchGroupId'];
    if (_data.batchGroupId === null || _data.batchGroupId === undefined) {
      _data.batchGroupId = -1;
    }

    if (_data.layers && _data.layers.length) {
      _data.layers = _data.layers.slice(0);
    }
    for (let i = 0; i < properties.length; i++) {
      if (_data.hasOwnProperty(properties[i])) {
        component[properties[i]] = _data[properties[i]];
      }
    }
    if (_data.aabbCenter && _data.aabbHalfExtents) {
      component.customAabb = new BoundingBox(new Vec3(_data.aabbCenter), new Vec3(_data.aabbHalfExtents));
    }
    super.initializeComponentData(component, _data, ['enabled']);
  }
  cloneComponent(entity, clone) {
    const data = {
      type: entity.model.type,
      asset: entity.model.asset,
      castShadows: entity.model.castShadows,
      receiveShadows: entity.model.receiveShadows,
      castShadowsLightmap: entity.model.castShadowsLightmap,
      lightmapped: entity.model.lightmapped,
      lightmapSizeMultiplier: entity.model.lightmapSizeMultiplier,
      isStatic: entity.model.isStatic,
      enabled: entity.model.enabled,
      layers: entity.model.layers,
      batchGroupId: entity.model.batchGroupId,
      mapping: extend({}, entity.model.mapping)
    };

    let materialAsset = entity.model.materialAsset;
    if (!(materialAsset instanceof Asset) && materialAsset != null) {
      materialAsset = this.app.assets.get(materialAsset);
    }
    const material = entity.model.material;
    if (!material || material === this.defaultMaterial || !materialAsset || material === materialAsset.resource) {
      data.materialAsset = materialAsset;
    }
    const component = this.addComponent(clone, data);

    if (entity.model.model && entity.model.type === 'asset' && !entity.model.asset) {
      component.model = entity.model.model.clone();
      component._clonedModel = true;
    }
    if (!data.materialAsset) component.material = material;

    if (entity.model.model) {
      const meshInstances = entity.model.model.meshInstances;
      const meshInstancesClone = component.model.meshInstances;
      for (let i = 0; i < meshInstances.length; i++) {
        meshInstancesClone[i].mask = meshInstances[i].mask;
        meshInstancesClone[i].material = meshInstances[i].material;
        meshInstancesClone[i].layer = meshInstances[i].layer;
        meshInstancesClone[i].receiveShadow = meshInstances[i].receiveShadow;
      }
    }
    if (entity.model.customAabb) {
      component.customAabb = entity.model.customAabb.clone();
    }
    return component;
  }
  onRemove(entity, component) {
    component.onRemove();
  }
}
Component._buildAccessors(ModelComponent.prototype, _schema);

export { ModelComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvbW9kZWwvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4uLy4uLy4uL2NvcmUvY29yZS5qcyc7XG5cbmltcG9ydCB7IFZlYzMgfSBmcm9tICcuLi8uLi8uLi9jb3JlL21hdGgvdmVjMy5qcyc7XG5cbmltcG9ydCB7IEJvdW5kaW5nQm94IH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zaGFwZS9ib3VuZGluZy1ib3guanMnO1xuXG5pbXBvcnQgeyBnZXREZWZhdWx0TWF0ZXJpYWwgfSBmcm9tICcuLi8uLi8uLi9zY2VuZS9tYXRlcmlhbHMvZGVmYXVsdC1tYXRlcmlhbC5qcyc7XG5cbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vLi4vYXNzZXQvYXNzZXQuanMnO1xuXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgQ29tcG9uZW50U3lzdGVtIH0gZnJvbSAnLi4vc3lzdGVtLmpzJztcblxuaW1wb3J0IHsgTW9kZWxDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBNb2RlbENvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBBcHBCYXNlICovXG5cbmNvbnN0IF9zY2hlbWEgPSBbJ2VuYWJsZWQnXTtcblxuLyoqXG4gKiBBbGxvd3MgYW4gRW50aXR5IHRvIHJlbmRlciBhIG1vZGVsIG9yIGEgcHJpbWl0aXZlIHNoYXBlIGxpa2UgYSBib3gsIGNhcHN1bGUsIHNwaGVyZSwgY3lsaW5kZXIsXG4gKiBjb25lIGV0Yy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50U3lzdGVtXG4gKi9cbmNsYXNzIE1vZGVsQ29tcG9uZW50U3lzdGVtIGV4dGVuZHMgQ29tcG9uZW50U3lzdGVtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgTW9kZWxDb21wb25lbnRTeXN0ZW0gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FwcEJhc2V9IGFwcCAtIFRoZSBBcHBsaWNhdGlvbi5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG5cbiAgICAgICAgdGhpcy5pZCA9ICdtb2RlbCc7XG5cbiAgICAgICAgdGhpcy5Db21wb25lbnRUeXBlID0gTW9kZWxDb21wb25lbnQ7XG4gICAgICAgIHRoaXMuRGF0YVR5cGUgPSBNb2RlbENvbXBvbmVudERhdGE7XG5cbiAgICAgICAgdGhpcy5zY2hlbWEgPSBfc2NoZW1hO1xuICAgICAgICB0aGlzLmRlZmF1bHRNYXRlcmlhbCA9IGdldERlZmF1bHRNYXRlcmlhbChhcHAuZ3JhcGhpY3NEZXZpY2UpO1xuXG4gICAgICAgIHRoaXMub24oJ2JlZm9yZXJlbW92ZScsIHRoaXMub25SZW1vdmUsIHRoaXMpO1xuICAgIH1cblxuICAgIGluaXRpYWxpemVDb21wb25lbnREYXRhKGNvbXBvbmVudCwgX2RhdGEsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgLy8gb3JkZXIgbWF0dGVycyBoZXJlXG4gICAgICAgIHByb3BlcnRpZXMgPSBbXG4gICAgICAgICAgICAnbWF0ZXJpYWwnLFxuICAgICAgICAgICAgJ21hdGVyaWFsQXNzZXQnLFxuICAgICAgICAgICAgJ2Fzc2V0JyxcbiAgICAgICAgICAgICdjYXN0U2hhZG93cycsXG4gICAgICAgICAgICAncmVjZWl2ZVNoYWRvd3MnLFxuICAgICAgICAgICAgJ2Nhc3RTaGFkb3dzTGlnaHRtYXAnLFxuICAgICAgICAgICAgJ2xpZ2h0bWFwcGVkJyxcbiAgICAgICAgICAgICdsaWdodG1hcFNpemVNdWx0aXBsaWVyJyxcbiAgICAgICAgICAgICd0eXBlJyxcbiAgICAgICAgICAgICdtYXBwaW5nJyxcbiAgICAgICAgICAgICdsYXllcnMnLFxuICAgICAgICAgICAgJ2lzU3RhdGljJyxcbiAgICAgICAgICAgICdiYXRjaEdyb3VwSWQnXG4gICAgICAgIF07XG5cbiAgICAgICAgaWYgKF9kYXRhLmJhdGNoR3JvdXBJZCA9PT0gbnVsbCB8fCBfZGF0YS5iYXRjaEdyb3VwSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX2RhdGEuYmF0Y2hHcm91cElkID0gLTE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkdXBsaWNhdGUgbGF5ZXIgbGlzdFxuICAgICAgICBpZiAoX2RhdGEubGF5ZXJzICYmIF9kYXRhLmxheWVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIF9kYXRhLmxheWVycyA9IF9kYXRhLmxheWVycy5zbGljZSgwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKF9kYXRhLmhhc093blByb3BlcnR5KHByb3BlcnRpZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50W3Byb3BlcnRpZXNbaV1dID0gX2RhdGFbcHJvcGVydGllc1tpXV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX2RhdGEuYWFiYkNlbnRlciAmJiBfZGF0YS5hYWJiSGFsZkV4dGVudHMpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5jdXN0b21BYWJiID0gbmV3IEJvdW5kaW5nQm94KG5ldyBWZWMzKF9kYXRhLmFhYmJDZW50ZXIpLCBuZXcgVmVjMyhfZGF0YS5hYWJiSGFsZkV4dGVudHMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyLmluaXRpYWxpemVDb21wb25lbnREYXRhKGNvbXBvbmVudCwgX2RhdGEsIFsnZW5hYmxlZCddKTtcbiAgICB9XG5cbiAgICBjbG9uZUNvbXBvbmVudChlbnRpdHksIGNsb25lKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICB0eXBlOiBlbnRpdHkubW9kZWwudHlwZSxcbiAgICAgICAgICAgIGFzc2V0OiBlbnRpdHkubW9kZWwuYXNzZXQsXG4gICAgICAgICAgICBjYXN0U2hhZG93czogZW50aXR5Lm1vZGVsLmNhc3RTaGFkb3dzLFxuICAgICAgICAgICAgcmVjZWl2ZVNoYWRvd3M6IGVudGl0eS5tb2RlbC5yZWNlaXZlU2hhZG93cyxcbiAgICAgICAgICAgIGNhc3RTaGFkb3dzTGlnaHRtYXA6IGVudGl0eS5tb2RlbC5jYXN0U2hhZG93c0xpZ2h0bWFwLFxuICAgICAgICAgICAgbGlnaHRtYXBwZWQ6IGVudGl0eS5tb2RlbC5saWdodG1hcHBlZCxcbiAgICAgICAgICAgIGxpZ2h0bWFwU2l6ZU11bHRpcGxpZXI6IGVudGl0eS5tb2RlbC5saWdodG1hcFNpemVNdWx0aXBsaWVyLFxuICAgICAgICAgICAgaXNTdGF0aWM6IGVudGl0eS5tb2RlbC5pc1N0YXRpYyxcbiAgICAgICAgICAgIGVuYWJsZWQ6IGVudGl0eS5tb2RlbC5lbmFibGVkLFxuICAgICAgICAgICAgbGF5ZXJzOiBlbnRpdHkubW9kZWwubGF5ZXJzLFxuICAgICAgICAgICAgYmF0Y2hHcm91cElkOiBlbnRpdHkubW9kZWwuYmF0Y2hHcm91cElkLFxuICAgICAgICAgICAgbWFwcGluZzogZXh0ZW5kKHt9LCBlbnRpdHkubW9kZWwubWFwcGluZylcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBpZiBvcmlnaW5hbCBoYXMgYSBkaWZmZXJlbnQgbWF0ZXJpYWxcbiAgICAgICAgLy8gdGhhbiB0aGUgYXNzaWduZWQgbWF0ZXJpYWxBc3NldCB0aGVuIG1ha2Ugc3VyZSB3ZVxuICAgICAgICAvLyBjbG9uZSB0aGF0IG9uZSBpbnN0ZWFkIG9mIHRoZSBtYXRlcmlhbEFzc2V0IG9uZVxuICAgICAgICBsZXQgbWF0ZXJpYWxBc3NldCA9IGVudGl0eS5tb2RlbC5tYXRlcmlhbEFzc2V0O1xuICAgICAgICBpZiAoIShtYXRlcmlhbEFzc2V0IGluc3RhbmNlb2YgQXNzZXQpICYmIG1hdGVyaWFsQXNzZXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgbWF0ZXJpYWxBc3NldCA9IHRoaXMuYXBwLmFzc2V0cy5nZXQobWF0ZXJpYWxBc3NldCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtYXRlcmlhbCA9IGVudGl0eS5tb2RlbC5tYXRlcmlhbDtcbiAgICAgICAgaWYgKCFtYXRlcmlhbCB8fFxuICAgICAgICAgICAgbWF0ZXJpYWwgPT09IHRoaXMuZGVmYXVsdE1hdGVyaWFsIHx8XG4gICAgICAgICAgICAhbWF0ZXJpYWxBc3NldCB8fFxuICAgICAgICAgICAgbWF0ZXJpYWwgPT09IG1hdGVyaWFsQXNzZXQucmVzb3VyY2UpIHtcblxuICAgICAgICAgICAgZGF0YS5tYXRlcmlhbEFzc2V0ID0gbWF0ZXJpYWxBc3NldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRoaXMuYWRkQ29tcG9uZW50KGNsb25lLCBkYXRhKTtcblxuICAgICAgICAvLyBjbG9uZSB0aGUgb3JpZ2luYWwgbW9kZWwgaWYgdGhlIG9yaWdpbmFsIG1vZGVsIGNvbXBvbmVudCBpcyBvZiB0eXBlIGFzc2V0IGJ1dFxuICAgICAgICAvLyBoYXMgbm8gc3BlY2lmaWVkIGFzc2V0XG4gICAgICAgIGlmIChlbnRpdHkubW9kZWwubW9kZWwgJiYgZW50aXR5Lm1vZGVsLnR5cGUgPT09ICdhc3NldCcgJiYgIWVudGl0eS5tb2RlbC5hc3NldCkge1xuICAgICAgICAgICAgY29tcG9uZW50Lm1vZGVsID0gZW50aXR5Lm1vZGVsLm1vZGVsLmNsb25lKCk7XG4gICAgICAgICAgICBjb21wb25lbnQuX2Nsb25lZE1vZGVsID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZGF0YS5tYXRlcmlhbEFzc2V0KVxuICAgICAgICAgICAgY29tcG9uZW50Lm1hdGVyaWFsID0gbWF0ZXJpYWw7XG5cbiAgICAgICAgLy8gVE9ETzogd2Ugc2hvdWxkIGNvcHkgYWxsIHJlbGV2YW50IG1lc2ggaW5zdGFuY2UgcHJvcGVydGllcyBoZXJlXG4gICAgICAgIGlmIChlbnRpdHkubW9kZWwubW9kZWwpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc2hJbnN0YW5jZXMgPSBlbnRpdHkubW9kZWwubW9kZWwubWVzaEluc3RhbmNlcztcbiAgICAgICAgICAgIGNvbnN0IG1lc2hJbnN0YW5jZXNDbG9uZSA9IGNvbXBvbmVudC5tb2RlbC5tZXNoSW5zdGFuY2VzO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNoSW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlc0Nsb25lW2ldLm1hc2sgPSBtZXNoSW5zdGFuY2VzW2ldLm1hc2s7XG4gICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlc0Nsb25lW2ldLm1hdGVyaWFsID0gbWVzaEluc3RhbmNlc1tpXS5tYXRlcmlhbDtcbiAgICAgICAgICAgICAgICBtZXNoSW5zdGFuY2VzQ2xvbmVbaV0ubGF5ZXIgPSBtZXNoSW5zdGFuY2VzW2ldLmxheWVyO1xuICAgICAgICAgICAgICAgIG1lc2hJbnN0YW5jZXNDbG9uZVtpXS5yZWNlaXZlU2hhZG93ID0gbWVzaEluc3RhbmNlc1tpXS5yZWNlaXZlU2hhZG93O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVudGl0eS5tb2RlbC5jdXN0b21BYWJiKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuY3VzdG9tQWFiYiA9IGVudGl0eS5tb2RlbC5jdXN0b21BYWJiLmNsb25lKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgIH1cblxuICAgIG9uUmVtb3ZlKGVudGl0eSwgY29tcG9uZW50KSB7XG4gICAgICAgIGNvbXBvbmVudC5vblJlbW92ZSgpO1xuICAgIH1cbn1cblxuQ29tcG9uZW50Ll9idWlsZEFjY2Vzc29ycyhNb2RlbENvbXBvbmVudC5wcm90b3R5cGUsIF9zY2hlbWEpO1xuXG5leHBvcnQgeyBNb2RlbENvbXBvbmVudFN5c3RlbSB9O1xuIl0sIm5hbWVzIjpbIl9zY2hlbWEiLCJNb2RlbENvbXBvbmVudFN5c3RlbSIsIkNvbXBvbmVudFN5c3RlbSIsImNvbnN0cnVjdG9yIiwiYXBwIiwiaWQiLCJDb21wb25lbnRUeXBlIiwiTW9kZWxDb21wb25lbnQiLCJEYXRhVHlwZSIsIk1vZGVsQ29tcG9uZW50RGF0YSIsInNjaGVtYSIsImRlZmF1bHRNYXRlcmlhbCIsImdldERlZmF1bHRNYXRlcmlhbCIsImdyYXBoaWNzRGV2aWNlIiwib24iLCJvblJlbW92ZSIsImluaXRpYWxpemVDb21wb25lbnREYXRhIiwiY29tcG9uZW50IiwiX2RhdGEiLCJwcm9wZXJ0aWVzIiwiYmF0Y2hHcm91cElkIiwidW5kZWZpbmVkIiwibGF5ZXJzIiwibGVuZ3RoIiwic2xpY2UiLCJpIiwiaGFzT3duUHJvcGVydHkiLCJhYWJiQ2VudGVyIiwiYWFiYkhhbGZFeHRlbnRzIiwiY3VzdG9tQWFiYiIsIkJvdW5kaW5nQm94IiwiVmVjMyIsImNsb25lQ29tcG9uZW50IiwiZW50aXR5IiwiY2xvbmUiLCJkYXRhIiwidHlwZSIsIm1vZGVsIiwiYXNzZXQiLCJjYXN0U2hhZG93cyIsInJlY2VpdmVTaGFkb3dzIiwiY2FzdFNoYWRvd3NMaWdodG1hcCIsImxpZ2h0bWFwcGVkIiwibGlnaHRtYXBTaXplTXVsdGlwbGllciIsImlzU3RhdGljIiwiZW5hYmxlZCIsIm1hcHBpbmciLCJleHRlbmQiLCJtYXRlcmlhbEFzc2V0IiwiQXNzZXQiLCJhc3NldHMiLCJnZXQiLCJtYXRlcmlhbCIsInJlc291cmNlIiwiYWRkQ29tcG9uZW50IiwiX2Nsb25lZE1vZGVsIiwibWVzaEluc3RhbmNlcyIsIm1lc2hJbnN0YW5jZXNDbG9uZSIsIm1hc2siLCJsYXllciIsInJlY2VpdmVTaGFkb3ciLCJDb21wb25lbnQiLCJfYnVpbGRBY2Nlc3NvcnMiLCJwcm90b3R5cGUi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
