/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { path } from '../../core/path.js';
import { string } from '../../core/string.js';
import { http } from '../../platform/net/http.js';
import { Font } from '../font/font.js';

function upgradeDataSchema(data) {
  if (data.version < 3) {
    if (data.version < 2) {
      data.info.maps = data.info.maps || [{
        width: data.info.width,
        height: data.info.height
      }];
    }
    data.chars = Object.keys(data.chars || {}).reduce(function (newChars, key) {
      const existing = data.chars[key];
      const newKey = existing.letter !== undefined ? existing.letter : string.fromCodePoint(key);
      if (data.version < 2) {
        existing.map = existing.map || 0;
      }
      newChars[newKey] = existing;
      return newChars;
    }, {});
    data.version = 3;
  }
  return data;
}

class FontHandler {

  constructor(app) {
    this.handlerType = "font";
    this._loader = app.loader;
    this.maxRetries = 0;
  }
  load(url, callback, asset) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }
    const self = this;
    if (path.getExtension(url.original) === '.json') {
      http.get(url.load, {
        retry: this.maxRetries > 0,
        maxRetries: this.maxRetries
      }, function (err, response) {
        if (!err) {
          const data = upgradeDataSchema(response);
          self._loadTextures(url.load.replace('.json', '.png'), data, function (err, textures) {
            if (err) return callback(err);
            callback(null, {
              data: data,
              textures: textures
            });
          });
        } else {
          callback(`Error loading font resource: ${url.original} [${err}]`);
        }
      });
    } else {
      if (asset && asset.data) {
        asset.data = upgradeDataSchema(asset.data);
      }
      this._loadTextures(url.load, asset && asset.data, callback);
    }
  }
  _loadTextures(url, data, callback) {
    const numTextures = data.info.maps.length;
    let numLoaded = 0;
    let error = null;
    const textures = new Array(numTextures);
    const loader = this._loader;
    const loadTexture = function loadTexture(index) {
      const onLoaded = function onLoaded(err, texture) {
        if (error) return;
        if (err) {
          error = err;
          return callback(err);
        }
        texture.upload();
        textures[index] = texture;
        numLoaded++;
        if (numLoaded === numTextures) {
          callback(null, textures);
        }
      };
      if (index === 0) {
        loader.load(url, 'texture', onLoaded);
      } else {
        loader.load(url.replace('.png', index + '.png'), 'texture', onLoaded);
      }
    };
    for (let i = 0; i < numTextures; i++) loadTexture(i);
  }
  open(url, data, asset) {
    let font;
    if (data.textures) {
      font = new Font(data.textures, data.data);
    } else {
      font = new Font(data, null);
    }
    return font;
  }
  patch(asset, assets) {
    const font = asset.resource;
    if (!font.data && asset.data) {
      font.data = asset.data;
    } else if (!asset.data && font.data) {
      asset.data = font.data;
    }
    if (asset.data) {
      asset.data = upgradeDataSchema(asset.data);
    }
  }
}

export { FontHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9udC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2ZyYW1ld29yay9oYW5kbGVycy9mb250LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhdGggfSBmcm9tICcuLi8uLi9jb3JlL3BhdGguanMnO1xuaW1wb3J0IHsgc3RyaW5nIH0gZnJvbSAnLi4vLi4vY29yZS9zdHJpbmcuanMnO1xuXG5pbXBvcnQgeyBodHRwIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vbmV0L2h0dHAuanMnO1xuXG5pbXBvcnQgeyBGb250IH0gZnJvbSAnLi4vZm9udC9mb250LmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vaGFuZGxlci5qcycpLlJlc291cmNlSGFuZGxlcn0gUmVzb3VyY2VIYW5kbGVyICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vZnJhbWV3b3JrL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gQXBwQmFzZSAqL1xuXG5mdW5jdGlvbiB1cGdyYWRlRGF0YVNjaGVtYShkYXRhKSB7XG4gICAgLy8gY29udmVydCB2MSBhbmQgdjIgdG8gdjMgZm9udCBkYXRhIHNjaGVtYVxuICAgIGlmIChkYXRhLnZlcnNpb24gPCAzKSB7XG4gICAgICAgIGlmIChkYXRhLnZlcnNpb24gPCAyKSB7XG4gICAgICAgICAgICBkYXRhLmluZm8ubWFwcyA9IGRhdGEuaW5mby5tYXBzIHx8IFt7XG4gICAgICAgICAgICAgICAgd2lkdGg6IGRhdGEuaW5mby53aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGRhdGEuaW5mby5oZWlnaHRcbiAgICAgICAgICAgIH1dO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEuY2hhcnMgPSBPYmplY3Qua2V5cyhkYXRhLmNoYXJzIHx8IHt9KS5yZWR1Y2UoZnVuY3Rpb24gKG5ld0NoYXJzLCBrZXkpIHtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gZGF0YS5jaGFyc1trZXldO1xuICAgICAgICAgICAgLy8ga2V5IGJ5IGxldHRlciBpbnN0ZWFkIG9mIGNoYXIgY29kZVxuICAgICAgICAgICAgY29uc3QgbmV3S2V5ID0gZXhpc3RpbmcubGV0dGVyICE9PSB1bmRlZmluZWQgPyBleGlzdGluZy5sZXR0ZXIgOiBzdHJpbmcuZnJvbUNvZGVQb2ludChrZXkpO1xuICAgICAgICAgICAgaWYgKGRhdGEudmVyc2lvbiA8IDIpIHtcbiAgICAgICAgICAgICAgICBleGlzdGluZy5tYXAgPSBleGlzdGluZy5tYXAgfHwgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0NoYXJzW25ld0tleV0gPSBleGlzdGluZztcbiAgICAgICAgICAgIHJldHVybiBuZXdDaGFycztcbiAgICAgICAgfSwge30pO1xuICAgICAgICBkYXRhLnZlcnNpb24gPSAzO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cblxuLyoqXG4gKiBSZXNvdXJjZSBoYW5kbGVyIHVzZWQgZm9yIGxvYWRpbmcge0BsaW5rIEZvbnR9IHJlc291cmNlcy5cbiAqXG4gKiBAaW1wbGVtZW50cyB7UmVzb3VyY2VIYW5kbGVyfVxuICovXG5jbGFzcyBGb250SGFuZGxlciB7XG4gICAgLyoqXG4gICAgICogVHlwZSBvZiB0aGUgcmVzb3VyY2UgdGhlIGhhbmRsZXIgaGFuZGxlcy5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgaGFuZGxlclR5cGUgPSBcImZvbnRcIjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBGb250SGFuZGxlciBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXBwQmFzZX0gYXBwIC0gVGhlIHJ1bm5pbmcge0BsaW5rIEFwcEJhc2V9LlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5fbG9hZGVyID0gYXBwLmxvYWRlcjtcbiAgICAgICAgdGhpcy5tYXhSZXRyaWVzID0gMDtcbiAgICB9XG5cbiAgICBsb2FkKHVybCwgY2FsbGJhY2ssIGFzc2V0KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdXJsID0ge1xuICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmIChwYXRoLmdldEV4dGVuc2lvbih1cmwub3JpZ2luYWwpID09PSAnLmpzb24nKSB7XG4gICAgICAgICAgICAvLyBsb2FkIGpzb24gZGF0YSB0aGVuIGxvYWQgdGV4dHVyZSBvZiBzYW1lIG5hbWVcbiAgICAgICAgICAgIGh0dHAuZ2V0KHVybC5sb2FkLCB7XG4gICAgICAgICAgICAgICAgcmV0cnk6IHRoaXMubWF4UmV0cmllcyA+IDAsXG4gICAgICAgICAgICAgICAgbWF4UmV0cmllczogdGhpcy5tYXhSZXRyaWVzXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhc3NldCBkYXRhXG4gICAgICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHVwZ3JhZGVEYXRhU2NoZW1hKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fbG9hZFRleHR1cmVzKHVybC5sb2FkLnJlcGxhY2UoJy5qc29uJywgJy5wbmcnKSwgZGF0YSwgZnVuY3Rpb24gKGVyciwgdGV4dHVyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiBjYWxsYmFjayhlcnIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlczogdGV4dHVyZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhgRXJyb3IgbG9hZGluZyBmb250IHJlc291cmNlOiAke3VybC5vcmlnaW5hbH0gWyR7ZXJyfV1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gdXBncmFkZSBhc3NldCBkYXRhXG4gICAgICAgICAgICBpZiAoYXNzZXQgJiYgYXNzZXQuZGF0YSkge1xuICAgICAgICAgICAgICAgIGFzc2V0LmRhdGEgPSB1cGdyYWRlRGF0YVNjaGVtYShhc3NldC5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2xvYWRUZXh0dXJlcyh1cmwubG9hZCwgYXNzZXQgJiYgYXNzZXQuZGF0YSwgY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2xvYWRUZXh0dXJlcyh1cmwsIGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IG51bVRleHR1cmVzID0gZGF0YS5pbmZvLm1hcHMubGVuZ3RoO1xuICAgICAgICBsZXQgbnVtTG9hZGVkID0gMDtcbiAgICAgICAgbGV0IGVycm9yID0gbnVsbDtcblxuICAgICAgICBjb25zdCB0ZXh0dXJlcyA9IG5ldyBBcnJheShudW1UZXh0dXJlcyk7XG4gICAgICAgIGNvbnN0IGxvYWRlciA9IHRoaXMuX2xvYWRlcjtcblxuICAgICAgICBjb25zdCBsb2FkVGV4dHVyZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgY29uc3Qgb25Mb2FkZWQgPSBmdW5jdGlvbiAoZXJyLCB0ZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0ZXh0dXJlLnVwbG9hZCgpO1xuICAgICAgICAgICAgICAgIHRleHR1cmVzW2luZGV4XSA9IHRleHR1cmU7XG4gICAgICAgICAgICAgICAgbnVtTG9hZGVkKys7XG4gICAgICAgICAgICAgICAgaWYgKG51bUxvYWRlZCA9PT0gbnVtVGV4dHVyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgdGV4dHVyZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGxvYWRlci5sb2FkKHVybCwgJ3RleHR1cmUnLCBvbkxvYWRlZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvYWRlci5sb2FkKHVybC5yZXBsYWNlKCcucG5nJywgaW5kZXggKyAnLnBuZycpLCAndGV4dHVyZScsIG9uTG9hZGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVRleHR1cmVzOyBpKyspXG4gICAgICAgICAgICBsb2FkVGV4dHVyZShpKTtcbiAgICB9XG5cbiAgICBvcGVuKHVybCwgZGF0YSwgYXNzZXQpIHtcbiAgICAgICAgbGV0IGZvbnQ7XG4gICAgICAgIGlmIChkYXRhLnRleHR1cmVzKSB7XG4gICAgICAgICAgICAvLyBib3RoIGRhdGEgYW5kIHRleHR1cmVzIGV4aXN0XG4gICAgICAgICAgICBmb250ID0gbmV3IEZvbnQoZGF0YS50ZXh0dXJlcywgZGF0YS5kYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG9ubHkgdGV4dHVyZXNcbiAgICAgICAgICAgIGZvbnQgPSBuZXcgRm9udChkYXRhLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm9udDtcbiAgICB9XG5cbiAgICBwYXRjaChhc3NldCwgYXNzZXRzKSB7XG4gICAgICAgIC8vIGlmIG5vdCBhbHJlYWR5IHNldCwgZ2V0IGZvbnQgZGF0YSBibG9jayBmcm9tIGFzc2V0XG4gICAgICAgIC8vIGFuZCBhc3NpZ24gdG8gZm9udCByZXNvdXJjZVxuICAgICAgICBjb25zdCBmb250ID0gYXNzZXQucmVzb3VyY2U7XG4gICAgICAgIGlmICghZm9udC5kYXRhICYmIGFzc2V0LmRhdGEpIHtcbiAgICAgICAgICAgIC8vIGZvbnQgZGF0YSBwcmVzZW50IGluIGFzc2V0IGJ1dCBub3QgaW4gZm9udFxuICAgICAgICAgICAgZm9udC5kYXRhID0gYXNzZXQuZGF0YTtcbiAgICAgICAgfSBlbHNlIGlmICghYXNzZXQuZGF0YSAmJiBmb250LmRhdGEpIHtcbiAgICAgICAgICAgIC8vIGZvbnQgZGF0YSBwcmVzZW50IGluIGZvbnQgYnV0IG5vdCBpbiBhc3NldFxuICAgICAgICAgICAgYXNzZXQuZGF0YSA9IGZvbnQuZGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhc3NldC5kYXRhKSB7XG4gICAgICAgICAgICBhc3NldC5kYXRhID0gdXBncmFkZURhdGFTY2hlbWEoYXNzZXQuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCB7IEZvbnRIYW5kbGVyIH07XG4iXSwibmFtZXMiOlsidXBncmFkZURhdGFTY2hlbWEiLCJkYXRhIiwidmVyc2lvbiIsImluZm8iLCJtYXBzIiwid2lkdGgiLCJoZWlnaHQiLCJjaGFycyIsIk9iamVjdCIsImtleXMiLCJyZWR1Y2UiLCJuZXdDaGFycyIsImtleSIsImV4aXN0aW5nIiwibmV3S2V5IiwibGV0dGVyIiwidW5kZWZpbmVkIiwic3RyaW5nIiwiZnJvbUNvZGVQb2ludCIsIm1hcCIsIkZvbnRIYW5kbGVyIiwiY29uc3RydWN0b3IiLCJhcHAiLCJoYW5kbGVyVHlwZSIsIl9sb2FkZXIiLCJsb2FkZXIiLCJtYXhSZXRyaWVzIiwibG9hZCIsInVybCIsImNhbGxiYWNrIiwiYXNzZXQiLCJvcmlnaW5hbCIsInNlbGYiLCJwYXRoIiwiZ2V0RXh0ZW5zaW9uIiwiaHR0cCIsImdldCIsInJldHJ5IiwiZXJyIiwicmVzcG9uc2UiLCJfbG9hZFRleHR1cmVzIiwicmVwbGFjZSIsInRleHR1cmVzIiwibnVtVGV4dHVyZXMiLCJsZW5ndGgiLCJudW1Mb2FkZWQiLCJlcnJvciIsIkFycmF5IiwibG9hZFRleHR1cmUiLCJpbmRleCIsIm9uTG9hZGVkIiwidGV4dHVyZSIsInVwbG9hZCIsImkiLCJvcGVuIiwiZm9udCIsIkZvbnQiLCJwYXRjaCIsImFzc2V0cyIsInJlc291cmNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBVUEsU0FBU0EsaUJBQWlCLENBQUNDLElBQUksRUFBRTtBQUU3QixFQUFBLElBQUlBLElBQUksQ0FBQ0MsT0FBTyxHQUFHLENBQUMsRUFBRTtBQUNsQixJQUFBLElBQUlELElBQUksQ0FBQ0MsT0FBTyxHQUFHLENBQUMsRUFBRTtNQUNsQkQsSUFBSSxDQUFDRSxJQUFJLENBQUNDLElBQUksR0FBR0gsSUFBSSxDQUFDRSxJQUFJLENBQUNDLElBQUksSUFBSSxDQUFDO0FBQ2hDQyxRQUFBQSxLQUFLLEVBQUVKLElBQUksQ0FBQ0UsSUFBSSxDQUFDRSxLQUFLO0FBQ3RCQyxRQUFBQSxNQUFNLEVBQUVMLElBQUksQ0FBQ0UsSUFBSSxDQUFDRyxNQUFBQTtBQUN0QixPQUFDLENBQUMsQ0FBQTtBQUNOLEtBQUE7SUFDQUwsSUFBSSxDQUFDTSxLQUFLLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDUixJQUFJLENBQUNNLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQ0csTUFBTSxDQUFDLFVBQVVDLFFBQVEsRUFBRUMsR0FBRyxFQUFFO0FBQ3ZFLE1BQUEsTUFBTUMsUUFBUSxHQUFHWixJQUFJLENBQUNNLEtBQUssQ0FBQ0ssR0FB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
