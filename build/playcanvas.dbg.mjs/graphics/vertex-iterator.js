/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../core/debug.js';
import { typedArrayTypes } from './constants.js';

function set1(a) {
  this.array[this.index] = a;
}

function set2(a, b) {
  this.array[this.index] = a;
  this.array[this.index + 1] = b;
}

function set3(a, b, c) {
  this.array[this.index] = a;
  this.array[this.index + 1] = b;
  this.array[this.index + 2] = c;
}

function set4(a, b, c, d) {
  this.array[this.index] = a;
  this.array[this.index + 1] = b;
  this.array[this.index + 2] = c;
  this.array[this.index + 3] = d;
}

function arraySet1(index, inputArray, inputIndex) {
  this.array[index] = inputArray[inputIndex];
}

function arraySet2(index, inputArray, inputIndex) {
  this.array[index] = inputArray[inputIndex];
  this.array[index + 1] = inputArray[inputIndex + 1];
}

function arraySet3(index, inputArray, inputIndex) {
  this.array[index] = inputArray[inputIndex];
  this.array[index + 1] = inputArray[inputIndex + 1];
  this.array[index + 2] = inputArray[inputIndex + 2];
}

function arraySet4(index, inputArray, inputIndex) {
  this.array[index] = inputArray[inputIndex];
  this.array[index + 1] = inputArray[inputIndex + 1];
  this.array[index + 2] = inputArray[inputIndex + 2];
  this.array[index + 3] = inputArray[inputIndex + 3];
}

function arrayGet1(offset, outputArray, outputIndex) {
  outputArray[outputIndex] = this.array[offset];
}

function arrayGet2(offset, outputArray, outputIndex) {
  outputArray[outputIndex] = this.array[offset];
  outputArray[outputIndex + 1] = this.array[offset + 1];
}

function arrayGet3(offset, outputArray, outputIndex) {
  outputArray[outputIndex] = this.array[offset];
  outputArray[outputIndex + 1] = this.array[offset + 1];
  outputArray[outputIndex + 2] = this.array[offset + 2];
}

function arrayGet4(offset, outputArray, outputIndex) {
  outputArray[outputIndex] = this.array[offset];
  outputArray[outputIndex + 1] = this.array[offset + 1];
  outputArray[outputIndex + 2] = this.array[offset + 2];
  outputArray[outputIndex + 3] = this.array[offset + 3];
}

class VertexIteratorAccessor {
  constructor(buffer, vertexElement, vertexFormat) {
    this.index = 0;
    this.numComponents = vertexElement.numComponents;

    if (vertexFormat.interleaved) {
      this.array = new typedArrayTypes[vertexElement.dataType](buffer, vertexElement.offset);
    } else {
      this.array = new typedArrayTypes[vertexElement.dataType](buffer, vertexElement.offset, vertexFormat.vertexCount * vertexElement.numComponents);
    }

    this.stride = vertexElement.stride / this.array.constructor.BYTES_PER_ELEMENT;

    switch (vertexElement.numComponents) {
      case 1:
        this.set = set1;
        this.getToArray = arrayGet1;
        this.setFromArray = arraySet1;
        break;

      case 2:
        this.set = set2;
        this.getToArray = arrayGet2;
        this.setFromArray = arraySet2;
        break;

      case 3:
        this.set = set3;
        this.getToArray = arrayGet3;
        this.setFromArray = arraySet3;
        break;

      case 4:
        this.set = set4;
        this.getToArray = arrayGet4;
        this.setFromArray = arraySet4;
        break;
    }
  }

  get(offset) {
    return this.array[this.index + offset];
  }

  set(a, b, c, d) {}

  getToArray(offset, outputArray, outputIndex) {}

  setFromArray(index, inputArray, inputIndex) {}

}

class VertexIterator {
  constructor(vertexBuffer) {
    this.vertexBuffer = vertexBuffer;
    this.vertexFormatSize = vertexBuffer.getFormat().size;
    this.buffer = this.vertexBuffer.lock();
    this.accessors = [];
    this.element = {};
    const vertexFormat = this.vertexBuffer.getFormat();

    for (let i = 0; i < vertexFormat.elements.length; i++) {
      const vertexElement = vertexFormat.elements[i];
      this.accessors[i] = new VertexIteratorAccessor(this.buffer, vertexElement, vertexFormat);
      this.element[vertexElement.name] = this.accessors[i];
    }
  }

  next(count = 1) {
    let i = 0;
    const accessors = this.accessors;
    const numAccessors = this.accessors.length;

    while (i < numAccessors) {
      const accessor = accessors[i++];
      accessor.index += count * accessor.stride;
    }
  }

  end() {
    this.vertexBuffer.unlock();
  }

  writeData(semantic, data, numVertices) {
    const element = this.element[semantic];

    if (element) {
      if (numVertices > this.vertexBuffer.numVertices) {
        Debug.error(`NumVertices provided to setData: ${numVertices} is larger than space in VertexBuffer: ${this.vertexBuffer.numVertices}`);
        numVertices = this.vertexBuffer.numVertices;
      }

      const numComponents = element.numComponents;

      if (this.vertexBuffer.getFormat().interleaved) {
        let index = 0;

        for (let i = 0; i < numVertices; i++) {
          element.setFromArray(index, data, i * numComponents);
          index += element.stride;
        }
      } else {
        if (data.length > numVertices * numComponents) {
          const copyCount = numVertices * numComponents;

          if (ArrayBuffer.isView(data)) {
            data = data.subarray(0, copyCount);
            element.array.set(data);
          } else {
            for (let i = 0; i < copyCount; i++) element.array[i] = data[i];
          }
        } else {
          element.array.set(data);
        }
      }
    }
  }

  readData(semantic, data) {
    const element = this.element[semantic];
    let count = 0;

    if (element) {
      count = this.vertexBuffer.numVertices;
      let i;
      const numComponents = element.numComponents;

      if (this.vertexBuffer.getFormat().interleaved) {
        if (Array.isArray(data)) data.length = 0;
        element.index = 0;
        let offset = 0;

        for (i = 0; i < count; i++) {
          element.getToArray(offset, data, i * numComponents);
          offset += element.stride;
        }
      } else {
        if (ArrayBuffer.isView(data)) {
          data.set(element.array);
        } else {
          data.length = 0;
          const copyCount = count * numComponents;

          for (i = 0; i < copyCount; i++) data[i] = element.array[i];
        }
      }
    }

    return count;
  }

}

export { VertexIterator, VertexIteratorAccessor };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVydGV4LWl0ZXJhdG9yLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZ3JhcGhpY3MvdmVydGV4LWl0ZXJhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vY29yZS9kZWJ1Zy5qcyc7XG5pbXBvcnQgeyB0eXBlZEFycmF5VHlwZXMgfSBmcm9tICcuL2NvbnN0YW50cy5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL3Njb3BlLWlkLmpzJykuU2NvcGVJZH0gU2NvcGVJZCAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vdmVydGV4LWJ1ZmZlci5qcycpLlZlcnRleEJ1ZmZlcn0gVmVydGV4QnVmZmVyICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi92ZXJ0ZXgtZm9ybWF0LmpzJykuVmVydGV4Rm9ybWF0fSBWZXJ0ZXhGb3JtYXQgKi9cblxuZnVuY3Rpb24gc2V0MShhKSB7XG4gICAgdGhpcy5hcnJheVt0aGlzLmluZGV4XSA9IGE7XG59XG5cbmZ1bmN0aW9uIHNldDIoYSwgYikge1xuICAgIHRoaXMuYXJyYXlbdGhpcy5pbmRleF0gPSBhO1xuICAgIHRoaXMuYXJyYXlbdGhpcy5pbmRleCArIDFdID0gYjtcbn1cblxuZnVuY3Rpb24gc2V0MyhhLCBiLCBjKSB7XG4gICAgdGhpcy5hcnJheVt0aGlzLmluZGV4XSA9IGE7XG4gICAgdGhpcy5hcnJheVt0aGlzLmluZGV4ICsgMV0gPSBiO1xuICAgIHRoaXMuYXJyYXlbdGhpcy5pbmRleCArIDJdID0gYztcbn1cblxuZnVuY3Rpb24gc2V0NChhLCBiLCBjLCBkKSB7XG4gICAgdGhpcy5hcnJheVt0aGlzLmluZGV4XSA9IGE7XG4gICAgdGhpcy5hcnJheVt0aGlzLmluZGV4ICsgMV0gPSBiO1xuICAgIHRoaXMuYXJyYXlbdGhpcy5pbmRleCArIDJdID0gYztcbiAgICB0aGlzLmFycmF5W3RoaXMuaW5kZXggKyAzXSA9IGQ7XG59XG5cbmZ1bmN0aW9uIGFycmF5U2V0MShpbmRleCwgaW5wdXRBcnJheSwgaW5wdXRJbmRleCkge1xuICAgIHRoaXMuYXJyYXlbaW5kZXhdID0gaW5wdXRBcnJheVtpbnB1dEluZGV4XTtcbn1cblxuZnVuY3Rpb24gYXJyYXlTZXQyKGluZGV4LCBpbnB1dEFycmF5LCBpbnB1dEluZGV4KSB7XG4gICAgdGhpcy5hcnJheVtpbmRleF0gPSBpbnB1dEFycmF5W2lucHV0SW5kZXhdO1xuICAgIHRoaXMuYXJyYXlbaW5kZXggKyAxXSA9IGlucHV0QXJyYXlbaW5wdXRJbmRleCArIDFdO1xufVxuXG5mdW5jdGlvbiBhcnJheVNldDMoaW5kZXgsIGlucHV0QXJyYXksIGlucHV0SW5kZXgpIHtcbiAgICB0aGlzLmFycmF5W2luZGV4XSA9IGlucHV0QXJyYXlbaW5wdXRJbmRleF07XG4gICAgdGhpcy5hcnJheVtpbmRleCArIDFdID0gaW5wdXRBcnJheVtpbnB1dEluZGV4ICsgMV07XG4gICAgdGhpcy5hcnJheVtpbmRleCArIDJdID0gaW5wdXRBcnJheVtpbnB1dEluZGV4ICsgMl07XG59XG5cbmZ1bmN0aW9uIGFycmF5U2V0NChpbmRleCwgaW5wdXRBcnJheSwgaW5wdXRJbmRleCkge1xuICAgIHRoaXMuYXJyYXlbaW5kZXhdID0gaW5wdXRBcnJheVtpbnB1dEluZGV4XTtcbiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSBpbnB1dEFycmF5W2lucHV0SW5kZXggKyAxXTtcbiAgICB0aGlzLmFycmF5W2luZGV4ICsgMl0gPSBpbnB1dEFycmF5W2lucHV0SW5kZXggKyAyXTtcbiAgICB0aGlzLmFycmF5W2luZGV4ICsgM10gPSBpbnB1dEFycmF5W2lucHV0SW5kZXggKyAzXTtcbn1cblxuZnVuY3Rpb24gYXJyYXlHZXQxKG9mZnNldCwgb3V0cHV0QXJyYXksIG91dHB1dEluZGV4KSB7XG4gICAgb3V0cHV0QXJyYXlbb3V0cHV0SW5kZXhdID0gdGhpcy5hcnJheVtvZmZzZXRdO1xufVxuXG5mdW5jdGlvbiBhcnJheUdldDIob2Zmc2V0LCBvdXRwdXRBcnJheSwgb3V0cHV0SW5kZXgpIHtcbiAgICBvdXRwdXRBcnJheVtvdXRwdXRJbmRleF0gPSB0aGlzLmFycmF5W29mZnNldF07XG4gICAgb3V0cHV0QXJyYXlbb3V0cHV0SW5kZXggKyAxXSA9IHRoaXMuYXJyYXlbb2Zmc2V0ICsgMV07XG59XG5cbmZ1bmN0aW9uIGFycmF5R2V0MyhvZmZzZXQsIG91dHB1dEFycmF5LCBvdXRwdXRJbmRleCkge1xuICAgIG91dHB1dEFycmF5W291dHB1dEluZGV4XSA9IHRoaXMuYXJyYXlbb2Zmc2V0XTtcbiAgICBvdXRwdXRBcnJheVtvdXRwdXRJbmRleCArIDFdID0gdGhpcy5hcnJheVtvZmZzZXQgKyAxXTtcbiAgICBvdXRwdXRBcnJheVtvdXRwdXRJbmRleCArIDJdID0gdGhpcy5hcnJheVtvZmZzZXQgKyAyXTtcbn1cblxuZnVuY3Rpb24gYXJyYXlHZXQ0KG9mZnNldCwgb3V0cHV0QXJyYXksIG91dHB1dEluZGV4KSB7XG4gICAgb3V0cHV0QXJyYXlbb3V0cHV0SW5kZXhdID0gdGhpcy5hcnJheVtvZmZzZXRdO1xuICAgIG91dHB1dEFycmF5W291dHB1dEluZGV4ICsgMV0gPSB0aGlzLmFycmF5W29mZnNldCArIDFdO1xuICAgIG91dHB1dEFycmF5W291dHB1dEluZGV4ICsgMl0gPSB0aGlzLmFycmF5W29mZnNldCArIDJdO1xuICAgIG91dHB1dEFycmF5W291dHB1dEluZGV4ICsgM10gPSB0aGlzLmFycmF5W29mZnNldCArIDNdO1xufVxuXG4vKipcbiAqIEhlbHBzIHdpdGggYWNjZXNzaW5nIGEgc3BlY2lmaWMgdmVydGV4IGF0dHJpYnV0ZS5cbiAqL1xuY2xhc3MgVmVydGV4SXRlcmF0b3JBY2Nlc3NvciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFZlcnRleEl0ZXJhdG9yQWNjZXNzb3IgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBidWZmZXIgLSBUaGUgdmVydGV4IGJ1ZmZlciBjb250YWluaW5nIHRoZSBhdHRyaWJ1dGUgdG8gYmUgYWNjZXNzZWQuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHZlcnRleEVsZW1lbnQgLSBUaGUgdmVydGV4IGF0dHJpYnV0ZSB0byBiZSBhY2Nlc3NlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVydGV4RWxlbWVudC5uYW1lIC0gVGhlIG1lYW5pbmcgb2YgdGhlIHZlcnRleCBlbGVtZW50LiBUaGlzIGlzIHVzZWQgdG8gbGlua1xuICAgICAqIHRoZSB2ZXJ0ZXggZGF0YSB0byBhIHNoYWRlciBpbnB1dC4gQ2FuIGJlOlxuICAgICAqXG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfUE9TSVRJT059XG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfTk9STUFMfVxuICAgICAqIC0ge0BsaW5rIFNFTUFOVElDX1RBTkdFTlR9XG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfQkxFTkRXRUlHSFR9XG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfQkxFTkRJTkRJQ0VTfVxuICAgICAqIC0ge0BsaW5rIFNFTUFOVElDX0NPTE9SfVxuICAgICAqIC0ge0BsaW5rIFNFTUFOVElDX1RFWENPT1JEMH1cbiAgICAgKiAtIHtAbGluayBTRU1BTlRJQ19URVhDT09SRDF9XG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfVEVYQ09PUkQyfVxuICAgICAqIC0ge0BsaW5rIFNFTUFOVElDX1RFWENPT1JEM31cbiAgICAgKiAtIHtAbGluayBTRU1BTlRJQ19URVhDT09SRDR9XG4gICAgICogLSB7QGxpbmsgU0VNQU5USUNfVEVYQ09PUkQ1fVxuICAgICAqIC0ge0BsaW5rIFNFTUFOVElDX1RFWENPT1JENn1cbiAgICAgKiAtIHtAbGluayBTRU1BTlRJQ19URVhDT09SRDd9XG4gICAgICpcbiAgICAgKiBJZiB2ZXJ0ZXggZGF0YSBoYXMgYSBtZWFuaW5nIG90aGVyIHRoYXQgb25lIG9mIHRob3NlIGxpc3RlZCBhYm92ZSwgdXNlIHRoZSB1c2VyLWRlZmluZWRcbiAgICAgKiBzZW1hbnRpY3M6IHtAbGluayBTRU1BTlRJQ19BVFRSMH0gdG8ge0BsaW5rIFNFTUFOVElDX0FUVFIxNX0uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZlcnRleEVsZW1lbnQubnVtQ29tcG9uZW50cyAtIFRoZSBudW1iZXIgb2YgY29tcG9uZW50cyBvZiB0aGUgdmVydGV4XG4gICAgICogYXR0cmlidXRlLiBDYW4gYmUgMSwgMiwgMyBvciA0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2ZXJ0ZXhFbGVtZW50LmRhdGFUeXBlIC0gVGhlIGRhdGEgdHlwZSBvZiB0aGUgYXR0cmlidXRlLiBDYW4gYmU6XG4gICAgICpcbiAgICAgKiAtIHtAbGluayBUWVBFX0lOVDh9XG4gICAgICogLSB7QGxpbmsgVFlQRV9VSU5UOH1cbiAgICAgKiAtIHtAbGluayBUWVBFX0lOVDE2fVxuICAgICAqIC0ge0BsaW5rIFRZUEVfVUlOVDE2fVxuICAgICAqIC0ge0BsaW5rIFRZUEVfSU5UMzJ9XG4gICAgICogLSB7QGxpbmsgVFlQRV9VSU5UMzJ9XG4gICAgICogLSB7QGxpbmsgVFlQRV9GTE9BVDMyfVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmVydGV4RWxlbWVudC5ub3JtYWxpemUgLSBJZiB0cnVlLCB2ZXJ0ZXggYXR0cmlidXRlIGRhdGEgd2lsbCBiZSBtYXBwZWRcbiAgICAgKiBmcm9tIGEgMCB0byAyNTUgcmFuZ2UgZG93biB0byAwIHRvIDEgd2hlbiBmZWQgdG8gYSBzaGFkZXIuIElmIGZhbHNlLCB2ZXJ0ZXggYXR0cmlidXRlIGRhdGFcbiAgICAgKiBpcyBsZWZ0IHVuY2hhbmdlZC4gSWYgdGhpcyBwcm9wZXJ0eSBpcyB1bnNwZWNpZmllZCwgZmFsc2UgaXMgYXNzdW1lZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmVydGV4RWxlbWVudC5vZmZzZXQgLSBUaGUgbnVtYmVyIG9mIGluaXRpYWwgYnl0ZXMgYXQgdGhlIHN0YXJ0IG9mIGEgdmVydGV4XG4gICAgICogdGhhdCBhcmUgbm90IHJlbGV2YW50IHRvIHRoaXMgYXR0cmlidXRlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2ZXJ0ZXhFbGVtZW50LnN0cmlkZSAtIFRoZSBudW1iZXIgb2YgdG90YWwgYnl0ZXMgdGhhdCBhcmUgYmV0d2VlbiB0aGUgc3RhcnRcbiAgICAgKiBvZiBvbmUgdmVydGV4LCBhbmQgdGhlIHN0YXJ0IG9mIHRoZSBuZXh0LlxuICAgICAqIEBwYXJhbSB7U2NvcGVJZH0gdmVydGV4RWxlbWVudC5zY29wZUlkIC0gVGhlIHNoYWRlciBpbnB1dCB2YXJpYWJsZSBjb3JyZXNwb25kaW5nIHRvIHRoZVxuICAgICAqIGF0dHJpYnV0ZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmVydGV4RWxlbWVudC5zaXplIC0gVGhlIHNpemUgb2YgdGhlIGF0dHJpYnV0ZSBpbiBieXRlcy5cbiAgICAgKiBAcGFyYW0ge1ZlcnRleEZvcm1hdH0gdmVydGV4Rm9ybWF0IC0gQSB2ZXJ0ZXggZm9ybWF0IHRoYXQgZGVmaW5lcyB0aGUgbGF5b3V0IG9mIHZlcnRleCBkYXRhXG4gICAgICogaW5zaWRlIHRoZSBidWZmZXIuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYnVmZmVyLCB2ZXJ0ZXhFbGVtZW50LCB2ZXJ0ZXhGb3JtYXQpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMubnVtQ29tcG9uZW50cyA9IHZlcnRleEVsZW1lbnQubnVtQ29tcG9uZW50cztcblxuICAgICAgICAvLyBjcmVhdGUgdGhlIHR5cGVkIGFycmF5IGJhc2VkIG9uIHRoZSBlbGVtZW50IGRhdGEgdHlwZVxuICAgICAgICBpZiAodmVydGV4Rm9ybWF0LmludGVybGVhdmVkKSB7XG4gICAgICAgICAgICB0aGlzLmFycmF5ID0gbmV3IHR5cGVkQXJyYXlUeXBlc1t2ZXJ0ZXhFbGVtZW50LmRhdGFUeXBlXShidWZmZXIsIHZlcnRleEVsZW1lbnQub2Zmc2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXJyYXkgPSBuZXcgdHlwZWRBcnJheVR5cGVzW3ZlcnRleEVsZW1lbnQuZGF0YVR5cGVdKGJ1ZmZlciwgdmVydGV4RWxlbWVudC5vZmZzZXQsIHZlcnRleEZvcm1hdC52ZXJ0ZXhDb3VudCAqIHZlcnRleEVsZW1lbnQubnVtQ29tcG9uZW50cyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCWVRFU19QRVJfRUxFTUVOVCBpcyBvbiB0aGUgaW5zdGFuY2UgYW5kIGNvbnN0cnVjdG9yIGZvciBDaHJvbWUsIFNhZmFyaSBhbmQgRmlyZWZveCwgYnV0IGp1c3QgdGhlIGNvbnN0cnVjdG9yIGZvciBPcGVyYVxuICAgICAgICB0aGlzLnN0cmlkZSA9IHZlcnRleEVsZW1lbnQuc3RyaWRlIC8gdGhpcy5hcnJheS5jb25zdHJ1Y3Rvci5CWVRFU19QRVJfRUxFTUVOVDtcblxuICAgICAgICAvLyBNZXRob2RzXG4gICAgICAgIHN3aXRjaCAodmVydGV4RWxlbWVudC5udW1Db21wb25lbnRzKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQgPSBzZXQxO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VG9BcnJheSA9IGFycmF5R2V0MTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZyb21BcnJheSA9IGFycmF5U2V0MTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMuc2V0ID0gc2V0MjtcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRvQXJyYXkgPSBhcnJheUdldDI7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGcm9tQXJyYXkgPSBhcnJheVNldDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICB0aGlzLnNldCA9IHNldDM7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRUb0FycmF5ID0gYXJyYXlHZXQzO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0RnJvbUFycmF5ID0gYXJyYXlTZXQzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQgPSBzZXQ0O1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VG9BcnJheSA9IGFycmF5R2V0NDtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZyb21BcnJheSA9IGFycmF5U2V0NDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIGF0dHJpYnV0ZSBjb21wb25lbnQgYXQgdGhlIGl0ZXJhdG9yJ3MgY3VycmVudCBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgY29tcG9uZW50IG9mZnNldC4gU2hvdWxkIGJlIGVpdGhlciAwLCAxLCAyLCBvciAzLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSB2YWx1ZSBvZiBhIGF0dHJpYnV0ZSBjb21wb25lbnQuXG4gICAgICovXG4gICAgZ2V0KG9mZnNldCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcnJheVt0aGlzLmluZGV4ICsgb2Zmc2V0XTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgYWxsIHRoZSBhdHRyaWJ1dGUgY29tcG9uZW50cyBhdCB0aGUgaXRlcmF0b3IncyBjdXJyZW50IGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGEgLSBUaGUgZmlyc3QgY29tcG9uZW50IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYl0gLSBUaGUgc2Vjb25kIGNvbXBvbmVudCB2YWx1ZSAoaWYgYXBwbGljYWJsZSkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjXSAtIFRoZSB0aGlyZCBjb21wb25lbnQgdmFsdWUgKGlmIGFwcGxpY2FibGUpLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZF0gLSBUaGUgZm91cnRoIGNvbXBvbmVudCB2YWx1ZSAoaWYgYXBwbGljYWJsZSkuXG4gICAgICovXG4gICAgc2V0KGEsIGIsIGMsIGQpIHtcbiAgICAgICAgLy8gV2lsbCBiZSByZXBsYWNlZCB3aXRoIHNwZWNpYWxpemVkIGltcGxlbWVudGF0aW9uIGJhc2VkIG9uIG51bWJlciBvZiBjb21wb25lbnRzXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVhZCBhdHRyaWJ1dGUgY29tcG9uZW50cyB0byBhbiBvdXRwdXQgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIGNvbXBvbmVudCBvZmZzZXQgYXQgd2hpY2ggdG8gcmVhZCBkYXRhIGZyb20gdGhlIGJ1ZmZlci4gV2lsbCBiZVxuICAgICAqIHVzZWQgaW5zdGVhZCBvZiB0aGUgaXRlcmF0b3IncyBjdXJyZW50IGluZGV4LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW118SW50OEFycmF5fFVpbnQ4QXJyYXl8VWludDhDbGFtcGVkQXJyYXl8SW50MTZBcnJheXxVaW50MTZBcnJheXxJbnQzMkFycmF5fFVpbnQzMkFycmF5fEZsb2F0MzJBcnJheX0gb3V0cHV0QXJyYXkgLSBUaGUgb3V0cHV0IGFycmF5IHRvIHdyaXRlIGRhdGEgaW50by5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3V0cHV0SW5kZXggLSBUaGUgb3V0cHV0IGluZGV4IGF0IHdoaWNoIHRvIHdyaXRlIGludG8gdGhlIG91dHB1dCBhcnJheS5cbiAgICAgKi9cbiAgICBnZXRUb0FycmF5KG9mZnNldCwgb3V0cHV0QXJyYXksIG91dHB1dEluZGV4KSB7XG4gICAgICAgIC8vIFdpbGwgYmUgcmVwbGFjZWQgd2l0aCBzcGVjaWFsaXplZCBpbXBsZW1lbnRhdGlvbiBiYXNlZCBvbiBudW1iZXIgb2YgY29tcG9uZW50c1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdyaXRlIGF0dHJpYnV0ZSBjb21wb25lbnRzIGZyb20gYW4gaW5wdXQgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgc3RhcnRpbmcgaW5kZXggYXQgd2hpY2ggdG8gd3JpdGUgZGF0YSBpbnRvIHRoZSBidWZmZXIuIFdpbGwgYmVcbiAgICAgKiB1c2VkIGluc3RlYWQgb2YgdGhlIGl0ZXJhdG9yJ3MgY3VycmVudCBpbmRleC5cbiAgICAgKiBAcGFyYW0ge251bWJlcltdfEludDhBcnJheXxVaW50OEFycmF5fFVpbnQ4Q2xhbXBlZEFycmF5fEludDE2QXJyYXl8VWludDE2QXJyYXl8SW50MzJBcnJheXxVaW50MzJBcnJheXxGbG9hdDMyQXJyYXl9IGlucHV0QXJyYXkgLSBUaGUgaW5wdXQgYXJyYXkgdG8gcmVhZCBkYXRhIGZyb20uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGlucHV0SW5kZXggLSBUaGUgaW5wdXQgaW5kZXggYXQgd2hpY2ggdG8gcmVhZCBmcm9tIHRoZSBpbnB1dCBhcnJheS5cbiAgICAgKi9cbiAgICBzZXRGcm9tQXJyYXkoaW5kZXgsIGlucHV0QXJyYXksIGlucHV0SW5kZXgpIHtcbiAgICAgICAgLy8gV2lsbCBiZSByZXBsYWNlZCB3aXRoIHNwZWNpYWxpemVkIGltcGxlbWVudGF0aW9uIGJhc2VkIG9uIG51bWJlciBvZiBjb21wb25lbnRzXG4gICAgfVxufVxuXG4vKipcbiAqIEEgdmVydGV4IGl0ZXJhdG9yIHNpbXBsaWZpZXMgdGhlIHByb2Nlc3Mgb2Ygd3JpdGluZyB2ZXJ0ZXggZGF0YSB0byBhIHZlcnRleCBidWZmZXIuXG4gKi9cbmNsYXNzIFZlcnRleEl0ZXJhdG9yIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgVmVydGV4SXRlcmF0b3IgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1ZlcnRleEJ1ZmZlcn0gdmVydGV4QnVmZmVyIC0gVGhlIHZlcnRleCBidWZmZXIgdG8gYmUgaXRlcmF0ZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodmVydGV4QnVmZmVyKSB7XG4gICAgICAgIC8vIFN0b3JlIHRoZSB2ZXJ0ZXggYnVmZmVyXG4gICAgICAgIHRoaXMudmVydGV4QnVmZmVyID0gdmVydGV4QnVmZmVyO1xuICAgICAgICB0aGlzLnZlcnRleEZvcm1hdFNpemUgPSB2ZXJ0ZXhCdWZmZXIuZ2V0Rm9ybWF0KCkuc2l6ZTtcblxuICAgICAgICAvLyBMb2NrIHRoZSB2ZXJ0ZXggYnVmZmVyXG4gICAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy52ZXJ0ZXhCdWZmZXIubG9jaygpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhbiBlbXB0eSBsaXN0XG4gICAgICAgIHRoaXMuYWNjZXNzb3JzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB2ZXJ0ZXggYnVmZmVyIGVsZW1lbnRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgVmVydGV4SXRlcmF0b3JBY2Nlc3Nvcj59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB7fTtcblxuICAgICAgICAvLyBBZGQgYSBuZXcgJ3NldHRlcicgZnVuY3Rpb24gZm9yIGVhY2ggZWxlbWVudFxuICAgICAgICBjb25zdCB2ZXJ0ZXhGb3JtYXQgPSB0aGlzLnZlcnRleEJ1ZmZlci5nZXRGb3JtYXQoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZXJ0ZXhGb3JtYXQuZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHZlcnRleEVsZW1lbnQgPSB2ZXJ0ZXhGb3JtYXQuZWxlbWVudHNbaV07XG4gICAgICAgICAgICB0aGlzLmFjY2Vzc29yc1tpXSA9IG5ldyBWZXJ0ZXhJdGVyYXRvckFjY2Vzc29yKHRoaXMuYnVmZmVyLCB2ZXJ0ZXhFbGVtZW50LCB2ZXJ0ZXhGb3JtYXQpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50W3ZlcnRleEVsZW1lbnQubmFtZV0gPSB0aGlzLmFjY2Vzc29yc1tpXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1vdmVzIHRoZSB2ZXJ0ZXggaXRlcmF0b3Igb24gdG8gdGhlIG5leHQgdmVydGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjb3VudF0gLSBPcHRpb25hbCBudW1iZXIgb2Ygc3RlcHMgdG8gbW92ZSBvbiB3aGVuIGNhbGxpbmcgbmV4dC4gRGVmYXVsdHMgdG9cbiAgICAgKiAxLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGl0ZXJhdG9yID0gbmV3IHBjLlZlcnRleEl0ZXJhdG9yKHZlcnRleEJ1ZmZlcik7XG4gICAgICogaXRlcmF0b3IuZWxlbWVudFtwYy5TRU1BTlRJQ19QT1NJVElPTl0uc2V0KC0wLjksIC0wLjksIDAuMCk7XG4gICAgICogaXRlcmF0b3IuZWxlbWVudFtwYy5TRU1BTlRJQ19DT0xPUl0uc2V0KDI1NSwgMCwgMCwgMjU1KTtcbiAgICAgKiBpdGVyYXRvci5uZXh0KCk7XG4gICAgICogaXRlcmF0b3IuZWxlbWVudFtwYy5TRU1BTlRJQ19QT1NJVElPTl0uc2V0KDAuOSwgLTAuOSwgMC4wKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX0NPTE9SXS5zZXQoMCwgMjU1LCAwLCAyNTUpO1xuICAgICAqIGl0ZXJhdG9yLm5leHQoKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX1BPU0lUSU9OXS5zZXQoMC4wLCAwLjksIDAuMCk7XG4gICAgICogaXRlcmF0b3IuZWxlbWVudFtwYy5TRU1BTlRJQ19DT0xPUl0uc2V0KDAsIDAsIDI1NSwgMjU1KTtcbiAgICAgKiBpdGVyYXRvci5lbmQoKTtcbiAgICAgKi9cbiAgICBuZXh0KGNvdW50ID0gMSkge1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGNvbnN0IGFjY2Vzc29ycyA9IHRoaXMuYWNjZXNzb3JzO1xuICAgICAgICBjb25zdCBudW1BY2Nlc3NvcnMgPSB0aGlzLmFjY2Vzc29ycy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpIDwgbnVtQWNjZXNzb3JzKSB7XG4gICAgICAgICAgICBjb25zdCBhY2Nlc3NvciA9IGFjY2Vzc29yc1tpKytdO1xuICAgICAgICAgICAgYWNjZXNzb3IuaW5kZXggKz0gY291bnQgKiBhY2Nlc3Nvci5zdHJpZGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyB0aGUgdmVydGV4IGJ1ZmZlciBiZWluZyBpdGVyYXRlZCB0aGF0IHdyaXRlcyBhcmUgY29tcGxldGUuIEludGVybmFsbHkgdGhlIHZlcnRleFxuICAgICAqIGJ1ZmZlciBpcyB1bmxvY2tlZCBhbmQgdmVydGV4IGRhdGEgaXMgdXBsb2FkZWQgdG8gdmlkZW8gbWVtb3J5LlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgaXRlcmF0b3IgPSBuZXcgcGMuVmVydGV4SXRlcmF0b3IodmVydGV4QnVmZmVyKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX1BPU0lUSU9OXS5zZXQoLTAuOSwgLTAuOSwgMC4wKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX0NPTE9SXS5zZXQoMjU1LCAwLCAwLCAyNTUpO1xuICAgICAqIGl0ZXJhdG9yLm5leHQoKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX1BPU0lUSU9OXS5zZXQoMC45LCAtMC45LCAwLjApO1xuICAgICAqIGl0ZXJhdG9yLmVsZW1lbnRbcGMuU0VNQU5USUNfQ09MT1JdLnNldCgwLCAyNTUsIDAsIDI1NSk7XG4gICAgICogaXRlcmF0b3IubmV4dCgpO1xuICAgICAqIGl0ZXJhdG9yLmVsZW1lbnRbcGMuU0VNQU5USUNfUE9TSVRJT05dLnNldCgwLjAsIDAuOSwgMC4wKTtcbiAgICAgKiBpdGVyYXRvci5lbGVtZW50W3BjLlNFTUFOVElDX0NPTE9SXS5zZXQoMCwgMCwgMjU1LCAyNTUpO1xuICAgICAqIGl0ZXJhdG9yLmVuZCgpO1xuICAgICAqL1xuICAgIGVuZCgpIHtcbiAgICAgICAgLy8gVW5sb2NrIHRoZSB2ZXJ0ZXggYnVmZmVyXG4gICAgICAgIHRoaXMudmVydGV4QnVmZmVyLnVubG9jaygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvcGllcyBkYXRhIGZvciBzcGVjaWZpZWQgc2VtYW50aWMgaW50byB2ZXJ0ZXggYnVmZmVyLiBXb3JrcyB3aXRoIGJvdGggaW50ZXJsZWF2ZWQgKHNsb3dlcilcbiAgICAgKiBhbmQgbm9uLWludGVybGVhdmVkIChmYXN0KSB2ZXJ0ZXggYnVmZmVycy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZW1hbnRpYyAtIFRoZSBzZW1hbnRpYyBvZiB0aGUgdmVydGV4IGVsZW1lbnQgdG8gc2V0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW118SW50OEFycmF5fFVpbnQ4QXJyYXl8VWludDhDbGFtcGVkQXJyYXl8SW50MTZBcnJheXxVaW50MTZBcnJheXxJbnQzMkFycmF5fFVpbnQzMkFycmF5fEZsb2F0MzJBcnJheX0gZGF0YSAtIFRoZSBkYXRhIHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbnVtVmVydGljZXMgLSBUaGUgbnVtYmVyIG9mIHZlcnRpY2VzIHRvIHdyaXRlLlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICB3cml0ZURhdGEoc2VtYW50aWMsIGRhdGEsIG51bVZlcnRpY2VzKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRbc2VtYW50aWNdO1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuXG4gICAgICAgICAgICBpZiAobnVtVmVydGljZXMgPiB0aGlzLnZlcnRleEJ1ZmZlci5udW1WZXJ0aWNlcykge1xuICAgICAgICAgICAgICAgIERlYnVnLmVycm9yKGBOdW1WZXJ0aWNlcyBwcm92aWRlZCB0byBzZXREYXRhOiAke251bVZlcnRpY2VzfSBpcyBsYXJnZXIgdGhhbiBzcGFjZSBpbiBWZXJ0ZXhCdWZmZXI6ICR7dGhpcy52ZXJ0ZXhCdWZmZXIubnVtVmVydGljZXN9YCk7XG5cbiAgICAgICAgICAgICAgICAvLyBhdm9pZCBvdmVyd3JpdGVcbiAgICAgICAgICAgICAgICBudW1WZXJ0aWNlcyA9IHRoaXMudmVydGV4QnVmZmVyLm51bVZlcnRpY2VzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBudW1Db21wb25lbnRzID0gZWxlbWVudC5udW1Db21wb25lbnRzO1xuXG4gICAgICAgICAgICAvLyBjb3B5IGRhdGEgdG8gaW50ZXJsZWF2ZWQgYnVmZmVyIGJ5IGxvb3Bpbmcgb3ZlciB2ZXJ0aWNlcyBhbmQgY29weWluZyB0aGVtIG1hbnVhbGx5XG4gICAgICAgICAgICBpZiAodGhpcy52ZXJ0ZXhCdWZmZXIuZ2V0Rm9ybWF0KCkuaW50ZXJsZWF2ZWQpIHtcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldEZyb21BcnJheShpbmRleCwgZGF0YSwgaSAqIG51bUNvbXBvbmVudHMpO1xuICAgICAgICAgICAgICAgICAgICBpbmRleCArPSBlbGVtZW50LnN0cmlkZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgeyAgICAvLyBub24taW50ZXJsZWF2ZWQgY29weVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgZGF0YSBjb250YWlucyBtb3JlICBkYXRhIHRoYW4gbmVlZGVkLCBjb3B5IGZyb20gaXRzIHN1YmFycmF5XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gbnVtVmVydGljZXMgKiBudW1Db21wb25lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvcHlDb3VudCA9IG51bVZlcnRpY2VzICogbnVtQ29tcG9uZW50cztcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBkYXRhIGlzIHR5cGVkIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhLnN1YmFycmF5KDAsIGNvcHlDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFycmF5LnNldChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgaXMgYXJyYXksIGNvcHkgcmlnaHQgYW1vdW50IG1hbnVhbGx5XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcHlDb3VudDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXJyYXlbaV0gPSBkYXRhW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29weSB3aG9sZSBkYXRhXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXJyYXkuc2V0KGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIGV4dHJhY3QgZWxlbWVudHMgb2YgYSBzcGVjaWZpZWQgc2VtYW50aWMgZnJvbSB2ZXJ0ZXggYnVmZmVyIGludG8gZmxhdCBhcnJheVxuICAgICAqIChkYXRhKS4gV29ya3Mgd2l0aCBib3RoIGludGVybGVhdmVkIChzbG93ZXIpIGFuZCBub24taW50ZXJsZWF2ZWQgKGZhc3QpIHZlcnRleCBidWZmZXJzLlxuICAgICAqIFJldHVybnMgbnVtYmVyIG9mIHZlcnRpY2VzLiBOb3RlOiB3aGVuIGRhdGEgaXMgYSB0eXBlZCBhcnJheSBhbmQgaXMgc21hbGxlciB0aGFuIG5lZWRlZCxcbiAgICAgKiBvbmx5IHBhcnQgb2YgdGhlIGRhdGEgZ2V0cyBjb3BpZWQgb3V0ICh0eXBlZCBhcnJheXMgaWdub3JlIHJlYWQvd3JpdGUgb3V0IG9mIHJhbmdlKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZW1hbnRpYyAtIFRoZSBzZW1hbnRpYyBvZiB0aGUgdmVydGV4IGVsZW1lbnQgdG8gcmVhZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcltdfEludDhBcnJheXxVaW50OEFycmF5fFVpbnQ4Q2xhbXBlZEFycmF5fEludDE2QXJyYXl8VWludDE2QXJyYXl8SW50MzJBcnJheXxVaW50MzJBcnJheXxGbG9hdDMyQXJyYXl9IGRhdGEgLSBUaGVcbiAgICAgKiBhcnJheSB0byByZWNlaXZlIHRoZSBkYXRhLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgdmVydGljZXMgcmVhZC5cbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgcmVhZERhdGEoc2VtYW50aWMsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudFtzZW1hbnRpY107XG4gICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICBjb3VudCA9IHRoaXMudmVydGV4QnVmZmVyLm51bVZlcnRpY2VzO1xuICAgICAgICAgICAgbGV0IGk7XG4gICAgICAgICAgICBjb25zdCBudW1Db21wb25lbnRzID0gZWxlbWVudC5udW1Db21wb25lbnRzO1xuXG4gICAgICAgICAgICBpZiAodGhpcy52ZXJ0ZXhCdWZmZXIuZ2V0Rm9ybWF0KCkuaW50ZXJsZWF2ZWQpIHtcblxuICAgICAgICAgICAgICAgIC8vIGV4dHJhY3QgZGF0YSBmcm9tIGludGVybGVhdmVkIGJ1ZmZlciBieSBsb29waW5nIG92ZXIgdmVydGljZXMgYW5kIGNvcHlpbmcgdGhlbSBtYW51YWxseVxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKVxuICAgICAgICAgICAgICAgICAgICBkYXRhLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50LmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmdldFRvQXJyYXkob2Zmc2V0LCBkYXRhLCBpICogbnVtQ29tcG9uZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBlbGVtZW50LnN0cmlkZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVzdGluYXRpb24gZGF0YSBpcyB0eXBlZCBhcnJheVxuICAgICAgICAgICAgICAgICAgICBkYXRhLnNldChlbGVtZW50LmFycmF5KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBkZXN0aW5hdGlvbiBkYXRhIGlzIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weUNvdW50ID0gY291bnQgKiBudW1Db21wb25lbnRzO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY29weUNvdW50OyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2ldID0gZWxlbWVudC5hcnJheVtpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgfVxufVxuXG5leHBvcnQgeyBWZXJ0ZXhJdGVyYXRvciwgVmVydGV4SXRlcmF0b3JBY2Nlc3NvciB9O1xuIl0sIm5hbWVzIjpbInNldDEiLCJhIiwiYXJyYXkiLCJpbmRleCIsInNldDIiLCJiIiwic2V0MyIsImMiLCJzZXQ0IiwiZCIsImFycmF5U2V0MSIsImlucHV0QXJyYXkiLCJpbnB1dEluZGV4IiwiYXJyYXlTZXQyIiwiYXJyYXlTZXQzIiwiYXJyYXlTZXQ0IiwiYXJyYXlHZXQxIiwib2Zmc2V0Iiwib3V0cHV0QXJyYXkiLCJvdXRwdXRJbmRleCIsImFycmF5R2V0MiIsImFycmF5R2V0MyIsImFycmF5R2V0NCIsIlZlcnRleEl0ZXJhdG9yQWNjZXNzb3IiLCJjb25zdHJ1Y3RvciIsImJ1ZmZlciIsInZlcnRleEVsZW1lbnQiLCJ2ZXJ0ZXhGb3JtYXQiLCJudW1Db21wb25lbnRzIiwiaW50ZXJsZWF2ZWQiLCJ0eXBlZEFycmF5VHlwZXMiLCJkYXRhVHlwZSIsInZlcnRleENvdW50Iiwic3RyaWRlIiwiQllURVNfUEVSX0VMRU1FTlQiLCJzZXQiLCJnZXRUb0FycmF5Iiwic2V0RnJvbUFycmF5IiwiZ2V0IiwiVmVydGV4SXRlcmF0b3IiLCJ2ZXJ0ZXhCdWZmZXIiLCJ2ZXJ0ZXhGb3JtYXRTaXplIiwiZ2V0Rm9ybWF0Iiwic2l6ZSIsImxvY2siLCJhY2Nlc3NvcnMiLCJlbGVtZW50IiwiaSIsImVsZW1lbnRzIiwibGVuZ3RoIiwibmFtZSIsIm5leHQiLCJjb3VudCIsIm51bUFjY2Vzc29ycyIsImFjY2Vzc29yIiwiZW5kIiwidW5sb2NrIiwid3JpdGVEYXRhIiwic2VtYW50aWMiLCJkYXRhIiwibnVtVmVydGljZXMiLCJEZWJ1ZyIsImVycm9yIiwiY29weUNvdW50IiwiQXJyYXlCdWZmZXIiLCJpc1ZpZXciLCJzdWJhcnJheSIsInJlYWREYXRhIiwiQXJyYXkiLCJpc0FycmF5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQU9BLFNBQVNBLElBQVQsQ0FBY0MsQ0FBZCxFQUFpQjtBQUNiLEVBQUEsSUFBQSxDQUFLQyxLQUFMLENBQVcsSUFBS0MsQ0FBQUEsS0FBaEIsSUFBeUJGLENBQXpCLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNHLElBQVQsQ0FBY0gsQ0FBZCxFQUFpQkksQ0FBakIsRUFBb0I7QUFDaEIsRUFBQSxJQUFBLENBQUtILEtBQUwsQ0FBVyxJQUFLQyxDQUFBQSxLQUFoQixJQUF5QkYsQ0FBekIsQ0FBQTtBQUNBLEVBQUEsSUFBQSxDQUFLQyxLQUFMLENBQVcsSUFBQSxDQUFLQyxLQUFMLEdBQWEsQ0FBeEIsSUFBNkJFLENBQTdCLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNDLElBQVQsQ0FBY0wsQ0FBZCxFQUFpQkksQ0FBakIsRUFBb0JFLENBQXBCLEVBQXVCO0FBQ25CLEVBQUEsSUFBQSxDQUFLTCxLQUFMLENBQVcsSUFBS0MsQ0FBQUEsS0FBaEIsSUFBeUJGLENBQXpCLENBQUE7QUFDQSxFQUFBLElBQUEsQ0FBS0MsS0FBTCxDQUFXLElBQUEsQ0FBS0MsS0FBTCxHQUFhLENBQXhCLElBQTZCRSxDQUE3QixDQUFBO0FBQ0EsRUFBQSxJQUFBLENBQUtILEtBQUwsQ0FBVyxJQUFBLENBQUtDLEtBQUwsR0FBYSxDQUF4QixJQUE2QkksQ0FBN0IsQ0FBQTtBQUNILENBQUE7O0FBRUQsU0FBU0MsSUFBVCxDQUFjUCxDQUFkLEVBQWlCSSxDQUFqQixFQUFvQkUsQ0FBcEIsRUFBdUJFLENBQXZCLEVBQTBCO0FBQ3RCLEVBQUEsSUFBQSxDQUFLUCxLQUFMLENBQVcsSUFBS0MsQ0FBQUEsS0FBaEIsSUFBeUJGLENBQXpCLENBQUE7QUFDQSxFQUFBLElBQUEsQ0FBS0MsS0FBTCxDQUFXLElBQUEsQ0FBS0MsS0FBTCxHQUFhLENBQXhCLElBQTZCRSxDQUE3QixDQUFBO0FBQ0EsRUFBQSxJQUFBLENBQUtILEtBQUwsQ0FBVyxJQUFBLENBQUtDLEtBQUwsR0FBYSxDQUF4QixJQUE2QkksQ0FBN0IsQ0FBQTtBQUNBLEVBQUEsSUFBQSxDQUFLTCxLQUFMLENBQVcsSUFBQSxDQUFLQyxLQUFMLEdBQWEsQ0FBeEIsSUFBNkJNLENBQTdCLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNDLFNBQVQsQ0FBbUJQLEtBQW5CLEVBQTBCUSxVQUExQixFQUFzQ0MsVUFBdEMsRUFBa0Q7QUFDOUMsRUFBQSxJQUFBLENBQUtWLEtBQUwsQ0FBV0MsS0FBWCxJQUFvQlEsVUFBVSxDQUFDQyxVQUFELENBQTlCLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNDLFNBQVQsQ0FBbUJWLEtBQW5CLEVBQTBCUSxVQUExQixFQUFzQ0MsVUFBdEMsRUFBa0Q7QUFDOUMsRUFBQSxJQUFBLENBQUtWLEtBQUwsQ0FBV0MsS0FBWCxJQUFvQlEsVUFBVSxDQUFDQyxVQUFELENBQTlCLENBQUE7RUFDQSxJQUFLVixDQUFBQSxLQUFMLENBQVdDLEtBQUssR0FBRyxDQUFuQixDQUF3QlEsR0FBQUEsVUFBVSxDQUFDQyxVQUFVLEdBQUcsQ0FBZCxDQUFsQyxDQUFBO0FBQ0gsQ0FBQTs7QUFFRCxTQUFTRSxTQUFULENBQW1CWCxLQUFuQixFQUEwQlEsVUFBMUIsRUFBc0NDLFVBQXRDLEVBQWtEO0FBQzlDLEVBQUEsSUFBQSxDQUFLVixLQUFMLENBQVdDLEtBQVgsSUFBb0JRLFVBQVUsQ0FBQ0MsVUFBRCxDQUE5QixDQUFBO0VBQ0EsSUFBS1YsQ0FBQUEsS0FBTCxDQUFXQyxLQUFLLEdBQUcsQ0FBbkIsQ0FBd0JRLEdBQUFBLFVBQVUsQ0FBQ0MsVUFBVSxHQUFHLENBQWQsQ0FBbEMsQ0FBQTtFQUNBLElBQUtWLENBQUFBLEtBQUwsQ0FBV0MsS0FBSyxHQUFHLENBQW5CLENBQXdCUSxHQUFBQSxVQUFVLENBQUNDLFVBQVUsR0FBRyxDQUFkLENBQWxDLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNHLFNBQVQsQ0FBbUJaLEtBQW5CLEVBQTBCUSxVQUExQixFQUFzQ0MsVUFBdEMsRUFBa0Q7QUFDOUMsRUFBQSxJQUFBLENBQUtWLEtBQUwsQ0FBV0MsS0FBWCxJQUFvQlEsVUFBVSxDQUFDQyxVQUFELENBQTlCLENBQUE7RUFDQSxJQUFLVixDQUFBQSxLQUFMLENBQVdDLEtBQUssR0FBRyxDQUFuQixDQUF3QlEsR0FBQUEsVUFBVSxDQUFDQyxVQUFVLEdBQUcsQ0FBZCxDQUFsQyxDQUFBO0VBQ0EsSUFBS1YsQ0FBQUEsS0FBTCxDQUFXQyxLQUFLLEdBQUcsQ0FBbkIsQ0FBd0JRLEdBQUFBLFVBQVUsQ0FBQ0MsVUFBVSxHQUFHLENBQWQsQ0FBbEMsQ0FBQTtFQUNBLElBQUtWLENBQUFBLEtBQUwsQ0FBV0MsS0FBSyxHQUFHLENBQW5CLENBQXdCUSxHQUFBQSxVQUFVLENBQUNDLFVBQVUsR0FBRyxDQUFkLENBQWxDLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNJLFNBQVQsQ0FBbUJDLE1BQW5CLEVBQTJCQyxXQUEzQixFQUF3Q0MsV0FBeEMsRUFBcUQ7RUFDakRELFdBQVcsQ0FBQ0MsV0FBRCxDQUFYLEdBQTJCLEtBQUtqQixLQUFMLENBQVdlLE1BQVgsQ0FBM0IsQ0FBQTtBQUNILENBQUE7O0FBRUQsU0FBU0csU0FBVCxDQUFtQkgsTUFBbkIsRUFBMkJDLFdBQTNCLEVBQXdDQyxXQUF4QyxFQUFxRDtFQUNqREQsV0FBVyxDQUFDQyxXQUFELENBQVgsR0FBMkIsS0FBS2pCLEtBQUwsQ0FBV2UsTUFBWCxDQUEzQixDQUFBO0FBQ0FDLEVBQUFBLFdBQVcsQ0FBQ0MsV0FBVyxHQUFHLENBQWYsQ0FBWCxHQUErQixJQUFLakIsQ0FBQUEsS0FBTCxDQUFXZSxNQUFNLEdBQUcsQ0FBcEIsQ0FBL0IsQ0FBQTtBQUNILENBQUE7O0FBRUQsU0FBU0ksU0FBVCxDQUFtQkosTUFBbkIsRUFBMkJDLFdBQTNCLEVBQXdDQyxXQUF4QyxFQUFxRDtFQUNqREQsV0FBVyxDQUFDQyxXQUFELENBQVgsR0FBMkIsS0FBS2pCLEtBQUwsQ0FBV2UsTUFBWCxDQUEzQixDQUFBO0FBQ0FDLEVBQUFBLFdBQVcsQ0FBQ0MsV0FBVyxHQUFHLENBQWYsQ0FBWCxHQUErQixJQUFLakIsQ0FBQUEsS0FBTCxDQUFXZSxNQUFNLEdBQUcsQ0FBcEIsQ0FBL0IsQ0FBQTtBQUNBQyxFQUFBQSxXQUFXLENBQUNDLFdBQVcsR0FBRyxDQUFmLENBQVgsR0FBK0IsSUFBS2pCLENBQUFBLEtBQUwsQ0FBV2UsTUFBTSxHQUFHLENBQXBCLENBQS9CLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNLLFNBQVQsQ0FBbUJMLE1BQW5CLEVBQTJCQyxXQUEzQixFQUF3Q0MsV0FBeEMsRUFBcUQ7RUFDakRELFdBQVcsQ0FBQ0MsV0FBRCxDQUFYLEdBQTJCLEtBQUtqQixLQUFMLENBQVdlLE1BQVgsQ0FBM0IsQ0FBQTtBQUNBQyxFQUFBQSxXQUFXLENBQUNDLFdBQVcsR0FBRyxDQUFmLENBQVgsR0FBK0IsSUFBS2pCLENBQUFBLEtBQUwsQ0FBV2UsTUFBTSxHQUFHLENBQXBCLENBQS9CLENBQUE7QUFDQUMsRUFBQUEsV0FBVyxDQUFDQyxXQUFXLEdBQUcsQ0FBZixDQUFYLEdBQStCLElBQUtqQixDQUFBQSxLQUFMLENBQVdlLE1BQU0sR0FBRyxDQUFwQixDQUEvQixDQUFBO0FBQ0FDLEVBQUFBLFdBQVcsQ0FBQ0MsV0FBVyxHQUFHLENBQWYsQ0FBWCxHQUErQixJQUFLakIsQ0FBQUEsS0FBTCxDQUFXZSxNQUFNLEdBQUcsQ0FBcEIsQ0FBL0IsQ0FBQTtBQUNILENBQUE7O0FBS0QsTUFBTU0sc0JBQU4sQ0FBNkI7QUFrRHpCQyxFQUFBQSxXQUFXLENBQUNDLE1BQUQsRUFBU0MsYUFBVCxFQUF3QkMsWUFBeEIsRUFBc0M7SUFDN0MsSUFBS3hCLENBQUFBLEtBQUwsR0FBYSxDQUFiLENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBS3lCLGFBQUwsR0FBcUJGLGFBQWEsQ0FBQ0UsYUFBbkMsQ0FBQTs7SUFHQSxJQUFJRCxZQUFZLENBQUNFLFdBQWpCLEVBQThCO0FBQzFCLE1BQUEsSUFBQSxDQUFLM0IsS0FBTCxHQUFhLElBQUk0QixlQUFlLENBQUNKLGFBQWEsQ0FBQ0ssUUFBZixDQUFuQixDQUE0Q04sTUFBNUMsRUFBb0RDLGFBQWEsQ0FBQ1QsTUFBbEUsQ0FBYixDQUFBO0FBQ0gsS0FGRCxNQUVPO01BQ0gsSUFBS2YsQ0FBQUEsS0FBTCxHQUFhLElBQUk0QixlQUFlLENBQUNKLGFBQWEsQ0FBQ0ssUUFBZixDQUFuQixDQUE0Q04sTUFBNUMsRUFBb0RDLGFBQWEsQ0FBQ1QsTUFBbEUsRUFBMEVVLFlBQVksQ0FBQ0ssV0FBYixHQUEyQk4sYUFBYSxDQUFDRSxhQUFuSCxDQUFiLENBQUE7QUFDSCxLQUFBOztJQUdELElBQUtLLENBQUFBLE1BQUwsR0FBY1AsYUFBYSxDQUFDTyxNQUFkLEdBQXVCLElBQUEsQ0FBSy9CLEtBQUwsQ0FBV3NCLFdBQVgsQ0FBdUJVLGlCQUE1RCxDQUFBOztJQUdBLFFBQVFSLGFBQWEsQ0FBQ0UsYUFBdEI7QUFDSSxNQUFBLEtBQUssQ0FBTDtRQUNJLElBQUtPLENBQUFBLEdBQUwsR0FBV25DLElBQVgsQ0FBQTtRQUNBLElBQUtvQyxDQUFBQSxVQUFMLEdBQWtCcEIsU0FBbEIsQ0FBQTtRQUNBLElBQUtxQixDQUFBQSxZQUFMLEdBQW9CM0IsU0FBcEIsQ0FBQTtBQUNBLFFBQUEsTUFBQTs7QUFFSixNQUFBLEtBQUssQ0FBTDtRQUNJLElBQUt5QixDQUFBQSxHQUFMLEdBQVcvQixJQUFYLENBQUE7UUFDQSxJQUFLZ0MsQ0FBQUEsVUFBTCxHQUFrQmhCLFNBQWxCLENBQUE7UUFDQSxJQUFLaUIsQ0FBQUEsWUFBTCxHQUFvQnhCLFNBQXBCLENBQUE7QUFDQSxRQUFBLE1BQUE7O0FBRUosTUFBQSxLQUFLLENBQUw7UUFDSSxJQUFLc0IsQ0FBQUEsR0FBTCxHQUFXN0IsSUFBWCxDQUFBO1FBQ0EsSUFBSzhCLENBQUFBLFVBQUwsR0FBa0JmLFNBQWxCLENBQUE7UUFDQSxJQUFLZ0IsQ0FBQUEsWUFBTCxHQUFvQnZCLFNBQXBCLENBQUE7QUFDQSxRQUFBLE1BQUE7O0FBRUosTUFBQSxLQUFLLENBQUw7UUFDSSxJQUFLcUIsQ0FBQUEsR0FBTCxHQUFXM0IsSUFBWCxDQUFBO1FBQ0EsSUFBSzRCLENBQUFBLFVBQUwsR0FBa0JkLFNBQWxCLENBQUE7UUFDQSxJQUFLZSxDQUFBQSxZQUFMLEdBQW9CdEIsU0FBcEIsQ0FBQTtBQUNBLFFBQUEsTUFBQTtBQXZCUixLQUFBO0FBeUJILEdBQUE7O0VBUUR1QixHQUFHLENBQUNyQixNQUFELEVBQVM7QUFDUixJQUFBLE9BQU8sS0FBS2YsS0FBTCxDQUFXLEtBQUtDLEtBQUwsR0FBYWMsTUFBeEIsQ0FBUCxDQUFBO0FBQ0gsR0FBQTs7RUFVRGtCLEdBQUcsQ0FBQ2xDLENBQUQsRUFBSUksQ0FBSixFQUFPRSxDQUFQLEVBQVVFLENBQVYsRUFBYSxFQUVmOztBQVVEMkIsRUFBQUEsVUFBVSxDQUFDbkIsTUFBRCxFQUFTQyxXQUFULEVBQXNCQyxXQUF0QixFQUFtQyxFQUU1Qzs7QUFVRGtCLEVBQUFBLFlBQVksQ0FBQ2xDLEtBQUQsRUFBUVEsVUFBUixFQUFvQkMsVUFBcEIsRUFBZ0MsRUFFM0M7O0FBeEl3QixDQUFBOztBQThJN0IsTUFBTTJCLGNBQU4sQ0FBcUI7RUFNakJmLFdBQVcsQ0FBQ2dCLFlBQUQsRUFBZTtJQUV0QixJQUFLQSxDQUFBQSxZQUFMLEdBQW9CQSxZQUFwQixDQUFBO0FBQ0EsSUFBQSxJQUFBLENBQUtDLGdCQUFMLEdBQXdCRCxZQUFZLENBQUNFLFNBQWIsR0FBeUJDLElBQWpELENBQUE7QUFHQSxJQUFBLElBQUEsQ0FBS2xCLE1BQUwsR0FBYyxJQUFBLENBQUtlLFlBQUwsQ0FBa0JJLElBQWxCLEVBQWQsQ0FBQTtJQUdBLElBQUtDLENBQUFBLFNBQUwsR0FBaUIsRUFBakIsQ0FBQTtJQU9BLElBQUtDLENBQUFBLE9BQUwsR0FBZSxFQUFmLENBQUE7QUFHQSxJQUFBLE1BQU1uQixZQUFZLEdBQUcsSUFBQSxDQUFLYSxZQUFMLENBQWtCRSxTQUFsQixFQUFyQixDQUFBOztBQUNBLElBQUEsS0FBSyxJQUFJSyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHcEIsWUFBWSxDQUFDcUIsUUFBYixDQUFzQkMsTUFBMUMsRUFBa0RGLENBQUMsRUFBbkQsRUFBdUQ7QUFDbkQsTUFBQSxNQUFNckIsYUFBYSxHQUFHQyxZQUFZLENBQUNxQixRQUFiLENBQXNCRCxDQUF0QixDQUF0QixDQUFBO0FBQ0EsTUFBQSxJQUFBLENBQUtGLFNBQUwsQ0FBZUUsQ0FBZixDQUFBLEdBQW9CLElBQUl4QixzQkFBSixDQUEyQixJQUFBLENBQUtFLE1BQWhDLEVBQXdDQyxhQUF4QyxFQUF1REMsWUFBdkQsQ0FBcEIsQ0FBQTtNQUNBLElBQUttQixDQUFBQSxPQUFMLENBQWFwQixhQUFhLENBQUN3QixJQUEzQixJQUFtQyxJQUFLTCxDQUFBQSxTQUFMLENBQWVFLENBQWYsQ0FBbkMsQ0FBQTtBQUNILEtBQUE7QUFDSixHQUFBOztBQW1CREksRUFBQUEsSUFBSSxDQUFDQyxLQUFLLEdBQUcsQ0FBVCxFQUFZO0lBQ1osSUFBSUwsQ0FBQyxHQUFHLENBQVIsQ0FBQTtJQUNBLE1BQU1GLFNBQVMsR0FBRyxJQUFBLENBQUtBLFNBQXZCLENBQUE7QUFDQSxJQUFBLE1BQU1RLFlBQVksR0FBRyxJQUFLUixDQUFBQSxTQUFMLENBQWVJLE1BQXBDLENBQUE7O0lBQ0EsT0FBT0YsQ0FBQyxHQUFHTSxZQUFYLEVBQXlCO0FBQ3JCLE1BQUEsTUFBTUMsUUFBUSxHQUFHVCxTQUFTLENBQUNFLENBQUMsRUFBRixDQUExQixDQUFBO0FBQ0FPLE1BQUFBLFFBQVEsQ0FBQ25ELEtBQVQsSUFBa0JpRCxLQUFLLEdBQUdFLFFBQVEsQ0FBQ3JCLE1BQW5DLENBQUE7QUFDSCxLQUFBO0FBQ0osR0FBQTs7QUFrQkRzQixFQUFBQSxHQUFHLEdBQUc7SUFFRixJQUFLZixDQUFBQSxZQUFMLENBQWtCZ0IsTUFBbEIsRUFBQSxDQUFBO0FBQ0gsR0FBQTs7QUFXREMsRUFBQUEsU0FBUyxDQUFDQyxRQUFELEVBQVdDLElBQVgsRUFBaUJDLFdBQWpCLEVBQThCO0FBQ25DLElBQUEsTUFBTWQsT0FBTyxHQUFHLElBQUEsQ0FBS0EsT0FBTCxDQUFhWSxRQUFiLENBQWhCLENBQUE7O0FBQ0EsSUFBQSxJQUFJWixPQUFKLEVBQWE7QUFFVCxNQUFBLElBQUljLFdBQVcsR0FBRyxJQUFBLENBQUtwQixZQUFMLENBQWtCb0IsV0FBcEMsRUFBaUQ7UUFDN0NDLEtBQUssQ0FBQ0MsS0FBTixDQUFhLENBQW1DRixpQ0FBQUEsRUFBQUEsV0FBWSwwQ0FBeUMsSUFBS3BCLENBQUFBLFlBQUwsQ0FBa0JvQixXQUFZLENBQW5JLENBQUEsQ0FBQSxDQUFBO0FBR0FBLFFBQUFBLFdBQVcsR0FBRyxJQUFBLENBQUtwQixZQUFMLENBQWtCb0IsV0FBaEMsQ0FBQTtBQUNILE9BQUE7O0FBRUQsTUFBQSxNQUFNaEMsYUFBYSxHQUFHa0IsT0FBTyxDQUFDbEIsYUFBOUIsQ0FBQTs7QUFHQSxNQUFBLElBQUksS0FBS1ksWUFBTCxDQUFrQkUsU0FBbEIsRUFBQSxDQUE4QmIsV0FBbEMsRUFBK0M7UUFDM0MsSUFBSTFCLEtBQUssR0FBRyxDQUFaLENBQUE7O1FBQ0EsS0FBSyxJQUFJNEMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR2EsV0FBcEIsRUFBaUNiLENBQUMsRUFBbEMsRUFBc0M7VUFDbENELE9BQU8sQ0FBQ1QsWUFBUixDQUFxQmxDLEtBQXJCLEVBQTRCd0QsSUFBNUIsRUFBa0NaLENBQUMsR0FBR25CLGFBQXRDLENBQUEsQ0FBQTtVQUNBekIsS0FBSyxJQUFJMkMsT0FBTyxDQUFDYixNQUFqQixDQUFBO0FBQ0gsU0FBQTtBQUNKLE9BTkQsTUFNTztBQUdILFFBQUEsSUFBSTBCLElBQUksQ0FBQ1YsTUFBTCxHQUFjVyxXQUFXLEdBQUdoQyxhQUFoQyxFQUErQztBQUMzQyxVQUFBLE1BQU1tQyxTQUFTLEdBQUdILFdBQVcsR0FBR2hDLGFBQWhDLENBQUE7O0FBR0EsVUFBQSxJQUFJb0MsV0FBVyxDQUFDQyxNQUFaLENBQW1CTixJQUFuQixDQUFKLEVBQThCO1lBQzFCQSxJQUFJLEdBQUdBLElBQUksQ0FBQ08sUUFBTCxDQUFjLENBQWQsRUFBaUJILFNBQWpCLENBQVAsQ0FBQTtBQUNBakIsWUFBQUEsT0FBTyxDQUFDNUMsS0FBUixDQUFjaUMsR0FBZCxDQUFrQndCLElBQWxCLENBQUEsQ0FBQTtBQUNILFdBSEQsTUFHTztZQUVILEtBQUssSUFBSVosQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR2dCLFNBQXBCLEVBQStCaEIsQ0FBQyxFQUFoQyxFQUNJRCxPQUFPLENBQUM1QyxLQUFSLENBQWM2QyxDQUFkLENBQW1CWSxHQUFBQSxJQUFJLENBQUNaLENBQUQsQ0FBdkIsQ0FBQTtBQUNQLFdBQUE7QUFDSixTQVpELE1BWU87QUFFSEQsVUFBQUEsT0FBTyxDQUFDNUMsS0FBUixDQUFjaUMsR0FBZCxDQUFrQndCLElBQWxCLENBQUEsQ0FBQTtBQUNILFNBQUE7QUFDSixPQUFBO0FBQ0osS0FBQTtBQUNKLEdBQUE7O0FBY0RRLEVBQUFBLFFBQVEsQ0FBQ1QsUUFBRCxFQUFXQyxJQUFYLEVBQWlCO0FBQ3JCLElBQUEsTUFBTWIsT0FBTyxHQUFHLElBQUEsQ0FBS0EsT0FBTCxDQUFhWSxRQUFiLENBQWhCLENBQUE7SUFDQSxJQUFJTixLQUFLLEdBQUcsQ0FBWixDQUFBOztBQUNBLElBQUEsSUFBSU4sT0FBSixFQUFhO0FBQ1RNLE1BQUFBLEtBQUssR0FBRyxJQUFBLENBQUtaLFlBQUwsQ0FBa0JvQixXQUExQixDQUFBO0FBQ0EsTUFBQSxJQUFJYixDQUFKLENBQUE7QUFDQSxNQUFBLE1BQU1uQixhQUFhLEdBQUdrQixPQUFPLENBQUNsQixhQUE5QixDQUFBOztBQUVBLE1BQUEsSUFBSSxLQUFLWSxZQUFMLENBQWtCRSxTQUFsQixFQUFBLENBQThCYixXQUFsQyxFQUErQztRQUczQyxJQUFJdUMsS0FBSyxDQUFDQyxPQUFOLENBQWNWLElBQWQsQ0FBSixFQUNJQSxJQUFJLENBQUNWLE1BQUwsR0FBYyxDQUFkLENBQUE7UUFFSkgsT0FBTyxDQUFDM0MsS0FBUixHQUFnQixDQUFoQixDQUFBO1FBQ0EsSUFBSWMsTUFBTSxHQUFHLENBQWIsQ0FBQTs7UUFDQSxLQUFLOEIsQ0FBQyxHQUFHLENBQVQsRUFBWUEsQ0FBQyxHQUFHSyxLQUFoQixFQUF1QkwsQ0FBQyxFQUF4QixFQUE0QjtVQUN4QkQsT0FBTyxDQUFDVixVQUFSLENBQW1CbkIsTUFBbkIsRUFBMkIwQyxJQUEzQixFQUFpQ1osQ0FBQyxHQUFHbkIsYUFBckMsQ0FBQSxDQUFBO1VBQ0FYLE1BQU0sSUFBSTZCLE9BQU8sQ0FBQ2IsTUFBbEIsQ0FBQTtBQUNILFNBQUE7QUFDSixPQVpELE1BWU87QUFDSCxRQUFBLElBQUkrQixXQUFXLENBQUNDLE1BQVosQ0FBbUJOLElBQW5CLENBQUosRUFBOEI7QUFFMUJBLFVBQUFBLElBQUksQ0FBQ3hCLEdBQUwsQ0FBU1csT0FBTyxDQUFDNUMsS0FBakIsQ0FBQSxDQUFBO0FBQ0gsU0FIRCxNQUdPO1VBRUh5RCxJQUFJLENBQUNWLE1BQUwsR0FBYyxDQUFkLENBQUE7QUFDQSxVQUFBLE1BQU1jLFNBQVMsR0FBR1gsS0FBSyxHQUFHeEIsYUFBMUIsQ0FBQTs7VUFDQSxLQUFLbUIsQ0FBQyxHQUFHLENBQVQsRUFBWUEsQ0FBQyxHQUFHZ0IsU0FBaEIsRUFBMkJoQixDQUFDLEVBQTVCLEVBQ0lZLElBQUksQ0FBQ1osQ0FBRCxDQUFKLEdBQVVELE9BQU8sQ0FBQzVDLEtBQVIsQ0FBYzZDLENBQWQsQ0FBVixDQUFBO0FBQ1AsU0FBQTtBQUNKLE9BQUE7QUFDSixLQUFBOztBQUVELElBQUEsT0FBT0ssS0FBUCxDQUFBO0FBQ0gsR0FBQTs7QUFwTGdCOzs7OyJ9
