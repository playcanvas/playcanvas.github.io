/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { path } from '../../core/path.js';
import { Debug } from '../../core/debug.js';
import { Http, http } from '../../platform/net/http.js';
import { GlbModelParser } from '../parsers/glb-model.js';
import { JsonModelParser } from '../parsers/json-model.js';
import { getDefaultMaterial } from '../../scene/materials/default-material.js';

class ModelHandler {

  constructor(app) {
    this.handlerType = "model";
    this._device = app.graphicsDevice;
    this._parsers = [];
    this._defaultMaterial = getDefaultMaterial(this._device);
    this.maxRetries = 0;
    this.addParser(new JsonModelParser(this._device, this._defaultMaterial), function (url, data) {
      return path.getExtension(url) === '.json';
    });
    this.addParser(new GlbModelParser(this._device, this._defaultMaterial), function (url, data) {
      return path.getExtension(url) === '.glb';
    });
  }
  load(url, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }

    const options = {
      retry: this.maxRetries > 0,
      maxRetries: this.maxRetries
    };
    if (url.load.startsWith('blob:') || url.load.startsWith('data:')) {
      if (path.getExtension(url.original).toLowerCase() === '.glb') {
        options.responseType = Http.ResponseType.ARRAY_BUFFER;
      } else {
        options.responseType = Http.ResponseType.JSON;
      }
    }
    http.get(url.load, options, function (err, response) {
      if (!callback) return;
      if (!err) {
        callback(null, response);
      } else {
        callback(`Error loading model: ${url.original} [${err}]`);
      }
    });
  }
  open(url, data) {
    for (let i = 0; i < this._parsers.length; i++) {
      const p = this._parsers[i];
      if (p.decider(url, data)) {
        return p.parser.parse(data);
      }
    }
    Debug.warn('pc.ModelHandler#open: No model parser found for: ' + url);
    return null;
  }
  patch(asset, assets) {
    if (!asset.resource) return;
    const data = asset.data;
    const self = this;
    asset.resource.meshInstances.forEach(function (meshInstance, i) {
      if (data.mapping) {
        const handleMaterial = function handleMaterial(asset) {
          if (asset.resource) {
            meshInstance.material = asset.resource;
          } else {
            asset.once('load', handleMaterial);
            assets.load(asset);
          }
          asset.once('remove', function (asset) {
            if (meshInstance.material === asset.resource) {
              meshInstance.material = self._defaultMaterial;
            }
          });
        };
        if (!data.mapping[i]) {
          meshInstance.material = self._defaultMaterial;
          return;
        }
        const id = data.mapping[i].material;
        const url = data.mapping[i].path;
        let material;
        if (id !== undefined) {
          if (!id) {
            meshInstance.material = self._defaultMaterial;
          } else {
            material = assets.get(id);
            if (material) {
              handleMaterial(material);
            } else {
              assets.once('add:' + id, handleMaterial);
            }
          }
        } else if (url) {
          const path = asset.getAbsoluteUrl(data.mapping[i].path);
          material = assets.getByUrl(path);
          if (material) {
            handleMaterial(material);
          } else {
            assets.once('add:url:' + path, handleMaterial);
          }
        }
      }
    });
  }

  addParser(parser, decider) {
    this._parsers.push({
      parser: parser,
      decider: decider
    });
  }
}

export { ModelHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvaGFuZGxlcnMvbW9kZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGF0aCB9IGZyb20gJy4uLy4uL2NvcmUvcGF0aC5qcyc7XG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG5pbXBvcnQgeyBodHRwLCBIdHRwIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vbmV0L2h0dHAuanMnO1xuXG5pbXBvcnQgeyBHbGJNb2RlbFBhcnNlciB9IGZyb20gJy4uL3BhcnNlcnMvZ2xiLW1vZGVsLmpzJztcbmltcG9ydCB7IEpzb25Nb2RlbFBhcnNlciB9IGZyb20gJy4uL3BhcnNlcnMvanNvbi1tb2RlbC5qcyc7XG5cbmltcG9ydCB7IGdldERlZmF1bHRNYXRlcmlhbCB9IGZyb20gJy4uLy4uL3NjZW5lL21hdGVyaWFscy9kZWZhdWx0LW1hdGVyaWFsLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2ZyYW1ld29yay9hcHAtYmFzZS5qcycpLkFwcEJhc2V9IEFwcEJhc2UgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2hhbmRsZXIuanMnKS5SZXNvdXJjZUhhbmRsZXJ9IFJlc291cmNlSGFuZGxlciAqL1xuXG4vKipcbiAqIENhbGxiYWNrIHVzZWQgYnkge0BsaW5rIE1vZGVsSGFuZGxlciNhZGRQYXJzZXJ9IHRvIGRlY2lkZSBvbiB3aGljaCBwYXJzZXIgdG8gdXNlLlxuICpcbiAqIEBjYWxsYmFjayBBZGRQYXJzZXJDYWxsYmFja1xuICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSByZXNvdXJjZSB1cmwuXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIFRoZSByYXcgbW9kZWwgZGF0YS5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm4gdHJ1ZSBpZiB0aGlzIHBhcnNlciBzaG91bGQgYmUgdXNlZCB0byBwYXJzZSB0aGUgZGF0YSBpbnRvIGFcbiAqIHtAbGluayBNb2RlbH0uXG4gKi9cblxuLyoqXG4gKiBSZXNvdXJjZSBoYW5kbGVyIHVzZWQgZm9yIGxvYWRpbmcge0BsaW5rIE1vZGVsfSByZXNvdXJjZXMuXG4gKlxuICogQGltcGxlbWVudHMge1Jlc291cmNlSGFuZGxlcn1cbiAqL1xuY2xhc3MgTW9kZWxIYW5kbGVyIHtcbiAgICAvKipcbiAgICAgKiBUeXBlIG9mIHRoZSByZXNvdXJjZSB0aGUgaGFuZGxlciBoYW5kbGVzLlxuICAgICAqXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBoYW5kbGVyVHlwZSA9IFwibW9kZWxcIjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBNb2RlbEhhbmRsZXIgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FwcEJhc2V9IGFwcCAtIFRoZSBydW5uaW5nIHtAbGluayBBcHBCYXNlfS5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuX2RldmljZSA9IGFwcC5ncmFwaGljc0RldmljZTtcbiAgICAgICAgdGhpcy5fcGFyc2VycyA9IFtdO1xuICAgICAgICB0aGlzLl9kZWZhdWx0TWF0ZXJpYWwgPSBnZXREZWZhdWx0TWF0ZXJpYWwodGhpcy5fZGV2aWNlKTtcbiAgICAgICAgdGhpcy5tYXhSZXRyaWVzID0gMDtcblxuICAgICAgICB0aGlzLmFkZFBhcnNlcihuZXcgSnNvbk1vZGVsUGFyc2VyKHRoaXMuX2RldmljZSwgdGhpcy5fZGVmYXVsdE1hdGVyaWFsKSwgZnVuY3Rpb24gKHVybCwgZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIChwYXRoLmdldEV4dGVuc2lvbih1cmwpID09PSAnLmpzb24nKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYWRkUGFyc2VyKG5ldyBHbGJNb2RlbFBhcnNlcih0aGlzLl9kZXZpY2UsIHRoaXMuX2RlZmF1bHRNYXRlcmlhbCksIGZ1bmN0aW9uICh1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAocGF0aC5nZXRFeHRlbnNpb24odXJsKSA9PT0gJy5nbGInKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9hZCh1cmwsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdXJsID0ge1xuICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gd2UgbmVlZCB0byBzcGVjaWZ5IEpTT04gZm9yIGJsb2IgVVJMc1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgcmV0cnk6IHRoaXMubWF4UmV0cmllcyA+IDAsXG4gICAgICAgICAgICBtYXhSZXRyaWVzOiB0aGlzLm1heFJldHJpZXNcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodXJsLmxvYWQuc3RhcnRzV2l0aCgnYmxvYjonKSB8fCB1cmwubG9hZC5zdGFydHNXaXRoKCdkYXRhOicpKSB7XG4gICAgICAgICAgICBpZiAocGF0aC5nZXRFeHRlbnNpb24odXJsLm9yaWdpbmFsKS50b0xvd2VyQ2FzZSgpID09PSAnLmdsYicpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnJlc3BvbnNlVHlwZSA9IEh0dHAuUmVzcG9uc2VUeXBlLkFSUkFZX0JVRkZFUjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5yZXNwb25zZVR5cGUgPSBIdHRwLlJlc3BvbnNlVHlwZS5KU09OO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaHR0cC5nZXQodXJsLmxvYWQsIG9wdGlvbnMsIGZ1bmN0aW9uIChlcnIsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAoIWNhbGxiYWNrKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGBFcnJvciBsb2FkaW5nIG1vZGVsOiAke3VybC5vcmlnaW5hbH0gWyR7ZXJyfV1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb3Blbih1cmwsIGRhdGEpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9wYXJzZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwID0gdGhpcy5fcGFyc2Vyc1tpXTtcblxuICAgICAgICAgICAgaWYgKHAuZGVjaWRlcih1cmwsIGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHAucGFyc2VyLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIERlYnVnLndhcm4oJ3BjLk1vZGVsSGFuZGxlciNvcGVuOiBObyBtb2RlbCBwYXJzZXIgZm91bmQgZm9yOiAnICsgdXJsKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcGF0Y2goYXNzZXQsIGFzc2V0cykge1xuICAgICAgICBpZiAoIWFzc2V0LnJlc291cmNlKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhc3NldC5kYXRhO1xuXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgICBhc3NldC5yZXNvdXJjZS5tZXNoSW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24gKG1lc2hJbnN0YW5jZSwgaSkge1xuICAgICAgICAgICAgaWYgKGRhdGEubWFwcGluZykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZU1hdGVyaWFsID0gZnVuY3Rpb24gKGFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldC5yZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlLm1hdGVyaWFsID0gYXNzZXQucmVzb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldC5vbmNlKCdsb2FkJywgaGFuZGxlTWF0ZXJpYWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzLmxvYWQoYXNzZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYXNzZXQub25jZSgncmVtb3ZlJywgZnVuY3Rpb24gKGFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzaEluc3RhbmNlLm1hdGVyaWFsID09PSBhc3NldC5yZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2hJbnN0YW5jZS5tYXRlcmlhbCA9IHNlbGYuX2RlZmF1bHRNYXRlcmlhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICghZGF0YS5tYXBwaW5nW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lc2hJbnN0YW5jZS5tYXRlcmlhbCA9IHNlbGYuX2RlZmF1bHRNYXRlcmlhbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gZGF0YS5tYXBwaW5nW2ldLm1hdGVyaWFsO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IGRhdGEubWFwcGluZ1tpXS5wYXRoO1xuICAgICAgICAgICAgICAgIGxldCBtYXRlcmlhbDtcblxuICAgICAgICAgICAgICAgIGlmIChpZCAhPT0gdW5kZWZpbmVkKSB7IC8vIGlkIG1hcHBpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlLm1hdGVyaWFsID0gc2VsZi5fZGVmYXVsdE1hdGVyaWFsO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0ZXJpYWwgPSBhc3NldHMuZ2V0KGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRlcmlhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZU1hdGVyaWFsKG1hdGVyaWFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzLm9uY2UoJ2FkZDonICsgaWQsIGhhbmRsZU1hdGVyaWFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVybCBtYXBwaW5nXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSBhc3NldC5nZXRBYnNvbHV0ZVVybChkYXRhLm1hcHBpbmdbaV0ucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsID0gYXNzZXRzLmdldEJ5VXJsKHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRlcmlhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlTWF0ZXJpYWwobWF0ZXJpYWwpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRzLm9uY2UoJ2FkZDp1cmw6JyArIHBhdGgsIGhhbmRsZU1hdGVyaWFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgcGFyc2VyIHRoYXQgY29udmVydHMgcmF3IGRhdGEgaW50byBhIHtAbGluayBNb2RlbH0uIERlZmF1bHQgcGFyc2VyIGlzIGZvciBKU09OIG1vZGVscy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBwYXJzZXIgLSBTZWUgSnNvbk1vZGVsUGFyc2VyIGZvciBleGFtcGxlLlxuICAgICAqIEBwYXJhbSB7QWRkUGFyc2VyQ2FsbGJhY2t9IGRlY2lkZXIgLSBGdW5jdGlvbiB0aGF0IGRlY2lkZXMgb24gd2hpY2ggcGFyc2VyIHRvIHVzZS4gRnVuY3Rpb25cbiAgICAgKiBzaG91bGQgdGFrZSAodXJsLCBkYXRhKSBhcmd1bWVudHMgYW5kIHJldHVybiB0cnVlIGlmIHRoaXMgcGFyc2VyIHNob3VsZCBiZSB1c2VkIHRvIHBhcnNlIHRoZVxuICAgICAqIGRhdGEgaW50byBhIHtAbGluayBNb2RlbH0uIFRoZSBmaXJzdCBwYXJzZXIgdG8gcmV0dXJuIHRydWUgaXMgdXNlZC5cbiAgICAgKi9cbiAgICBhZGRQYXJzZXIocGFyc2VyLCBkZWNpZGVyKSB7XG4gICAgICAgIHRoaXMuX3BhcnNlcnMucHVzaCh7XG4gICAgICAgICAgICBwYXJzZXI6IHBhcnNlcixcbiAgICAgICAgICAgIGRlY2lkZXI6IGRlY2lkZXJcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBNb2RlbEhhbmRsZXIgfTtcbiJdLCJuYW1lcyI6WyJNb2RlbEhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsImFwcCIsImhhbmRsZXJUeXBlIiwiX2RldmljZSIsImdyYXBoaWNzRGV2aWNlIiwiX3BhcnNlcnMiLCJfZGVmYXVsdE1hdGVyaWFsIiwiZ2V0RGVmYXVsdE1hdGVyaWFsIiwibWF4UmV0cmllcyIsImFkZFBhcnNlciIsIkpzb25Nb2RlbFBhcnNlciIsInVybCIsImRhdGEiLCJwYXRoIiwiZ2V0RXh0ZW5zaW9uIiwiR2xiTW9kZWxQYXJzZXIiLCJsb2FkIiwiY2FsbGJhY2siLCJvcmlnaW5hbCIsIm9wdGlvbnMiLCJyZXRyeSIsInN0YXJ0c1dpdGgiLCJ0b0xvd2VyQ2FzZSIsInJlc3BvbnNlVHlwZSIsIkh0dHAiLCJSZXNwb25zZVR5cGUiLCJBUlJBWV9CVUZGRVIiLCJKU09OIiwiaHR0cCIsImdldCIsImVyciIsInJlc3BvbnNlIiwib3BlbiIsImkiLCJsZW5ndGgiLCJwIiwiZGVjaWRlciIsInBhcnNlciIsInBhcnNlIiwiRGVidWciLCJ3YXJuIiwicGF0Y2giLCJhc3NldCIsImFzc2V0cyIsInJlc291cmNlIiwic2VsZiIsIm1lc2hJbnN0YW5jZXMiLCJmb3JFYWNoIiwibWVzaEluc3RhbmNlIiwibWFwcGluZyIsImhhbmRsZU1hdGVyaWFsIiwibWF0ZXJpYWwiLCJvbmNlIiwiaWQiLCJ1bmRlZmluZWQiLCJnZXRBYnNvbHV0ZVVybCIsImdldEJ5VXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBNEJBLE1BQU1BLFlBQVksQ0FBQzs7RUFjZkMsV0FBVyxDQUFDQyxHQUFHLEVBQUU7SUFBQSxJQVJqQkMsQ0FBQUEsV0FBVyxHQUFHLE9BQU8sQ0FBQTtBQVNqQixJQUFBLElBQUksQ0FBQ0MsT0FBTyxHQUFHRixHQUFHLENBQUNHLGNBQWMsQ0FBQTtJQUNqQyxJQUFJLENBQUNDLFFBQVEsR0FBRyxFQUFFLENBQUE7SUFDbEIsSUFBSSxDQUFDQyxnQkFBZ0IsR0FBR0Msa0JBQWtCLENBQUMsSUFBSSxDQUFDSixPQUFPLENBQUMsQ0FBQTtJQUN4RCxJQUFJLENBQUNLLFVBQVUsR0FBRyxDQUFDLENBQUE7QUFFbkIsSUFBQSxJQUFJLENBQUNDLFNBQVMsQ0FBQyxJQUFJQyxlQUFlLENBQUMsSUFBSSxDQUFDUCxPQUFPLEVBQUUsSUFBSSxDQUFDRyxnQkFBZ0IsQ0FBQyxFQUFFLFVBQVVLLEdBQUcsRUFBRUMsSUFBSSxFQUFFO0FBQzFGLE1BQUEsT0FBUUMsSUFBSSxDQUFDQyxZQUFZLENBQUNILEdBQUcsQ0FBQyxLQUFLLE9BQU8sQ0FBQTtBQUM5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
