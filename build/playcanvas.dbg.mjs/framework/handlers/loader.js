/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../../core/debug.js';

class ResourceLoader {
  constructor(app) {
    this._handlers = {};
    this._requests = {};
    this._cache = {};
    this._app = app;
  }

  addHandler(type, handler) {
    this._handlers[type] = handler;
    handler._loader = this;
  }

  removeHandler(type) {
    delete this._handlers[type];
  }

  getHandler(type) {
    return this._handlers[type];
  }

  load(url, type, callback, asset) {
    const handler = this._handlers[type];
    if (!handler) {
      const err = `No resource handler for asset type: '${type}' when loading [${url}]`;
      Debug.warnOnce(err);
      callback(err);
      return;
    }

    if (!url) {
      this._loadNull(handler, callback, asset);
      return;
    }
    const key = url + type;
    if (this._cache[key] !== undefined) {
      callback(null, this._cache[key]);
    } else if (this._requests[key]) {
      this._requests[key].push(callback);
    } else {
      this._requests[key] = [callback];
      const self = this;
      const handleLoad = function handleLoad(err, urlObj) {
        if (err) {
          self._onFailure(key, err);
          return;
        }
        handler.load(urlObj, function (err, data, extra) {
          if (!self._requests[key]) {
            return;
          }
          if (err) {
            self._onFailure(key, err);
            return;
          }
          try {
            self._onSuccess(key, handler.open(urlObj.original, data, asset), extra);
          } catch (e) {
            self._onFailure(key, e);
          }
        }, asset);
      };
      const normalizedUrl = url.split('?')[0];
      if (this._app.enableBundles && this._app.bundles.hasUrl(normalizedUrl)) {
        if (!this._app.bundles.canLoadUrl(normalizedUrl)) {
          handleLoad(`Bundle for ${url} not loaded yet`);
          return;
        }
        this._app.bundles.loadUrl(normalizedUrl, function (err, fileUrlFromBundle) {
          handleLoad(err, {
            load: fileUrlFromBundle,
            original: normalizedUrl
          });
        });
      } else {
        handleLoad(null, {
          load: url,
          original: asset && asset.file.filename || url
        });
      }
    }
  }

  _loadNull(handler, callback, asset) {
    const onLoad = function onLoad(err, data, extra) {
      if (err) {
        callback(err);
      } else {
        try {
          callback(null, handler.open(null, data, asset), extra);
        } catch (e) {
          callback(e);
        }
      }
    };
    handler.load(null, onLoad, asset);
  }
  _onSuccess(key, result, extra) {
    this._cache[key] = result;
    for (let i = 0; i < this._requests[key].length; i++) {
      this._requests[key][i](null, result, extra);
    }
    delete this._requests[key];
  }
  _onFailure(key, err) {
    console.error(err);
    if (this._requests[key]) {
      for (let i = 0; i < this._requests[key].length; i++) {
        this._requests[key][i](err);
      }
      delete this._requests[key];
    }
  }

  open(type, data) {
    const handler = this._handlers[type];
    if (!handler) {
      console.warn('No resource handler found for: ' + type);
      return data;
    }
    return handler.open(null, data);
  }

  patch(asset, assets) {
    const handler = this._handlers[asset.type];
    if (!handler) {
      console.warn('No resource handler found for: ' + asset.type);
      return;
    }
    if (handler.patch) {
      handler.patch(asset, assets);
    }
  }

  clearCache(url, type) {
    delete this._cache[url + type];
  }

  getFromCache(url, type) {
    if (this._cache[url + type]) {
      return this._cache[url + type];
    }
    return undefined;
  }

  enableRetry(maxRetries = 5) {
    maxRetries = Math.max(0, maxRetries) || 0;
    for (const key in this._handlers) {
      this._handlers[key].maxRetries = maxRetries;
    }
  }

  disableRetry() {
    for (const key in this._handlers) {
      this._handlers[key].maxRetries = 0;
    }
  }

  destroy() {
    this._handlers = {};
    this._requests = {};
    this._cache = {};
  }
}

export { ResourceLoader };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZGVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2hhbmRsZXJzL2xvYWRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vZnJhbWV3b3JrL2Fzc2V0L2Fzc2V0LmpzJykuQXNzZXR9IEFzc2V0ICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vZnJhbWV3b3JrL2Fzc2V0L2Fzc2V0LXJlZ2lzdHJ5LmpzJykuQXNzZXRSZWdpc3RyeX0gQXNzZXRSZWdpc3RyeSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2ZyYW1ld29yay9hcHAtYmFzZS5qcycpLkFwcEJhc2V9IEFwcEJhc2UgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2hhbmRsZXIuanMnKS5SZXNvdXJjZUhhbmRsZXJ9IFJlc291cmNlSGFuZGxlciAqL1xuXG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG4vKipcbiAqIENhbGxiYWNrIHVzZWQgYnkge0BsaW5rIFJlc291cmNlTG9hZGVyI2xvYWR9IHdoZW4gYSByZXNvdXJjZSBpcyBsb2FkZWQgKG9yIGFuIGVycm9yIG9jY3VycykuXG4gKlxuICogQGNhbGxiYWNrIFJlc291cmNlTG9hZGVyQ2FsbGJhY2tcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IGVyciAtIFRoZSBlcnJvciBtZXNzYWdlIGluIHRoZSBjYXNlIHdoZXJlIHRoZSBsb2FkIGZhaWxzLlxuICogQHBhcmFtIHsqfSBbcmVzb3VyY2VdIC0gVGhlIHJlc291cmNlIHRoYXQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGxvYWRlZC5cbiAqL1xuXG4vKipcbiAqIExvYWQgcmVzb3VyY2UgZGF0YSwgcG90ZW50aWFsbHkgZnJvbSByZW1vdGUgc291cmNlcy4gQ2FjaGVzIHJlc291cmNlIG9uIGxvYWQgdG8gcHJldmVudCBtdWx0aXBsZVxuICogcmVxdWVzdHMuIEFkZCBSZXNvdXJjZUhhbmRsZXJzIHRvIGhhbmRsZSBkaWZmZXJlbnQgdHlwZXMgb2YgcmVzb3VyY2VzLlxuICovXG5jbGFzcyBSZXNvdXJjZUxvYWRlciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFJlc291cmNlTG9hZGVyIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcHBCYXNlfSBhcHAgLSBUaGUgYXBwbGljYXRpb24uXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0ge307XG4gICAgICAgIHRoaXMuX3JlcXVlc3RzID0ge307XG4gICAgICAgIHRoaXMuX2NhY2hlID0ge307XG4gICAgICAgIHRoaXMuX2FwcCA9IGFwcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB7QGxpbmsgUmVzb3VyY2VIYW5kbGVyfSBmb3IgYSByZXNvdXJjZSB0eXBlLiBIYW5kbGVyIHNob3VsZCBzdXBwb3J0IGF0IGxlYXN0IGBsb2FkKClgXG4gICAgICogYW5kIGBvcGVuKClgLiBIYW5kbGVycyBjYW4gb3B0aW9uYWxseSBzdXBwb3J0IHBhdGNoKGFzc2V0LCBhc3NldHMpIHRvIGhhbmRsZSBkZXBlbmRlbmNpZXMgb25cbiAgICAgKiBvdGhlciBhc3NldHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSBuYW1lIG9mIHRoZSByZXNvdXJjZSB0eXBlIHRoYXQgdGhlIGhhbmRsZXIgd2lsbCBiZSByZWdpc3RlcmVkXG4gICAgICogd2l0aC4gQ2FuIGJlOlxuICAgICAqXG4gICAgICogLSB7QGxpbmsgQVNTRVRfQU5JTUFUSU9OfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX0FVRElPfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX0lNQUdFfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX0pTT059XG4gICAgICogLSB7QGxpbmsgQVNTRVRfTU9ERUx9XG4gICAgICogLSB7QGxpbmsgQVNTRVRfTUFURVJJQUx9XG4gICAgICogLSB7QGxpbmsgQVNTRVRfVEVYVH1cbiAgICAgKiAtIHtAbGluayBBU1NFVF9URVhUVVJFfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX0NVQkVNQVB9XG4gICAgICogLSB7QGxpbmsgQVNTRVRfU0hBREVSfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX0NTU31cbiAgICAgKiAtIHtAbGluayBBU1NFVF9IVE1MfVxuICAgICAqIC0ge0BsaW5rIEFTU0VUX1NDUklQVH1cbiAgICAgKiAtIHtAbGluayBBU1NFVF9DT05UQUlORVJ9XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlSGFuZGxlcn0gaGFuZGxlciAtIEFuIGluc3RhbmNlIG9mIGEgcmVzb3VyY2UgaGFuZGxlciBzdXBwb3J0aW5nIGF0IGxlYXN0XG4gICAgICogYGxvYWQoKWAgYW5kIGBvcGVuKClgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGxvYWRlciA9IG5ldyBSZXNvdXJjZUxvYWRlcigpO1xuICAgICAqIGxvYWRlci5hZGRIYW5kbGVyKFwianNvblwiLCBuZXcgcGMuSnNvbkhhbmRsZXIoKSk7XG4gICAgICovXG4gICAgYWRkSGFuZGxlcih0eXBlLCBoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZXJzW3R5cGVdID0gaGFuZGxlcjtcbiAgICAgICAgaGFuZGxlci5fbG9hZGVyID0gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSB7QGxpbmsgUmVzb3VyY2VIYW5kbGVyfSBmb3IgYSByZXNvdXJjZSB0eXBlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBUaGUgbmFtZSBvZiB0aGUgdHlwZSB0aGF0IHRoZSBoYW5kbGVyIHdpbGwgYmUgcmVtb3ZlZC5cbiAgICAgKi9cbiAgICByZW1vdmVIYW5kbGVyKHR5cGUpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2hhbmRsZXJzW3R5cGVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIHtAbGluayBSZXNvdXJjZUhhbmRsZXJ9IGZvciBhIHJlc291cmNlIHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSBuYW1lIG9mIHRoZSByZXNvdXJjZSB0eXBlIHRoYXQgdGhlIGhhbmRsZXIgaXMgcmVnaXN0ZXJlZCB3aXRoLlxuICAgICAqIEByZXR1cm5zIHtSZXNvdXJjZUhhbmRsZXJ9IFRoZSByZWdpc3RlcmVkIGhhbmRsZXIuXG4gICAgICovXG4gICAgZ2V0SGFuZGxlcih0eXBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVyc1t0eXBlXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYWtlIGEgcmVxdWVzdCBmb3IgYSByZXNvdXJjZSBmcm9tIGEgcmVtb3RlIFVSTC4gUGFyc2UgdGhlIHJldHVybmVkIGRhdGEgdXNpbmcgdGhlIGhhbmRsZXJcbiAgICAgKiBmb3IgdGhlIHNwZWNpZmllZCB0eXBlLiBXaGVuIGxvYWRlZCBhbmQgcGFyc2VkLCB1c2UgdGhlIGNhbGxiYWNrIHRvIHJldHVybiBhbiBpbnN0YW5jZSBvZlxuICAgICAqIHRoZSByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgVVJMIG9mIHRoZSByZXNvdXJjZSB0byBsb2FkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gVGhlIHR5cGUgb2YgcmVzb3VyY2UgZXhwZWN0ZWQuXG4gICAgICogQHBhcmFtIHtSZXNvdXJjZUxvYWRlckNhbGxiYWNrfSBjYWxsYmFjayAtIFRoZSBjYWxsYmFjayB1c2VkIHdoZW4gdGhlIHJlc291cmNlIGlzIGxvYWRlZCBvclxuICAgICAqIGFuIGVycm9yIG9jY3Vycy4gUGFzc2VkIChlcnIsIHJlc291cmNlKSB3aGVyZSBlcnIgaXMgbnVsbCBpZiB0aGVyZSBhcmUgbm8gZXJyb3JzLlxuICAgICAqIEBwYXJhbSB7QXNzZXR9IFthc3NldF0gLSBPcHRpb25hbCBhc3NldCB0aGF0IGlzIHBhc3NlZCBpbnRvIGhhbmRsZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGFwcC5sb2FkZXIubG9hZChcIi4uL3BhdGgvdG8vdGV4dHVyZS5wbmdcIiwgXCJ0ZXh0dXJlXCIsIGZ1bmN0aW9uIChlcnIsIHRleHR1cmUpIHtcbiAgICAgKiAgICAgLy8gdXNlIHRleHR1cmUgaGVyZVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGxvYWQodXJsLCB0eXBlLCBjYWxsYmFjaywgYXNzZXQpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXJzW3R5cGVdO1xuICAgICAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGVyciA9IGBObyByZXNvdXJjZSBoYW5kbGVyIGZvciBhc3NldCB0eXBlOiAnJHt0eXBlfScgd2hlbiBsb2FkaW5nIFske3VybH1dYDtcbiAgICAgICAgICAgIERlYnVnLndhcm5PbmNlKGVycik7XG4gICAgICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaGFuZGxlIHJlcXVlc3RzIHdpdGggbnVsbCBmaWxlXG4gICAgICAgIGlmICghdXJsKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2FkTnVsbChoYW5kbGVyLCBjYWxsYmFjaywgYXNzZXQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qga2V5ID0gdXJsICsgdHlwZTtcblxuICAgICAgICBpZiAodGhpcy5fY2FjaGVba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBpbiBjYWNoZVxuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgdGhpcy5fY2FjaGVba2V5XSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fcmVxdWVzdHNba2V5XSkge1xuICAgICAgICAgICAgLy8gZXhpc3RpbmcgcmVxdWVzdFxuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdHNba2V5XS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG5ldyByZXF1ZXN0XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0c1trZXldID0gW2NhbGxiYWNrXTtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZUxvYWQgPSBmdW5jdGlvbiAoZXJyLCB1cmxPYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX29uRmFpbHVyZShrZXksIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBoYW5kbGVyLmxvYWQodXJsT2JqLCBmdW5jdGlvbiAoZXJyLCBkYXRhLCBleHRyYSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUga2V5IGV4aXN0cyBiZWNhdXNlIGxvYWRlclxuICAgICAgICAgICAgICAgICAgICAvLyBtaWdodCBoYXZlIGJlZW4gZGVzdHJveWVkIGJ5IG5vd1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuX3JlcXVlc3RzW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX29uRmFpbHVyZShrZXksIGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fb25TdWNjZXNzKGtleSwgaGFuZGxlci5vcGVuKHVybE9iai5vcmlnaW5hbCwgZGF0YSwgYXNzZXQpLCBleHRyYSk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX29uRmFpbHVyZShrZXksIGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgYXNzZXQpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZFVybCA9IHVybC5zcGxpdCgnPycpWzBdO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2FwcC5lbmFibGVCdW5kbGVzICYmIHRoaXMuX2FwcC5idW5kbGVzLmhhc1VybChub3JtYWxpemVkVXJsKSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYXBwLmJ1bmRsZXMuY2FuTG9hZFVybChub3JtYWxpemVkVXJsKSkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVMb2FkKGBCdW5kbGUgZm9yICR7dXJsfSBub3QgbG9hZGVkIHlldGApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fYXBwLmJ1bmRsZXMubG9hZFVybChub3JtYWxpemVkVXJsLCBmdW5jdGlvbiAoZXJyLCBmaWxlVXJsRnJvbUJ1bmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVMb2FkKGVyciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZDogZmlsZVVybEZyb21CdW5kbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbDogbm9ybWFsaXplZFVybFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlTG9hZChudWxsLCB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWw6IGFzc2V0ICYmIGFzc2V0LmZpbGUuZmlsZW5hbWUgfHwgdXJsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBsb2FkIGFuIGFzc2V0IHdpdGggbm8gdXJsLCBza2lwcGluZyBidW5kbGVzIGFuZCBjYWNoaW5nXG4gICAgX2xvYWROdWxsKGhhbmRsZXIsIGNhbGxiYWNrLCBhc3NldCkge1xuICAgICAgICBjb25zdCBvbkxvYWQgPSBmdW5jdGlvbiAoZXJyLCBkYXRhLCBleHRyYSkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGhhbmRsZXIub3BlbihudWxsLCBkYXRhLCBhc3NldCksIGV4dHJhKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaGFuZGxlci5sb2FkKG51bGwsIG9uTG9hZCwgYXNzZXQpO1xuICAgIH1cblxuICAgIF9vblN1Y2Nlc3Moa2V5LCByZXN1bHQsIGV4dHJhKSB7XG4gICAgICAgIHRoaXMuX2NhY2hlW2tleV0gPSByZXN1bHQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fcmVxdWVzdHNba2V5XS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdHNba2V5XVtpXShudWxsLCByZXN1bHQsIGV4dHJhKTtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5fcmVxdWVzdHNba2V5XTtcbiAgICB9XG5cbiAgICBfb25GYWlsdXJlKGtleSwgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RzW2tleV0pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fcmVxdWVzdHNba2V5XS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RzW2tleV1baV0oZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yZXF1ZXN0c1trZXldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydCByYXcgcmVzb3VyY2UgZGF0YSBpbnRvIGEgcmVzb3VyY2UgaW5zdGFuY2UuIEUuZy4gVGFrZSAzRCBtb2RlbCBmb3JtYXQgSlNPTiBhbmRcbiAgICAgKiByZXR1cm4gYSB7QGxpbmsgTW9kZWx9LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBUaGUgdHlwZSBvZiByZXNvdXJjZS5cbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgLSBUaGUgcmF3IHJlc291cmNlIGRhdGEuXG4gICAgICogQHJldHVybnMgeyp9IFRoZSBwYXJzZWQgcmVzb3VyY2UgZGF0YS5cbiAgICAgKi9cbiAgICBvcGVuKHR5cGUsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXJzW3R5cGVdO1xuICAgICAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignTm8gcmVzb3VyY2UgaGFuZGxlciBmb3VuZCBmb3I6ICcgKyB0eXBlKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGhhbmRsZXIub3BlbihudWxsLCBkYXRhKTtcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gYW55IG9wZXJhdGlvbnMgb24gYSByZXNvdXJjZSwgdGhhdCByZXF1aXJlcyBhIGRlcGVuZGVuY3kgb24gaXRzIGFzc2V0IGRhdGEgb3IgYW55XG4gICAgICogb3RoZXIgYXNzZXQgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXNzZXR9IGFzc2V0IC0gVGhlIGFzc2V0IHRvIHBhdGNoLlxuICAgICAqIEBwYXJhbSB7QXNzZXRSZWdpc3RyeX0gYXNzZXRzIC0gVGhlIGFzc2V0IHJlZ2lzdHJ5LlxuICAgICAqL1xuICAgIHBhdGNoKGFzc2V0LCBhc3NldHMpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlciA9IHRoaXMuX2hhbmRsZXJzW2Fzc2V0LnR5cGVdO1xuICAgICAgICBpZiAoIWhhbmRsZXIpICB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ05vIHJlc291cmNlIGhhbmRsZXIgZm91bmQgZm9yOiAnICsgYXNzZXQudHlwZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGFuZGxlci5wYXRjaCkge1xuICAgICAgICAgICAgaGFuZGxlci5wYXRjaChhc3NldCwgYXNzZXRzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSByZXNvdXJjZSBmcm9tIGNhY2hlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSBVUkwgb2YgdGhlIHJlc291cmNlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gVGhlIHR5cGUgb2YgcmVzb3VyY2UuXG4gICAgICovXG4gICAgY2xlYXJDYWNoZSh1cmwsIHR5cGUpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2NhY2hlW3VybCArIHR5cGVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGNhY2hlIGZvciByZXNvdXJjZSBmcm9tIGEgVVJMLiBJZiBwcmVzZW50LCByZXR1cm4gdGhlIGNhY2hlZCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgVVJMIG9mIHRoZSByZXNvdXJjZSB0byBnZXQgZnJvbSB0aGUgY2FjaGUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBUaGUgdHlwZSBvZiB0aGUgcmVzb3VyY2UuXG4gICAgICogQHJldHVybnMgeyp9IFRoZSByZXNvdXJjZSBsb2FkZWQgZnJvbSB0aGUgY2FjaGUuXG4gICAgICovXG4gICAgZ2V0RnJvbUNhY2hlKHVybCwgdHlwZSkge1xuICAgICAgICBpZiAodGhpcy5fY2FjaGVbdXJsICsgdHlwZV0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZVt1cmwgKyB0eXBlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgcmV0cnlpbmcgb2YgZmFpbGVkIHJlcXVlc3RzIHdoZW4gbG9hZGluZyBhc3NldHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWF4UmV0cmllcyAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiB0aW1lcyB0byByZXRyeSBsb2FkaW5nIGFuIGFzc2V0LiBEZWZhdWx0c1xuICAgICAqIHRvIDUuXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGVuYWJsZVJldHJ5KG1heFJldHJpZXMgPSA1KSB7XG4gICAgICAgIG1heFJldHJpZXMgPSBNYXRoLm1heCgwLCBtYXhSZXRyaWVzKSB8fCAwO1xuXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX2hhbmRsZXJzKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyc1trZXldLm1heFJldHJpZXMgPSBtYXhSZXRyaWVzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzYWJsZXMgcmV0cnlpbmcgb2YgZmFpbGVkIHJlcXVlc3RzIHdoZW4gbG9hZGluZyBhc3NldHMuXG4gICAgICpcbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgZGlzYWJsZVJldHJ5KCkge1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLl9oYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlcnNba2V5XS5tYXhSZXRyaWVzID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSByZXNvdXJjZSBsb2FkZXIuXG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7fTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdHMgPSB7fTtcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IFJlc291cmNlTG9hZGVyIH07XG4iXSwibmFtZXMiOlsiUmVzb3VyY2VMb2FkZXIiLCJjb25zdHJ1Y3RvciIsImFwcCIsIl9oYW5kbGVycyIsIl9yZXF1ZXN0cyIsIl9jYWNoZSIsIl9hcHAiLCJhZGRIYW5kbGVyIiwidHlwZSIsImhhbmRsZXIiLCJfbG9hZGVyIiwicmVtb3ZlSGFuZGxlciIsImdldEhhbmRsZXIiLCJsb2FkIiwidXJsIiwiY2FsbGJhY2siLCJhc3NldCIsImVyciIsIkRlYnVnIiwid2Fybk9uY2UiLCJfbG9hZE51bGwiLCJrZXkiLCJ1bmRlZmluZWQiLCJwdXNoIiwic2VsZiIsImhhbmRsZUxvYWQiLCJ1cmxPYmoiLCJfb25GYWlsdXJlIiwiZGF0YSIsImV4dHJhIiwiX29uU3VjY2VzcyIsIm9wZW4iLCJvcmlnaW5hbCIsImUiLCJub3JtYWxpemVkVXJsIiwic3BsaXQiLCJlbmFibGVCdW5kbGVzIiwiYnVuZGxlcyIsImhhc1VybCIsImNhbkxvYWRVcmwiLCJsb2FkVXJsIiwiZmlsZVVybEZyb21CdW5kbGUiLCJmaWxlIiwiZmlsZW5hbWUiLCJvbkxvYWQiLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwiY29uc29sZSIsImVycm9yIiwid2FybiIsInBhdGNoIiwiYXNzZXRzIiwiY2xlYXJDYWNoZSIsImdldEZyb21DYWNoZSIsImVuYWJsZVJldHJ5IiwibWF4UmV0cmllcyIsIk1hdGgiLCJtYXgiLCJkaXNhYmxlUmV0cnkiLCJkZXN0cm95Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBbUJBLE1BQU1BLGNBQWMsQ0FBQztF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
