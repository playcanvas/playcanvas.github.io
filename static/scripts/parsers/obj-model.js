function ObjModelParser(e){this._device=e,this._defaultMaterial=new pc.StandardMaterial}Object.assign(ObjModelParser.prototype,{parse:function(e){var s,r={default:{verts:[],normals:[],uvs:[],indices:[]}},t="default",a=e.split("\n"),n=[],l=[],h=[];for(s=0;s<a.length;s++){var o=a[s].trim(),p=o.split(/\s+/);if("v"===o[0])"v"===p[0]?n.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])):"vn"===p[0]?l.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])):"vt"===p[0]&&h.push(parseFloat(p[1]),parseFloat(p[2]));else if("g"===o[0]||"o"===o[0]||"u"===o[0])r[t=p[1]]||(r[t]={verts:[],normals:[],uvs:[]});else if("f"===o[0]){var i,v;if(4===p.length)for(i=1;i<p.length;i++)v=this._parseIndices(p[i]),r[t].verts.push(n[3*v[0]],n[3*v[0]+1],n[3*v[0]+2]),2*v[1]<h.length&&r[t].uvs.push(h[2*v[1]],h[2*v[1]+1]),3*v[2]<l.length&&r[t].normals.push(l[3*v[2]],l[3*v[2]+1],l[3*v[2]+2]);else if(5===p.length){var u=[1,2,3,3,4,1];i=1;for(var c=0;c<u.length;c++)i=u[c],v=this._parseIndices(p[i]),r[t].verts.push(n[3*v[0]],n[3*v[0]+1],n[3*v[0]+2]),2*v[1]<h.length&&r[t].uvs.push(h[2*v[1]],h[2*v[1]+1]),3*v[2]<l.length&&r[t].normals.push(l[3*v[2]],l[3*v[2]+1],l[3*v[2]+2])}else console.error(pc.string.format("OBJ uses unsupported {0}-gons",p.length-1))}}var d=new pc.Model,g=Object.keys(r),f=new pc.GraphNode;for(s=0;s<g.length;s++){var m=r[g[s]];if(m.verts.length){m.verts.length>65535&&console.warn("Warning: mesh with more than 65535 vertices");var F={};m.normals.length>0&&(F.normals=m.normals),m.uvs.length>0&&(F.uvs=m.uvs);var M=pc.createMesh(this._device,m.verts,F),w=new pc.MeshInstance(M,this._defaultMaterial,new pc.GraphNode);d.meshInstances.push(w),f.addChild(w.node)}}return d.graph=f,d.getGraph().syncHierarchy(),d},_parseIndices:function(e){for(var s=[],r=e.split("/"),t=0;t<3;t++)r[t]&&(s[t]=parseInt(r[t],10)-1);return s}});