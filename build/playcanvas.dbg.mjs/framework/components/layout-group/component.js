/**
 * @license
 * PlayCanvas Engine v1.58.0-preview revision 1fec26519 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Vec2 } from '../../../core/math/vec2.js';
import { Vec4 } from '../../../core/math/vec4.js';
import { ORIENTATION_HORIZONTAL } from '../../../scene/constants.js';
import { FITTING_NONE } from './constants.js';
import { Component } from '../component.js';
import { LayoutCalculator } from './layout-calculator.js';

function getElement(entity) {
  return entity.element;
}
function isEnabledAndHasEnabledElement(entity) {
  return entity.enabled && entity.element && entity.element.enabled;
}

class LayoutGroupComponent extends Component {
  constructor(system, entity) {
    super(system, entity);

    this._orientation = ORIENTATION_HORIZONTAL;
    this._reverseX = false;
    this._reverseY = true;
    this._alignment = new Vec2(0, 1);
    this._padding = new Vec4();
    this._spacing = new Vec2();
    this._widthFitting = FITTING_NONE;
    this._heightFitting = FITTING_NONE;
    this._wrap = false;
    this._layoutCalculator = new LayoutCalculator();

    this._listenForReflowEvents(this.entity, 'on');

    this.entity.children.forEach(child => {
      this._listenForReflowEvents(child, 'on');
    });

    this.entity.on('childinsert', this._onChildInsert, this);
    this.entity.on('childremove', this._onChildRemove, this);

    system.app.systems.element.on('add', this._onElementOrLayoutComponentAdd, this);
    system.app.systems.element.on('beforeremove', this._onElementOrLayoutComponentRemove, this);
    system.app.systems.layoutchild.on('add', this._onElementOrLayoutComponentAdd, this);
    system.app.systems.layoutchild.on('beforeremove', this._onElementOrLayoutComponentRemove, this);
  }

  set orientation(value) {
    if (value !== this._orientation) {
      this._orientation = value;
      this._scheduleReflow();
    }
  }
  get orientation() {
    return this._orientation;
  }

  set reverseX(value) {
    if (value !== this._reverseX) {
      this._reverseX = value;
      this._scheduleReflow();
    }
  }
  get reverseX() {
    return this._reverseX;
  }

  set reverseY(value) {
    if (value !== this._reverseY) {
      this._reverseY = value;
      this._scheduleReflow();
    }
  }
  get reverseY() {
    return this._reverseY;
  }

  set alignment(value) {
    if (!value.equals(this._alignment)) {
      this._alignment.copy(value);
      this._scheduleReflow();
    }
  }
  get alignment() {
    return this._alignment;
  }

  set padding(value) {
    if (!value.equals(this._padding)) {
      this._padding.copy(value);
      this._scheduleReflow();
    }
  }
  get padding() {
    return this._padding;
  }

  set spacing(value) {
    if (!value.equals(this._spacing)) {
      this._spacing.copy(value);
      this._scheduleReflow();
    }
  }
  get spacing() {
    return this._spacing;
  }

  set widthFitting(value) {
    if (value !== this._widthFitting) {
      this._widthFitting = value;
      this._scheduleReflow();
    }
  }
  get widthFitting() {
    return this._widthFitting;
  }

  set heightFitting(value) {
    if (value !== this._heightFitting) {
      this._heightFitting = value;
      this._scheduleReflow();
    }
  }
  get heightFitting() {
    return this._heightFitting;
  }

  set wrap(value) {
    if (value !== this._wrap) {
      this._wrap = value;
      this._scheduleReflow();
    }
  }
  get wrap() {
    return this._wrap;
  }
  _isSelfOrChild(entity) {
    return entity === this.entity || this.entity.children.indexOf(entity) !== -1;
  }
  _listenForReflowEvents(target, onOff) {
    if (target.element) {
      target.element[onOff]('enableelement', this._scheduleReflow, this);
      target.element[onOff]('disableelement', this._scheduleReflow, this);
      target.element[onOff]('resize', this._scheduleReflow, this);
      target.element[onOff]('set:pivot', this._scheduleReflow, this);
    }
    if (target.layoutchild) {
      target.layoutchild[onOff]('set_enabled', this._scheduleReflow, this);
      target.layoutchild[onOff]('resize', this._scheduleReflow, this);
    }
  }
  _onElementOrLayoutComponentAdd(entity) {
    if (this._isSelfOrChild(entity)) {
      this._listenForReflowEvents(entity, 'on');
      this._scheduleReflow();
    }
  }
  _onElementOrLayoutComponentRemove(entity) {
    if (this._isSelfOrChild(entity)) {
      this._listenForReflowEvents(entity, 'off');
      this._scheduleReflow();
    }
  }
  _onChildInsert(child) {
    this._listenForReflowEvents(child, 'on');
    this._scheduleReflow();
  }
  _onChildRemove(child) {
    this._listenForReflowEvents(child, 'off');
    this._scheduleReflow();
  }
  _scheduleReflow() {
    if (this.enabled && this.entity && this.entity.enabled && !this._isPerformingReflow) {
      this.system.scheduleReflow(this);
    }
  }
  reflow() {
    const container = getElement(this.entity);
    const elements = this.entity.children.filter(isEnabledAndHasEnabledElement).map(getElement);
    if (!container || elements.length === 0) {
      return;
    }
    const containerWidth = Math.max(container.calculatedWidth, 0);
    const containerHeight = Math.max(container.calculatedHeight, 0);
    const options = {
      orientation: this._orientation,
      reverseX: this._reverseX,
      reverseY: this._reverseY,
      alignment: this._alignment,
      padding: this._padding,
      spacing: this._spacing,
      widthFitting: this._widthFitting,
      heightFitting: this._heightFitting,
      wrap: this._wrap,
      containerSize: new Vec2(containerWidth, containerHeight)
    };

    this._isPerformingReflow = true;
    const layoutInfo = this._layoutCalculator.calculateLayout(elements, options);
    this._isPerformingReflow = false;
    this.fire('reflow', layoutInfo);
  }
  onEnable() {
    this._scheduleReflow();
  }
  onRemove() {
    this.entity.off('childinsert', this._onChildInsert, this);
    this.entity.off('childremove', this._onChildRemove, this);
    this._listenForReflowEvents(this.entity, 'off');
    this.entity.children.forEach(child => {
      this._listenForReflowEvents(child, 'off');
    });
    this.system.app.systems.element.off('add', this._onElementOrLayoutComponentAdd, this);
    this.system.app.systems.element.off('beforeremove', this._onElementOrLayoutComponentRemove, this);
    this.system.app.systems.layoutchild.off('add', this._onElementOrLayoutComponentAdd, this);
    this.system.app.systems.layoutchild.off('beforeremove', this._onElementOrLayoutComponentRemove, this);
  }
}

export { LayoutGroupComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvbGF5b3V0LWdyb3VwL2NvbXBvbmVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9tYXRoL3ZlYzIuanMnO1xuaW1wb3J0IHsgVmVjNCB9IGZyb20gJy4uLy4uLy4uL2NvcmUvbWF0aC92ZWM0LmpzJztcblxuaW1wb3J0IHsgT1JJRU5UQVRJT05fSE9SSVpPTlRBTCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lL2NvbnN0YW50cy5qcyc7XG5cbmltcG9ydCB7IEZJVFRJTkdfTk9ORSB9IGZyb20gJy4vY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBMYXlvdXRDYWxjdWxhdG9yIH0gZnJvbSAnLi9sYXlvdXQtY2FsY3VsYXRvci5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi9lbnRpdHkuanMnKS5FbnRpdHl9IEVudGl0eSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vc3lzdGVtLmpzJykuTGF5b3V0R3JvdXBDb21wb25lbnRTeXN0ZW19IExheW91dEdyb3VwQ29tcG9uZW50U3lzdGVtICovXG5cbmZ1bmN0aW9uIGdldEVsZW1lbnQoZW50aXR5KSB7XG4gICAgcmV0dXJuIGVudGl0eS5lbGVtZW50O1xufVxuXG5mdW5jdGlvbiBpc0VuYWJsZWRBbmRIYXNFbmFibGVkRWxlbWVudChlbnRpdHkpIHtcbiAgICByZXR1cm4gZW50aXR5LmVuYWJsZWQgJiYgZW50aXR5LmVsZW1lbnQgJiYgZW50aXR5LmVsZW1lbnQuZW5hYmxlZDtcbn1cblxuLyoqXG4gKiBBIExheW91dEdyb3VwQ29tcG9uZW50IGVuYWJsZXMgdGhlIEVudGl0eSB0byBwb3NpdGlvbiBhbmQgc2NhbGUgY2hpbGQge0BsaW5rIEVsZW1lbnRDb21wb25lbnR9c1xuICogYWNjb3JkaW5nIHRvIGNvbmZpZ3VyYWJsZSBsYXlvdXQgcnVsZXMuXG4gKlxuICogQGF1Z21lbnRzIENvbXBvbmVudFxuICovXG5jbGFzcyBMYXlvdXRHcm91cENvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IExheW91dEdyb3VwQ29tcG9uZW50IGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtMYXlvdXRHcm91cENvbXBvbmVudFN5c3RlbX0gc3lzdGVtIC0gVGhlIENvbXBvbmVudFN5c3RlbSB0aGF0IGNyZWF0ZWQgdGhpc1xuICAgICAqIENvbXBvbmVudC5cbiAgICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IC0gVGhlIEVudGl0eSB0aGF0IHRoaXMgQ29tcG9uZW50IGlzIGF0dGFjaGVkIHRvLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHN5c3RlbSwgZW50aXR5KSB7XG4gICAgICAgIHN1cGVyKHN5c3RlbSwgZW50aXR5KTtcblxuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fb3JpZW50YXRpb24gPSBPUklFTlRBVElPTl9IT1JJWk9OVEFMO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fcmV2ZXJzZVggPSBmYWxzZTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX3JldmVyc2VZID0gdHJ1ZTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX2FsaWdubWVudCA9IG5ldyBWZWMyKDAsIDEpO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fcGFkZGluZyA9IG5ldyBWZWM0KCk7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl9zcGFjaW5nID0gbmV3IFZlYzIoKTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX3dpZHRoRml0dGluZyA9IEZJVFRJTkdfTk9ORTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX2hlaWdodEZpdHRpbmcgPSBGSVRUSU5HX05PTkU7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl93cmFwID0gZmFsc2U7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl9sYXlvdXRDYWxjdWxhdG9yID0gbmV3IExheW91dENhbGN1bGF0b3IoKTtcblxuICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBncm91cCBjb250YWluZXIgYmVpbmcgcmVzaXplZFxuICAgICAgICB0aGlzLl9saXN0ZW5Gb3JSZWZsb3dFdmVudHModGhpcy5lbnRpdHksICdvbicpO1xuXG4gICAgICAgIC8vIExpc3RlbiB0byBleGlzdGluZyBjaGlsZHJlbiBiZWluZyByZXNpemVkXG4gICAgICAgIHRoaXMuZW50aXR5LmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5Gb3JSZWZsb3dFdmVudHMoY2hpbGQsICdvbicpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBMaXN0ZW4gdG8gbmV3bHkgYWRkZWQgY2hpbGRyZW4gYmVpbmcgcmVzaXplZFxuICAgICAgICB0aGlzLmVudGl0eS5vbignY2hpbGRpbnNlcnQnLCB0aGlzLl9vbkNoaWxkSW5zZXJ0LCB0aGlzKTtcbiAgICAgICAgdGhpcy5lbnRpdHkub24oJ2NoaWxkcmVtb3ZlJywgdGhpcy5fb25DaGlsZFJlbW92ZSwgdGhpcyk7XG5cbiAgICAgICAgLy8gTGlzdGVuIGZvciBFbGVtZW50Q29tcG9uZW50cyBhbmQgTGF5b3V0Q2hpbGRDb21wb25lbnRzIGJlaW5nIGFkZGVkXG4gICAgICAgIC8vIHRvIHNlbGYgb3IgdG8gY2hpbGRyZW4gLSBjb3ZlcnMgY2FzZXMgd2hlcmUgdGhleSBhcmUgbm90IGFscmVhZHlcbiAgICAgICAgLy8gcHJlc2VudCBhdCB0aGUgcG9pbnQgd2hlbiB0aGlzIGNvbXBvbmVudCBpcyBjb25zdHJ1Y3RlZC5cbiAgICAgICAgc3lzdGVtLmFwcC5zeXN0ZW1zLmVsZW1lbnQub24oJ2FkZCcsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkLCB0aGlzKTtcbiAgICAgICAgc3lzdGVtLmFwcC5zeXN0ZW1zLmVsZW1lbnQub24oJ2JlZm9yZXJlbW92ZScsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50UmVtb3ZlLCB0aGlzKTtcbiAgICAgICAgc3lzdGVtLmFwcC5zeXN0ZW1zLmxheW91dGNoaWxkLm9uKCdhZGQnLCB0aGlzLl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudEFkZCwgdGhpcyk7XG4gICAgICAgIHN5c3RlbS5hcHAuc3lzdGVtcy5sYXlvdXRjaGlsZC5vbignYmVmb3JlcmVtb3ZlJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRSZW1vdmUsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIGxheW91dCBzaG91bGQgcnVuIGhvcml6b250YWxseSBvciB2ZXJ0aWNhbGx5LiBDYW4gYmU6XG4gICAgICpcbiAgICAgKiAtIHtAbGluayBPUklFTlRBVElPTl9IT1JJWk9OVEFMfVxuICAgICAqIC0ge0BsaW5rIE9SSUVOVEFUSU9OX1ZFUlRJQ0FMfVxuICAgICAqXG4gICAgICogRGVmYXVsdHMgdG8ge0BsaW5rIE9SSUVOVEFUSU9OX0hPUklaT05UQUx9LlxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBzZXQgb3JpZW50YXRpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9vcmllbnRhdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fb3JpZW50YXRpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgb3JpZW50YXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXZlcnNlcyB0aGUgb3JkZXIgb2YgY2hpbGRyZW4gYWxvbmcgdGhlIHggYXhpcy4gRGVmYXVsdHMgdG8gZmFsc2UuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBzZXQgcmV2ZXJzZVgodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9yZXZlcnNlWCkge1xuICAgICAgICAgICAgdGhpcy5fcmV2ZXJzZVggPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgcmV2ZXJzZVgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXZlcnNlWDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXZlcnNlcyB0aGUgb3JkZXIgb2YgY2hpbGRyZW4gYWxvbmcgdGhlIHkgYXhpcy4gRGVmYXVsdHMgdG8gdHJ1ZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHNldCByZXZlcnNlWSh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX3JldmVyc2VZKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXZlcnNlWSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCByZXZlcnNlWSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JldmVyc2VZO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgYWxpZ25tZW50IG9mIGNoaWxkIGVsZW1lbnRzLiBWYWx1ZXMgcmFuZ2UgZnJvbSAwIHRvIDFcbiAgICAgKiB3aGVyZSBbMCwgMF0gaXMgdGhlIGJvdHRvbSBsZWZ0IGFuZCBbMSwgMV0gaXMgdGhlIHRvcCByaWdodC4gRGVmYXVsdHMgdG8gWzAsIDFdLlxuICAgICAqXG4gICAgICogQHR5cGUge1ZlYzJ9XG4gICAgICovXG4gICAgc2V0IGFsaWdubWVudCh2YWx1ZSkge1xuICAgICAgICBpZiAoIXZhbHVlLmVxdWFscyh0aGlzLl9hbGlnbm1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLl9hbGlnbm1lbnQuY29weSh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGFsaWdubWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FsaWdubWVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYWRkaW5nIHRvIGJlIGFwcGxpZWQgaW5zaWRlIHRoZSBjb250YWluZXIgYmVmb3JlIHBvc2l0aW9uaW5nIGFueSBjaGlsZHJlbi4gU3BlY2lmaWVkIGFzXG4gICAgICogbGVmdCwgYm90dG9tLCByaWdodCBhbmQgdG9wIHZhbHVlcy4gRGVmYXVsdHMgdG8gWzAsIDAsIDAsIDBdIChubyBwYWRkaW5nKS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtWZWM0fVxuICAgICAqL1xuICAgIHNldCBwYWRkaW5nKHZhbHVlKSB7XG4gICAgICAgIGlmICghdmFsdWUuZXF1YWxzKHRoaXMuX3BhZGRpbmcpKSB7XG4gICAgICAgICAgICB0aGlzLl9wYWRkaW5nLmNvcHkodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBwYWRkaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFkZGluZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTcGFjaW5nIHRvIGJlIGFwcGxpZWQgYmV0d2VlbiBlYWNoIGNoaWxkIGVsZW1lbnQuIERlZmF1bHRzIHRvIFswLCAwXSAobm8gc3BhY2luZykuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7VmVjMn1cbiAgICAgKi9cbiAgICBzZXQgc3BhY2luZyh2YWx1ZSkge1xuICAgICAgICBpZiAoIXZhbHVlLmVxdWFscyh0aGlzLl9zcGFjaW5nKSkge1xuICAgICAgICAgICAgdGhpcy5fc3BhY2luZy5jb3B5KHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgc3BhY2luZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NwYWNpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRml0dGluZyBsb2dpYyB0byBiZSBhcHBsaWVkIHdoZW4gcG9zaXRpb25pbmcgYW5kIHNjYWxpbmcgY2hpbGQgZWxlbWVudHMuIENhbiBiZTpcbiAgICAgKlxuICAgICAqIC0ge0BsaW5rIEZJVFRJTkdfTk9ORX06IENoaWxkIGVsZW1lbnRzIHdpbGwgYmUgcmVuZGVyZWQgYXQgdGhlaXIgbmF0dXJhbCBzaXplLlxuICAgICAqIC0ge0BsaW5rIEZJVFRJTkdfU1RSRVRDSH06IFdoZW4gdGhlIG5hdHVyYWwgc2l6ZSBvZiBhbGwgY2hpbGQgZWxlbWVudHMgZG9lcyBub3QgZmlsbCB0aGUgd2lkdGhcbiAgICAgKiBvZiB0aGUgY29udGFpbmVyLCBjaGlsZHJlbiB3aWxsIGJlIHN0cmV0Y2hlZCB0byBmaXQuIFRoZSBydWxlcyBmb3IgaG93IGVhY2ggY2hpbGQgd2lsbCBiZVxuICAgICAqIHN0cmV0Y2hlZCBhcmUgb3V0bGluZWQgYmVsb3c6XG4gICAgICogICAxLiBTdW0gdGhlIHtAbGluayBMYXlvdXRDaGlsZENvbXBvbmVudCNmaXRXaWR0aFByb3BvcnRpb259IHZhbHVlcyBvZiBlYWNoIGNoaWxkIGFuZCBub3JtYWxpemVcbiAgICAgKiBzbyB0aGF0IGFsbCB2YWx1ZXMgc3VtIHRvIDEuXG4gICAgICogICAyLiBBcHBseSB0aGUgbmF0dXJhbCB3aWR0aCBvZiBlYWNoIGNoaWxkLlxuICAgICAqICAgMy4gSWYgdGhlcmUgaXMgc3BhY2UgcmVtYWluaW5nIGluIHRoZSBjb250YWluZXIsIGRpc3RyaWJ1dGUgaXQgdG8gZWFjaCBjaGlsZCBiYXNlZCBvbiB0aGVcbiAgICAgKiBub3JtYWxpemVkIHtAbGluayBMYXlvdXRDaGlsZENvbXBvbmVudCNmaXRXaWR0aFByb3BvcnRpb259IHZhbHVlcywgYnV0IGRvIG5vdCBleGNlZWQgdGhlXG4gICAgICoge0BsaW5rIExheW91dENoaWxkQ29tcG9uZW50I21heFdpZHRofSBvZiBlYWNoIGNoaWxkLlxuICAgICAqIC0ge0BsaW5rIEZJVFRJTkdfU0hSSU5LfTogV2hlbiB0aGUgbmF0dXJhbCBzaXplIG9mIGFsbCBjaGlsZCBlbGVtZW50cyBvdmVyZmxvd3MgdGhlIHdpZHRoIG9mIHRoZVxuICAgICAqIGNvbnRhaW5lciwgY2hpbGRyZW4gd2lsbCBiZSBzaHJ1bmsgdG8gZml0LiBUaGUgcnVsZXMgZm9yIGhvdyBlYWNoIGNoaWxkIHdpbGwgYmUgc3RyZXRjaGVkIGFyZVxuICAgICAqIG91dGxpbmVkIGJlbG93OlxuICAgICAqICAgMS4gU3VtIHRoZSB7QGxpbmsgTGF5b3V0Q2hpbGRDb21wb25lbnQjZml0V2lkdGhQcm9wb3J0aW9ufSB2YWx1ZXMgb2YgZWFjaCBjaGlsZCBhbmQgbm9ybWFsaXplXG4gICAgICogc28gdGhhdCBhbGwgdmFsdWVzIHN1bSB0byAxLlxuICAgICAqICAgMi4gQXBwbHkgdGhlIG5hdHVyYWwgd2lkdGggb2YgZWFjaCBjaGlsZC5cbiAgICAgKiAgIDMuIElmIHRoZSBuZXcgdG90YWwgd2lkdGggb2YgYWxsIGNoaWxkcmVuIGV4Y2VlZHMgdGhlIGF2YWlsYWJsZSBzcGFjZSBvZiB0aGUgY29udGFpbmVyLCByZWR1Y2VcbiAgICAgKiBlYWNoIGNoaWxkJ3Mgd2lkdGggcHJvcG9ydGlvbmFsbHkgYmFzZWQgb24gdGhlIG5vcm1hbGl6ZWQge0BsaW5rXG4gICAgICogTGF5b3V0Q2hpbGRDb21wb25lbnQjZml0V2lkdGhQcm9wb3J0aW9ufSB2YWx1ZXMsIGJ1dCBkbyBub3QgZXhjZWVkIHRoZSB7QGxpbmtcbiAgICAgKiBMYXlvdXRDaGlsZENvbXBvbmVudCNtaW5XaWR0aH0gb2YgZWFjaCBjaGlsZC5cbiAgICAgKiAtIHtAbGluayBGSVRUSU5HX0JPVEh9OiBBcHBsaWVzIGJvdGggU1RSRVRDSCBhbmQgU0hSSU5LIGxvZ2ljIGFzIG5lY2Vzc2FyeS5cbiAgICAgKlxuICAgICAqIERlZmF1bHRzIHRvIHtAbGluayBGSVRUSU5HX05PTkV9LlxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBzZXQgd2lkdGhGaXR0aW5nKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5fd2lkdGhGaXR0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLl93aWR0aEZpdHRpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgd2lkdGhGaXR0aW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGhGaXR0aW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElkZW50aWNhbCB0byB7QGxpbmsgTGF5b3V0R3JvdXBDb21wb25lbnQjd2lkdGhGaXR0aW5nfSBidXQgZm9yIHRoZSBZIGF4aXMuIERlZmF1bHRzIHRvXG4gICAgICoge0BsaW5rIEZJVFRJTkdfTk9ORX0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCBoZWlnaHRGaXR0aW5nKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5faGVpZ2h0Rml0dGluZykge1xuICAgICAgICAgICAgdGhpcy5faGVpZ2h0Rml0dGluZyA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBoZWlnaHRGaXR0aW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0Rml0dGluZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIG9yIG5vdCB0byB3cmFwIGNoaWxkcmVuIG9udG8gYSBuZXcgcm93L2NvbHVtbiB3aGVuIHRoZSBzaXplIG9mIHRoZSBjb250YWluZXIgaXNcbiAgICAgKiBleGNlZWRlZC4gRGVmYXVsdHMgdG8gZmFsc2UsIHdoaWNoIG1lYW5zIHRoYXQgY2hpbGRyZW4gd2lsbCBiZSBiZSByZW5kZXJlZCBpbiBhIHNpbmdsZSByb3dcbiAgICAgKiAoaG9yaXpvbnRhbCBvcmllbnRhdGlvbikgb3IgY29sdW1uICh2ZXJ0aWNhbCBvcmllbnRhdGlvbikuIE5vdGUgdGhhdCBzZXR0aW5nIHdyYXAgdG8gdHJ1ZVxuICAgICAqIG1ha2VzIGl0IGltcG9zc2libGUgZm9yIHRoZSB7QGxpbmsgRklUVElOR19CT1RIfSBmaXR0aW5nIG1vZGUgdG8gb3BlcmF0ZSBpbiBhbnkgbG9naWNhbFxuICAgICAqIG1hbm5lci4gRm9yIHRoaXMgcmVhc29uLCB3aGVuIHdyYXAgaXMgdHJ1ZSwgYSB7QGxpbmsgTGF5b3V0R3JvdXBDb21wb25lbnQjd2lkdGhGaXR0aW5nfSBvclxuICAgICAqIHtAbGluayBMYXlvdXRHcm91cENvbXBvbmVudCNoZWlnaHRGaXR0aW5nfSBtb2RlIG9mIHtAbGluayBGSVRUSU5HX0JPVEh9IHdpbGwgYmUgY29lcmNlZCB0b1xuICAgICAqIHtAbGluayBGSVRUSU5HX1NUUkVUQ0h9LlxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgc2V0IHdyYXAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl93cmFwKSB7XG4gICAgICAgICAgICB0aGlzLl93cmFwID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHdyYXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93cmFwO1xuICAgIH1cblxuICAgIF9pc1NlbGZPckNoaWxkKGVudGl0eSkge1xuICAgICAgICByZXR1cm4gKGVudGl0eSA9PT0gdGhpcy5lbnRpdHkpIHx8ICh0aGlzLmVudGl0eS5jaGlsZHJlbi5pbmRleE9mKGVudGl0eSkgIT09IC0xKTtcbiAgICB9XG5cbiAgICBfbGlzdGVuRm9yUmVmbG93RXZlbnRzKHRhcmdldCwgb25PZmYpIHtcbiAgICAgICAgaWYgKHRhcmdldC5lbGVtZW50KSB7XG4gICAgICAgICAgICB0YXJnZXQuZWxlbWVudFtvbk9mZl0oJ2VuYWJsZWVsZW1lbnQnLCB0aGlzLl9zY2hlZHVsZVJlZmxvdywgdGhpcyk7XG4gICAgICAgICAgICB0YXJnZXQuZWxlbWVudFtvbk9mZl0oJ2Rpc2FibGVlbGVtZW50JywgdGhpcy5fc2NoZWR1bGVSZWZsb3csIHRoaXMpO1xuICAgICAgICAgICAgdGFyZ2V0LmVsZW1lbnRbb25PZmZdKCdyZXNpemUnLCB0aGlzLl9zY2hlZHVsZVJlZmxvdywgdGhpcyk7XG4gICAgICAgICAgICB0YXJnZXQuZWxlbWVudFtvbk9mZl0oJ3NldDpwaXZvdCcsIHRoaXMuX3NjaGVkdWxlUmVmbG93LCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0YXJnZXQubGF5b3V0Y2hpbGQpIHtcbiAgICAgICAgICAgIHRhcmdldC5sYXlvdXRjaGlsZFtvbk9mZl0oJ3NldF9lbmFibGVkJywgdGhpcy5fc2NoZWR1bGVSZWZsb3csIHRoaXMpO1xuICAgICAgICAgICAgdGFyZ2V0LmxheW91dGNoaWxkW29uT2ZmXSgncmVzaXplJywgdGhpcy5fc2NoZWR1bGVSZWZsb3csIHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkKGVudGl0eSkge1xuICAgICAgICBpZiAodGhpcy5faXNTZWxmT3JDaGlsZChlbnRpdHkpKSB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5Gb3JSZWZsb3dFdmVudHMoZW50aXR5LCAnb24nKTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRSZW1vdmUoZW50aXR5KSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1NlbGZPckNoaWxkKGVudGl0eSkpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhlbnRpdHksICdvZmYnKTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25DaGlsZEluc2VydChjaGlsZCkge1xuICAgICAgICB0aGlzLl9saXN0ZW5Gb3JSZWZsb3dFdmVudHMoY2hpbGQsICdvbicpO1xuICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgIH1cblxuICAgIF9vbkNoaWxkUmVtb3ZlKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhjaGlsZCwgJ29mZicpO1xuICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgIH1cblxuICAgIF9zY2hlZHVsZVJlZmxvdygpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmVudGl0eSAmJiB0aGlzLmVudGl0eS5lbmFibGVkICYmICF0aGlzLl9pc1BlcmZvcm1pbmdSZWZsb3cpIHtcbiAgICAgICAgICAgIHRoaXMuc3lzdGVtLnNjaGVkdWxlUmVmbG93KHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVmbG93KCkge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBnZXRFbGVtZW50KHRoaXMuZW50aXR5KTtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSB0aGlzLmVudGl0eS5jaGlsZHJlbi5maWx0ZXIoaXNFbmFibGVkQW5kSGFzRW5hYmxlZEVsZW1lbnQpLm1hcChnZXRFbGVtZW50KTtcblxuICAgICAgICBpZiAoIWNvbnRhaW5lciB8fCBlbGVtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gTWF0aC5tYXgoY29udGFpbmVyLmNhbGN1bGF0ZWRXaWR0aCwgMCk7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lckhlaWdodCA9IE1hdGgubWF4KGNvbnRhaW5lci5jYWxjdWxhdGVkSGVpZ2h0LCAwKTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgb3JpZW50YXRpb246IHRoaXMuX29yaWVudGF0aW9uLFxuICAgICAgICAgICAgcmV2ZXJzZVg6IHRoaXMuX3JldmVyc2VYLFxuICAgICAgICAgICAgcmV2ZXJzZVk6IHRoaXMuX3JldmVyc2VZLFxuICAgICAgICAgICAgYWxpZ25tZW50OiB0aGlzLl9hbGlnbm1lbnQsXG4gICAgICAgICAgICBwYWRkaW5nOiB0aGlzLl9wYWRkaW5nLFxuICAgICAgICAgICAgc3BhY2luZzogdGhpcy5fc3BhY2luZyxcbiAgICAgICAgICAgIHdpZHRoRml0dGluZzogdGhpcy5fd2lkdGhGaXR0aW5nLFxuICAgICAgICAgICAgaGVpZ2h0Rml0dGluZzogdGhpcy5faGVpZ2h0Rml0dGluZyxcbiAgICAgICAgICAgIHdyYXA6IHRoaXMuX3dyYXAsXG4gICAgICAgICAgICBjb250YWluZXJTaXplOiBuZXcgVmVjMihjb250YWluZXJXaWR0aCwgY29udGFpbmVySGVpZ2h0KVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEluIG9yZGVyIHRvIHByZXZlbnQgcmVjdXJzaXZlIHJlZmxvdyAoaS5lLiB3aGVyZWJ5IHNldHRpbmcgdGhlIHNpemUgb2ZcbiAgICAgICAgLy8gYSBjaGlsZCBlbGVtZW50IHRyaWdnZXJzIGFub3RoZXIgcmVmbG93IG9uIHRoZSBuZXh0IGZyYW1lLCBhbmQgc28gb24pXG4gICAgICAgIC8vIHdlIGZsYWcgdGhhdCBhIHJlZmxvdyBpcyBjdXJyZW50bHkgaW4gcHJvZ3Jlc3MuXG4gICAgICAgIHRoaXMuX2lzUGVyZm9ybWluZ1JlZmxvdyA9IHRydWU7XG4gICAgICAgIGNvbnN0IGxheW91dEluZm8gPSB0aGlzLl9sYXlvdXRDYWxjdWxhdG9yLmNhbGN1bGF0ZUxheW91dChlbGVtZW50cywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuX2lzUGVyZm9ybWluZ1JlZmxvdyA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuZmlyZSgncmVmbG93JywgbGF5b3V0SW5mbyk7XG4gICAgfVxuXG4gICAgb25FbmFibGUoKSB7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgfVxuXG4gICAgb25SZW1vdmUoKSB7XG4gICAgICAgIHRoaXMuZW50aXR5Lm9mZignY2hpbGRpbnNlcnQnLCB0aGlzLl9vbkNoaWxkSW5zZXJ0LCB0aGlzKTtcbiAgICAgICAgdGhpcy5lbnRpdHkub2ZmKCdjaGlsZHJlbW92ZScsIHRoaXMuX29uQ2hpbGRSZW1vdmUsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyh0aGlzLmVudGl0eSwgJ29mZicpO1xuXG4gICAgICAgIHRoaXMuZW50aXR5LmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5Gb3JSZWZsb3dFdmVudHMoY2hpbGQsICdvZmYnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zeXN0ZW0uYXBwLnN5c3RlbXMuZWxlbWVudC5vZmYoJ2FkZCcsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkLCB0aGlzKTtcbiAgICAgICAgdGhpcy5zeXN0ZW0uYXBwLnN5c3RlbXMuZWxlbWVudC5vZmYoJ2JlZm9yZXJlbW92ZScsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50UmVtb3ZlLCB0aGlzKTtcbiAgICAgICAgdGhpcy5zeXN0ZW0uYXBwLnN5c3RlbXMubGF5b3V0Y2hpbGQub2ZmKCdhZGQnLCB0aGlzLl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudEFkZCwgdGhpcyk7XG4gICAgICAgIHRoaXMuc3lzdGVtLmFwcC5zeXN0ZW1zLmxheW91dGNoaWxkLm9mZignYmVmb3JlcmVtb3ZlJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRSZW1vdmUsIHRoaXMpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgTGF5b3V0R3JvdXBDb21wb25lbnQgfTtcbiJdLCJuYW1lcyI6WyJnZXRFbGVtZW50IiwiZW50aXR5IiwiZWxlbWVudCIsImlzRW5hYmxlZEFuZEhhc0VuYWJsZWRFbGVtZW50IiwiZW5hYmxlZCIsIkxheW91dEdyb3VwQ29tcG9uZW50IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJzeXN0ZW0iLCJfb3JpZW50YXRpb24iLCJPUklFTlRBVElPTl9IT1JJWk9OVEFMIiwiX3JldmVyc2VYIiwiX3JldmVyc2VZIiwiX2FsaWdubWVudCIsIlZlYzIiLCJfcGFkZGluZyIsIlZlYzQiLCJfc3BhY2luZyIsIl93aWR0aEZpdHRpbmciLCJGSVRUSU5HX05PTkUiLCJfaGVpZ2h0Rml0dGluZyIsIl93cmFwIiwiX2xheW91dENhbGN1bGF0b3IiLCJMYXlvdXRDYWxjdWxhdG9yIiwiX2xpc3RlbkZvclJlZmxvd0V2ZW50cyIsImNoaWxkcmVuIiwiZm9yRWFjaCIsImNoaWxkIiwib24iLCJfb25DaGlsZEluc2VydCIsIl9vbkNoaWxkUmVtb3ZlIiwiYXBwIiwic3lzdGVtcyIsIl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudEFkZCIsIl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudFJlbW92ZSIsImxheW91dGNoaWxkIiwib3JpZW50YXRpb24iLCJ2YWx1ZSIsIl9zY2hlZHVsZVJlZmxvdyIsInJldmVyc2VYIiwicmV2ZXJzZVkiLCJhbGlnbm1lbnQiLCJlcXVhbHMiLCJjb3B5IiwicGFkZGluZyIsInNwYWNpbmciLCJ3aWR0aEZpdHRpbmciLCJoZWlnaHRGaXR0aW5nIiwid3JhcCIsIl9pc1NlbGZPckNoaWxkIiwiaW5kZXhPZiIsInRhcmdldCIsIm9uT2ZmIiwiX2lzUGVyZm9ybWluZ1JlZmxvdyIsInNjaGVkdWxlUmVmbG93IiwicmVmbG93IiwiY29udGFpbmVyIiwiZWxlbWVudHMiLCJmaWx0ZXIiLCJtYXAiLCJsZW5ndGgiLCJjb250YWluZXJXaWR0aCIsIk1hdGgiLCJtYXgiLCJjYWxjdWxhdGVkV2lkdGgiLCJjb250YWluZXJIZWlnaHQiLCJjYWxjdWxhdGVkSGVpZ2h0Iiwib3B0aW9ucyIsImNvbnRhaW5lclNpemUiLCJsYXlvdXRJbmZvIiwiY2FsY3VsYXRlTGF5b3V0IiwiZmlyZSIsIm9uRW5hYmxlIiwib25SZW1vdmUiLCJvZmYiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQVlBLFNBQVNBLFVBQVUsQ0FBQ0MsTUFBTSxFQUFFO0VBQ3hCLE9BQU9BLE1BQU0sQ0FBQ0MsT0FBTyxDQUFBO0FBQ3pCLENBQUE7QUFFQSxTQUFTQyw2QkFBNkIsQ0FBQ0YsTUFBTSxFQUFFO0FBQzNDLEVBQUEsT0FBT0EsTUFBTSxDQUFDRyxPQUFPLElBQUlILE1BQU0sQ0FBQ0MsT0FBTyxJQUFJRCxNQUFNLENBQUNDLE9BQU8sQ0FBQ0UsT0FBTyxDQUFBO0FBQ3JFLENBQUE7O0FBUUEsTUFBTUMsb0JBQW9CLFNBQVNDLFNBQVMsQ0FBQztBQVF6Q0MsRUFBQUEsV0FBVyxDQUFDQyxNQUFNLEVBQUVQLE1BQU0sRUFBRTtBQUN4QixJQUFBLEtBQUssQ0FBQ08sTUFBTSxFQUFFUCxNQUFNLENBQUMsQ0FBQTs7SUFHckIsSUFBSSxDQUFDUSxZQUFZLEdBQUdDLHNCQUFzQixDQUFBO0lBRTFDLElBQUksQ0FBQ0MsU0FBUyxHQUFHLEtBQUssQ0FBQTtJQUV0QixJQUFJLENBQUNDLFNBQVMsR0FBRyxJQUFJLENBQUE7SUFFckIsSUFBSSxDQUFDQyxVQUFVLEdBQUcsSUFBSUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtBQUVoQyxJQUFBLElBQUksQ0FBQ0MsUUFBUSxHQUFHLElBQUlDLElBQUksRUFBRSxD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
