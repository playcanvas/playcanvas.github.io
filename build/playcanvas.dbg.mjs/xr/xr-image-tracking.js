/**
 * @license
 * PlayCanvas Engine v1.58.0-dev revision e102f2b2a (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { platform } from '../core/platform.js';
import { EventHandler } from '../core/event-handler.js';
import { XrTrackedImage } from './xr-tracked-image.js';

class XrImageTracking extends EventHandler {
  constructor(manager) {
    super();
    this._manager = void 0;
    this._supported = platform.browser && !!window.XRImageTrackingResult;
    this._available = false;
    this._images = [];
    this._manager = manager;

    if (this._supported) {
      this._manager.on('start', this._onSessionStart, this);

      this._manager.on('end', this._onSessionEnd, this);
    }
  }

  add(image, width) {
    if (!this._supported || this._manager.active) return null;
    const trackedImage = new XrTrackedImage(image, width);

    this._images.push(trackedImage);

    return trackedImage;
  }

  remove(trackedImage) {
    if (this._manager.active) return;

    const ind = this._images.indexOf(trackedImage);

    if (ind !== -1) {
      trackedImage.destroy();

      this._images.splice(ind, 1);
    }
  }

  _onSessionStart() {
    this._manager.session.getTrackedImageScores().then(images => {
      this._available = true;

      for (let i = 0; i < images.length; i++) {
        this._images[i]._trackable = images[i] === 'trackable';
      }
    }).catch(err => {
      this._available = false;
      this.fire('error', err);
    });
  }

  _onSessionEnd() {
    this._available = false;

    for (let i = 0; i < this._images.length; i++) {
      const image = this._images[i];
      image._pose = null;
      image._measuredWidth = 0;

      if (image._tracking) {
        image._tracking = false;
        image.fire('untracked');
      }
    }
  }

  prepareImages(callback) {
    if (this._images.length) {
      Promise.all(this._images.map(function (trackedImage) {
        return trackedImage.prepare();
      })).then(function (bitmaps) {
        callback(null, bitmaps);
      }).catch(function (err) {
        callback(err, null);
      });
    } else {
      callback(null, null);
    }
  }

  update(frame) {
    if (!this._available) return;
    const results = frame.getImageTrackingResults();
    const index = {};

    for (let i = 0; i < results.length; i++) {
      index[results[i].index] = results[i];
      const trackedImage = this._images[results[i].index];
      trackedImage._emulated = results[i].trackingState === 'emulated';
      trackedImage._measuredWidth = results[i].measuredWidthInMeters;
      trackedImage._pose = frame.getPose(results[i].imageSpace, this._manager._referenceSpace);
    }

    for (let i = 0; i < this._images.length; i++) {
      if (this._images[i]._tracking && !index[i]) {
        this._images[i]._tracking = false;

        this._images[i].fire('untracked');
      } else if (!this._images[i]._tracking && index[i]) {
        this._images[i]._tracking = true;

        this._images[i].fire('tracked');
      }
    }
  }

  get supported() {
    return this._supported;
  }

  get available() {
    return this._available;
  }

  get images() {
    return this._images;
  }

}

export { XrImageTracking };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieHItaW1hZ2UtdHJhY2tpbmcuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy94ci94ci1pbWFnZS10cmFja2luZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwbGF0Zm9ybSB9IGZyb20gJy4uL2NvcmUvcGxhdGZvcm0uanMnO1xuaW1wb3J0IHsgRXZlbnRIYW5kbGVyIH0gZnJvbSAnLi4vY29yZS9ldmVudC1oYW5kbGVyLmpzJztcbmltcG9ydCB7IFhyVHJhY2tlZEltYWdlIH0gZnJvbSAnLi94ci10cmFja2VkLWltYWdlLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4veHItbWFuYWdlci5qcycpLlhyTWFuYWdlcn0gWHJNYW5hZ2VyICovXG5cbi8qKlxuICogSW1hZ2UgVHJhY2tpbmcgcHJvdmlkZXMgdGhlIGFiaWxpdHkgdG8gdHJhY2sgcmVhbCB3b3JsZCBpbWFnZXMgYnkgcHJvdmlkZWQgaW1hZ2Ugc2FtcGxlcyBhbmRcbiAqIHRoZWlyIGVzdGltYXRlZCBzaXplcy5cbiAqXG4gKiBAYXVnbWVudHMgRXZlbnRIYW5kbGVyXG4gKi9cbmNsYXNzIFhySW1hZ2VUcmFja2luZyBleHRlbmRzIEV2ZW50SGFuZGxlciB7XG4gICAgLyoqXG4gICAgICogQHR5cGUge1hyTWFuYWdlcn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9tYW5hZ2VyO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc3VwcG9ydGVkID0gcGxhdGZvcm0uYnJvd3NlciAmJiAhIXdpbmRvdy5YUkltYWdlVHJhY2tpbmdSZXN1bHQ7XG5cbiAgICAgLyoqXG4gICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgKiBAcHJpdmF0ZVxuICAgICAgKi9cbiAgICBfYXZhaWxhYmxlID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7WHJUcmFja2VkSW1hZ2VbXX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pbWFnZXMgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIEltYWdlIFRyYWNraW5nIHByb3ZpZGVzIHRoZSBhYmlsaXR5IHRvIHRyYWNrIHJlYWwgd29ybGQgaW1hZ2VzIGJ5IHByb3ZpZGVkIGltYWdlIHNhbXBsZXMgYW5kXG4gICAgICogdGhlaXIgZXN0aW1hdGUgc2l6ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1hyTWFuYWdlcn0gbWFuYWdlciAtIFdlYlhSIE1hbmFnZXIuXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG1hbmFnZXIpIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLl9tYW5hZ2VyID0gbWFuYWdlcjtcblxuICAgICAgICBpZiAodGhpcy5fc3VwcG9ydGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9tYW5hZ2VyLm9uKCdzdGFydCcsIHRoaXMuX29uU2Vzc2lvblN0YXJ0LCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX21hbmFnZXIub24oJ2VuZCcsIHRoaXMuX29uU2Vzc2lvbkVuZCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaXJlZCB3aGVuIHRoZSBYUiBzZXNzaW9uIGlzIHN0YXJ0ZWQsIGJ1dCBpbWFnZSB0cmFja2luZyBmYWlsZWQgdG8gcHJvY2VzcyB0aGUgcHJvdmlkZWRcbiAgICAgKiBpbWFnZXMuXG4gICAgICpcbiAgICAgKiBAZXZlbnQgWHJJbWFnZVRyYWNraW5nI2Vycm9yXG4gICAgICogQHBhcmFtIHtFcnJvcn0gZXJyb3IgLSBFcnJvciBvYmplY3QgcmVsYXRlZCB0byBhIGZhaWx1cmUgb2YgaW1hZ2UgdHJhY2tpbmcuXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gaW1hZ2UgZm9yIGltYWdlIHRyYWNraW5nLiBBIHdpZHRoIGNhbiBhbHNvIGJlIHByb3ZpZGVkIHRvIGhlbHAgdGhlIHVuZGVybHlpbmcgc3lzdGVtXG4gICAgICogZXN0aW1hdGUgdGhlIGFwcHJvcHJpYXRlIHRyYW5zZm9ybWF0aW9uLiBNb2RpZnlpbmcgdGhlIHRyYWNrZWQgaW1hZ2VzIGxpc3QgaXMgb25seSBwb3NzaWJsZVxuICAgICAqIGJlZm9yZSBhbiBBUiBzZXNzaW9uIGlzIHN0YXJ0ZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0hUTUxDYW52YXNFbGVtZW50fEhUTUxJbWFnZUVsZW1lbnR8U1ZHSW1hZ2VFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnR8QmxvYnxJbWFnZURhdGF8SW1hZ2VCaXRtYXB9IGltYWdlIC0gSW1hZ2VcbiAgICAgKiB0aGF0IGlzIG1hdGNoaW5nIHJlYWwgd29ybGQgaW1hZ2UgYXMgY2xvc2UgYXMgcG9zc2libGUuIFJlc29sdXRpb24gb2YgaW1hZ2VzIHNob3VsZCBiZSBhdFxuICAgICAqIGxlYXN0IDMwMHgzMDAuIEhpZ2ggcmVzb2x1dGlvbiBkb2VzIE5PVCBpbXByb3ZlIHRyYWNraW5nIHBlcmZvcm1hbmNlLiBDb2xvciBvZiBpbWFnZSBpc1xuICAgICAqIGlycmVsZXZhbnQsIHNvIGdyYXlzY2FsZSBpbWFnZXMgY2FuIGJlIHVzZWQuIEltYWdlcyB3aXRoIHRvbyBtYW55IGdlb21ldHJpYyBmZWF0dXJlcyBvclxuICAgICAqIHJlcGVhdGluZyBwYXR0ZXJucyB3aWxsIHJlZHVjZSB0cmFja2luZyBzdGFiaWxpdHkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gV2lkdGggKGluIG1ldGVycykgb2YgaW1hZ2UgaW4gdGhlIHJlYWwgd29ybGQuIFByb3ZpZGluZyB0aGlzIHZhbHVlXG4gICAgICogYXMgY2xvc2UgdG8gdGhlIHJlYWwgdmFsdWUgd2lsbCBpbXByb3ZlIHRyYWNraW5nIHF1YWxpdHkuXG4gICAgICogQHJldHVybnMge1hyVHJhY2tlZEltYWdlfG51bGx9IFRyYWNrZWQgaW1hZ2Ugb2JqZWN0IHRoYXQgd2lsbCBjb250YWluIHRyYWNraW5nIGluZm9ybWF0aW9uLlxuICAgICAqIFJldHVybnMgbnVsbCBpZiBpbWFnZSB0cmFja2luZyBpcyBub3Qgc3VwcG9ydGVkIG9yIGlmIHRoZSBYUiBtYW5hZ2VyIGlzIG5vdCBhY3RpdmUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBpbWFnZSB3aXRoIHdpZHRoIG9mIDIwY20gKDAuMm0pXG4gICAgICogYXBwLnhyLmltYWdlVHJhY2tpbmcuYWRkKGJvb2tDb3ZlckltZywgMC4yKTtcbiAgICAgKi9cbiAgICBhZGQoaW1hZ2UsIHdpZHRoKSB7XG4gICAgICAgIGlmICghdGhpcy5fc3VwcG9ydGVkIHx8IHRoaXMuX21hbmFnZXIuYWN0aXZlKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCB0cmFja2VkSW1hZ2UgPSBuZXcgWHJUcmFja2VkSW1hZ2UoaW1hZ2UsIHdpZHRoKTtcbiAgICAgICAgdGhpcy5faW1hZ2VzLnB1c2godHJhY2tlZEltYWdlKTtcbiAgICAgICAgcmV0dXJuIHRyYWNrZWRJbWFnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYW4gaW1hZ2UgZnJvbSBpbWFnZSB0cmFja2luZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7WHJUcmFja2VkSW1hZ2V9IHRyYWNrZWRJbWFnZSAtIFRyYWNrZWQgaW1hZ2UgdG8gYmUgcmVtb3ZlZC4gTW9kaWZ5aW5nIHRoZSB0cmFja2VkXG4gICAgICogaW1hZ2VzIGxpc3QgaXMgb25seSBwb3NzaWJsZSBiZWZvcmUgYW4gQVIgc2Vzc2lvbiBpcyBzdGFydGVkLlxuICAgICAqL1xuICAgIHJlbW92ZSh0cmFja2VkSW1hZ2UpIHtcbiAgICAgICAgaWYgKHRoaXMuX21hbmFnZXIuYWN0aXZlKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaW5kID0gdGhpcy5faW1hZ2VzLmluZGV4T2YodHJhY2tlZEltYWdlKTtcbiAgICAgICAgaWYgKGluZCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRyYWNrZWRJbWFnZS5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLl9pbWFnZXMuc3BsaWNlKGluZCwgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICBfb25TZXNzaW9uU3RhcnQoKSB7XG4gICAgICAgIHRoaXMuX21hbmFnZXIuc2Vzc2lvbi5nZXRUcmFja2VkSW1hZ2VTY29yZXMoKS50aGVuKChpbWFnZXMpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2F2YWlsYWJsZSA9IHRydWU7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW1hZ2VzW2ldLl90cmFja2FibGUgPSBpbWFnZXNbaV0gPT09ICd0cmFja2FibGUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9hdmFpbGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnZXJyb3InLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICBfb25TZXNzaW9uRW5kKCkge1xuICAgICAgICB0aGlzLl9hdmFpbGFibGUgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2ltYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLl9pbWFnZXNbaV07XG4gICAgICAgICAgICBpbWFnZS5fcG9zZSA9IG51bGw7XG4gICAgICAgICAgICBpbWFnZS5fbWVhc3VyZWRXaWR0aCA9IDA7XG5cbiAgICAgICAgICAgIGlmIChpbWFnZS5fdHJhY2tpbmcpIHtcbiAgICAgICAgICAgICAgICBpbWFnZS5fdHJhY2tpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpbWFnZS5maXJlKCd1bnRyYWNrZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGFsbCBpbWFnZXMgaGF2ZSBiZWVuIHByZXBhcmVkIGFzIGltYWdlXG4gICAgICogYml0bWFwcy5cbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgcHJlcGFyZUltYWdlcyhjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5faW1hZ2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgUHJvbWlzZS5hbGwodGhpcy5faW1hZ2VzLm1hcChmdW5jdGlvbiAodHJhY2tlZEltYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrZWRJbWFnZS5wcmVwYXJlKCk7XG4gICAgICAgICAgICB9KSkudGhlbihmdW5jdGlvbiAoYml0bWFwcykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGJpdG1hcHMpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVyciwgbnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsqfSBmcmFtZSAtIFhSRnJhbWUgZnJvbSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgY2FsbGJhY2suXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIHVwZGF0ZShmcmFtZSkge1xuICAgICAgICBpZiAoIXRoaXMuX2F2YWlsYWJsZSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBmcmFtZS5nZXRJbWFnZVRyYWNraW5nUmVzdWx0cygpO1xuICAgICAgICBjb25zdCBpbmRleCA9IHsgfTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGluZGV4W3Jlc3VsdHNbaV0uaW5kZXhdID0gcmVzdWx0c1tpXTtcblxuICAgICAgICAgICAgY29uc3QgdHJhY2tlZEltYWdlID0gdGhpcy5faW1hZ2VzW3Jlc3VsdHNbaV0uaW5kZXhdO1xuICAgICAgICAgICAgdHJhY2tlZEltYWdlLl9lbXVsYXRlZCA9IHJlc3VsdHNbaV0udHJhY2tpbmdTdGF0ZSA9PT0gJ2VtdWxhdGVkJztcbiAgICAgICAgICAgIHRyYWNrZWRJbWFnZS5fbWVhc3VyZWRXaWR0aCA9IHJlc3VsdHNbaV0ubWVhc3VyZWRXaWR0aEluTWV0ZXJzO1xuICAgICAgICAgICAgdHJhY2tlZEltYWdlLl9wb3NlID0gZnJhbWUuZ2V0UG9zZShyZXN1bHRzW2ldLmltYWdlU3BhY2UsIHRoaXMuX21hbmFnZXIuX3JlZmVyZW5jZVNwYWNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5faW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faW1hZ2VzW2ldLl90cmFja2luZyAmJiAhaW5kZXhbaV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbWFnZXNbaV0uX3RyYWNraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5faW1hZ2VzW2ldLmZpcmUoJ3VudHJhY2tlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5faW1hZ2VzW2ldLl90cmFja2luZyAmJiBpbmRleFtpXSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ltYWdlc1tpXS5fdHJhY2tpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ltYWdlc1tpXS5maXJlKCd0cmFja2VkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcnVlIGlmIEltYWdlIFRyYWNraW5nIGlzIHN1cHBvcnRlZC5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBzdXBwb3J0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdXBwb3J0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJ1ZSBpZiBJbWFnZSBUcmFja2luZyBpcyBhdmFpbGFibGUuIFRoaXMgcHJvcGVydHkgd2lsbCBiZSBmYWxzZSBpZiBubyBpbWFnZXMgd2VyZSBwcm92aWRlZFxuICAgICAqIGZvciB0aGUgQVIgc2Vzc2lvbiBvciB0aGVyZSB3YXMgYW4gZXJyb3IgcHJvY2Vzc2luZyB0aGUgcHJvdmlkZWQgaW1hZ2VzLlxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgZ2V0IGF2YWlsYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F2YWlsYWJsZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaXN0IG9mIHtAbGluayBYclRyYWNrZWRJbWFnZX0gdGhhdCBjb250YWluIHRyYWNraW5nIGluZm9ybWF0aW9uLlxuICAgICAqXG4gICAgICogQHR5cGUge1hyVHJhY2tlZEltYWdlW119XG4gICAgICovXG4gICAgZ2V0IGltYWdlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ltYWdlcztcbiAgICB9XG59XG5cbmV4cG9ydCB7IFhySW1hZ2VUcmFja2luZyB9O1xuIl0sIm5hbWVzIjpbIlhySW1hZ2VUcmFja2luZyIsIkV2ZW50SGFuZGxlciIsImNvbnN0cnVjdG9yIiwibWFuYWdlciIsIl9tYW5hZ2VyIiwiX3N1cHBvcnRlZCIsInBsYXRmb3JtIiwiYnJvd3NlciIsIndpbmRvdyIsIlhSSW1hZ2VUcmFja2luZ1Jlc3VsdCIsIl9hdmFpbGFibGUiLCJfaW1hZ2VzIiwib24iLCJfb25TZXNzaW9uU3RhcnQiLCJfb25TZXNzaW9uRW5kIiwiYWRkIiwiaW1hZ2UiLCJ3aWR0aCIsImFjdGl2ZSIsInRyYWNrZWRJbWFnZSIsIlhyVHJhY2tlZEltYWdlIiwicHVzaCIsInJlbW92ZSIsImluZCIsImluZGV4T2YiLCJkZXN0cm95Iiwic3BsaWNlIiwic2Vzc2lvbiIsImdldFRyYWNrZWRJbWFnZVNjb3JlcyIsInRoZW4iLCJpbWFnZXMiLCJpIiwibGVuZ3RoIiwiX3RyYWNrYWJsZSIsImNhdGNoIiwiZXJyIiwiZmlyZSIsIl9wb3NlIiwiX21lYXN1cmVkV2lkdGgiLCJfdHJhY2tpbmciLCJwcmVwYXJlSW1hZ2VzIiwiY2FsbGJhY2siLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicHJlcGFyZSIsImJpdG1hcHMiLCJ1cGRhdGUiLCJmcmFtZSIsInJlc3VsdHMiLCJnZXRJbWFnZVRyYWNraW5nUmVzdWx0cyIsImluZGV4IiwiX2VtdWxhdGVkIiwidHJhY2tpbmdTdGF0ZSIsIm1lYXN1cmVkV2lkdGhJbk1ldGVycyIsImdldFBvc2UiLCJpbWFnZVNwYWNlIiwiX3JlZmVyZW5jZVNwYWNlIiwic3VwcG9ydGVkIiwiYXZhaWxhYmxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFZQSxNQUFNQSxlQUFOLFNBQThCQyxZQUE5QixDQUEyQztFQWdDdkNDLFdBQVcsQ0FBQ0MsT0FBRCxFQUFVO0FBQ2pCLElBQUEsS0FBQSxFQUFBLENBQUE7QUFEaUIsSUFBQSxJQUFBLENBM0JyQkMsUUEyQnFCLEdBQUEsS0FBQSxDQUFBLENBQUE7SUFBQSxJQXJCckJDLENBQUFBLFVBcUJxQixHQXJCUkMsUUFBUSxDQUFDQyxPQUFULElBQW9CLENBQUMsQ0FBQ0MsTUFBTSxDQUFDQyxxQkFxQnJCLENBQUE7SUFBQSxJQWZyQkMsQ0FBQUEsVUFlcUIsR0FmUixLQWVRLENBQUE7SUFBQSxJQVRyQkMsQ0FBQUEsT0FTcUIsR0FUWCxFQVNXLENBQUE7SUFHakIsSUFBS1AsQ0FBQUEsUUFBTCxHQUFnQkQsT0FBaEIsQ0FBQTs7SUFFQSxJQUFJLElBQUEsQ0FBS0UsVUFBVCxFQUFxQjtNQUNqQixJQUFLRCxDQUFBQSxRQUFMLENBQWNRLEVBQWQsQ0FBaUIsT0FBakIsRUFBMEIsSUFBQSxDQUFLQyxlQUEvQixFQUFnRCxJQUFoRCxDQUFBLENBQUE7O01BQ0EsSUFBS1QsQ0FBQUEsUUFB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
