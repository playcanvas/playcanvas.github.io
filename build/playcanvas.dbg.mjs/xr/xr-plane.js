/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { EventHandler } from '../core/event-handler.js';
import { Vec3 } from '../math/vec3.js';
import { Quat } from '../math/quat.js';

let ids = 0;

class XrPlane extends EventHandler {
  constructor(planeDetection, xrPlane) {
    super();
    this._id = void 0;
    this._planeDetection = void 0;
    this._xrPlane = void 0;
    this._lastChangedTime = void 0;
    this._orientation = void 0;
    this._position = new Vec3();
    this._rotation = new Quat();
    this._id = ++ids;
    this._planeDetection = planeDetection;
    this._xrPlane = xrPlane;
    this._lastChangedTime = xrPlane.lastChangedTime;
    this._orientation = xrPlane.orientation;
  }

  destroy() {
    this.fire('remove');
  }

  update(frame) {
    const manager = this._planeDetection._manager;
    const pose = frame.getPose(this._xrPlane.planeSpace, manager._referenceSpace);

    if (pose) {
      this._position.copy(pose.transform.position);

      this._rotation.copy(pose.transform.orientation);
    }

    if (this._lastChangedTime !== this._xrPlane.lastChangedTime) {
      this._lastChangedTime = this._xrPlane.lastChangedTime;
      this.fire('change');
    }
  }

  getPosition() {
    return this._position;
  }

  getRotation() {
    return this._rotation;
  }

  get id() {
    return this._id;
  }

  get orientation() {
    return this._orientation;
  }

  get points() {
    return this._xrPlane.polygon;
  }

}

export { XrPlane };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieHItcGxhbmUuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy94ci94ci1wbGFuZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudEhhbmRsZXIgfSBmcm9tICcuLi9jb3JlL2V2ZW50LWhhbmRsZXIuanMnO1xuaW1wb3J0IHsgVmVjMyB9IGZyb20gJy4uL21hdGgvdmVjMy5qcyc7XG5pbXBvcnQgeyBRdWF0IH0gZnJvbSAnLi4vbWF0aC9xdWF0LmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4veHItcGxhbmUtZGV0ZWN0aW9uLmpzJykuWHJQbGFuZURldGVjdGlvbn0gWHJQbGFuZURldGVjdGlvbiAqL1xuXG5sZXQgaWRzID0gMDtcblxuLyoqXG4gKiBEZXRlY3RlZCBQbGFuZSBpbnN0YW5jZSB0aGF0IHByb3ZpZGVzIHBvc2l0aW9uLCByb3RhdGlvbiBhbmQgcG9seWdvbiBwb2ludHMuIFBsYW5lIGlzIGEgc3ViamVjdFxuICogdG8gY2hhbmdlIGR1cmluZyBpdHMgbGlmZXRpbWUuXG4gKi9cbmNsYXNzIFhyUGxhbmUgZXh0ZW5kcyBFdmVudEhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaWQ7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7WHJQbGFuZURldGVjdGlvbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9wbGFuZURldGVjdGlvbjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtYUlBsYW5lfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3hyUGxhbmU7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2xhc3RDaGFuZ2VkVGltZTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb3JpZW50YXRpb247XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7VmVjM31cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9wb3NpdGlvbiA9IG5ldyBWZWMzKCk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7UXVhdH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9yb3RhdGlvbiA9IG5ldyBRdWF0KCk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgWHJQbGFuZSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7WHJQbGFuZURldGVjdGlvbn0gcGxhbmVEZXRlY3Rpb24gLSBQbGFuZSBkZXRlY3Rpb24gc3lzdGVtLlxuICAgICAqIEBwYXJhbSB7Kn0geHJQbGFuZSAtIFhSUGxhbmUgdGhhdCBpcyBpbnN0YW50aWF0ZWQgYnkgV2ViWFIgc3lzdGVtLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihwbGFuZURldGVjdGlvbiwgeHJQbGFuZSkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuX2lkID0gKytpZHM7XG4gICAgICAgIHRoaXMuX3BsYW5lRGV0ZWN0aW9uID0gcGxhbmVEZXRlY3Rpb247XG4gICAgICAgIHRoaXMuX3hyUGxhbmUgPSB4clBsYW5lO1xuICAgICAgICB0aGlzLl9sYXN0Q2hhbmdlZFRpbWUgPSB4clBsYW5lLmxhc3RDaGFuZ2VkVGltZTtcbiAgICAgICAgdGhpcy5fb3JpZW50YXRpb24gPSB4clBsYW5lLm9yaWVudGF0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmVkIHdoZW4ge0BsaW5rIFhyUGxhbmV9IGlzIHJlbW92ZWQuXG4gICAgICpcbiAgICAgKiBAZXZlbnQgWHJQbGFuZSNyZW1vdmVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHBsYW5lLm9uY2UoJ3JlbW92ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgKiAgICAgLy8gcGxhbmUgaXMgbm90IGF2YWlsYWJsZSBhbnltb3JlXG4gICAgICogfSk7XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBGaXJlZCB3aGVuIHtAbGluayBYclBsYW5lfSBhdHRyaWJ1dGVzIHN1Y2ggYXM6IG9yaWVudGF0aW9uIGFuZC9vciBwb2ludHMgaGF2ZSBiZWVuIGNoYW5nZWQuXG4gICAgICogUG9zaXRpb24gYW5kIHJvdGF0aW9uIGNhbiBjaGFuZ2UgYXQgYW55IHRpbWUgd2l0aG91dCB0cmlnZ2VyaW5nIGEgYGNoYW5nZWAgZXZlbnQuXG4gICAgICpcbiAgICAgKiBAZXZlbnQgWHJQbGFuZSNjaGFuZ2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHBsYW5lLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICogICAgIC8vIHBsYW5lIGhhcyBiZWVuIGNoYW5nZWRcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIC8qKiBAaWdub3JlICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5maXJlKCdyZW1vdmUnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyp9IGZyYW1lIC0gWFJGcmFtZSBmcm9tIHJlcXVlc3RBbmltYXRpb25GcmFtZSBjYWxsYmFjay5cbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgdXBkYXRlKGZyYW1lKSB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLl9wbGFuZURldGVjdGlvbi5fbWFuYWdlcjtcbiAgICAgICAgY29uc3QgcG9zZSA9IGZyYW1lLmdldFBvc2UodGhpcy5feHJQbGFuZS5wbGFuZVNwYWNlLCBtYW5hZ2VyLl9yZWZlcmVuY2VTcGFjZSk7XG4gICAgICAgIGlmIChwb3NlKSB7XG4gICAgICAgICAgICB0aGlzLl9wb3NpdGlvbi5jb3B5KHBvc2UudHJhbnNmb3JtLnBvc2l0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuX3JvdGF0aW9uLmNvcHkocG9zZS50cmFuc2Zvcm0ub3JpZW50YXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaGFzIG5vdCBjaGFuZ2VkXG4gICAgICAgIGlmICh0aGlzLl9sYXN0Q2hhbmdlZFRpbWUgIT09IHRoaXMuX3hyUGxhbmUubGFzdENoYW5nZWRUaW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9sYXN0Q2hhbmdlZFRpbWUgPSB0aGlzLl94clBsYW5lLmxhc3RDaGFuZ2VkVGltZTtcblxuICAgICAgICAgICAgLy8gYXR0cmlidXRlcyBoYXZlIGJlZW4gY2hhbmdlZFxuICAgICAgICAgICAgdGhpcy5maXJlKCdjaGFuZ2UnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgd29ybGQgc3BhY2UgcG9zaXRpb24gb2YgYSBwbGFuZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtWZWMzfSBUaGUgd29ybGQgc3BhY2UgcG9zaXRpb24gb2YgYSBwbGFuZS5cbiAgICAgKi9cbiAgICBnZXRQb3NpdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgd29ybGQgc3BhY2Ugcm90YXRpb24gb2YgYSBwbGFuZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtRdWF0fSBUaGUgd29ybGQgc3BhY2Ugcm90YXRpb24gb2YgYSBwbGFuZS5cbiAgICAgKi9cbiAgICBnZXRSb3RhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdGF0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVuaXF1ZSBpZGVudGlmaWVyIG9mIGEgcGxhbmUuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBsYW5lJ3Mgc3BlY2lmaWMgb3JpZW50YXRpb24gKGhvcml6b250YWwgb3IgdmVydGljYWwpIG9yIG51bGwgaWYgb3JpZW50YXRpb24gaXMgYW55dGhpbmcgZWxzZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd8bnVsbH1cbiAgICAgKi9cbiAgICBnZXQgb3JpZW50YXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcnJheSBvZiBET01Qb2ludFJlYWRPbmx5IG9iamVjdHMuIERPTVBvaW50UmVhZE9ubHkgaXMgYW4gb2JqZWN0IHdpdGggYHggeSB6YCBwcm9wZXJ0aWVzXG4gICAgICogdGhhdCBkZWZpbmVzIGEgbG9jYWwgcG9pbnQgb2YgYSBwbGFuZSdzIHBvbHlnb24uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7b2JqZWN0W119XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBwcmVwYXJlIHJldXNhYmxlIG9iamVjdHNcbiAgICAgKiB2YXIgdmVjQSA9IG5ldyBwYy5WZWMzKCk7XG4gICAgICogdmFyIHZlY0IgPSBuZXcgcGMuVmVjMygpO1xuICAgICAqIHZhciBjb2xvciA9IG5ldyBwYy5Db2xvcigxLCAxLCAxKTtcbiAgICAgKlxuICAgICAqIC8vIHVwZGF0ZSBNYXQ0IHRvIHBsYW5lIHBvc2l0aW9uIGFuZCByb3RhdGlvblxuICAgICAqIHRyYW5zZm9ybS5zZXRUUlMocGxhbmUuZ2V0UG9zaXRpb24oKSwgcGxhbmUuZ2V0Um90YXRpb24oKSwgcGMuVmVjMy5PTkUpO1xuICAgICAqXG4gICAgICogLy8gZHJhdyBsaW5lcyBiZXR3ZWVuIHBvaW50c1xuICAgICAqIGZvciAodmFyIGkgPSAwOyBpIDwgcGxhbmUucG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICogICAgIHZlY0EuY29weShwbGFuZS5wb2ludHNbaV0pO1xuICAgICAqICAgICB2ZWNCLmNvcHkocGxhbmUucG9pbnRzWyhpICsgMSkgJSBwbGFuZS5wb2ludHMubGVuZ3RoXSk7XG4gICAgICpcbiAgICAgKiAgICAgLy8gdHJhbnNmb3JtIGZyb20gcGxhbmVzIGxvY2FsIHRvIHdvcmxkIGNvb3Jkc1xuICAgICAqICAgICB0cmFuc2Zvcm0udHJhbnNmb3JtUG9pbnQodmVjQSwgdmVjQSk7XG4gICAgICogICAgIHRyYW5zZm9ybS50cmFuc2Zvcm1Qb2ludCh2ZWNCLCB2ZWNCKTtcbiAgICAgKlxuICAgICAqICAgICAvLyByZW5kZXIgbGluZVxuICAgICAqICAgICBhcHAuZHJhd0xpbmUodmVjQSwgdmVjQiwgY29sb3IpO1xuICAgICAqIH1cbiAgICAgKi9cbiAgICBnZXQgcG9pbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5feHJQbGFuZS5wb2x5Z29uO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgWHJQbGFuZSB9O1xuIl0sIm5hbWVzIjpbImlkcyIsIlhyUGxhbmUiLCJFdmVudEhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsInBsYW5lRGV0ZWN0aW9uIiwieHJQbGFuZSIsIl9pZCIsIl9wbGFuZURldGVjdGlvbiIsIl94clBsYW5lIiwiX2xhc3RDaGFuZ2VkVGltZSIsIl9vcmllbnRhdGlvbiIsIl9wb3NpdGlvbiIsIlZlYzMiLCJfcm90YXRpb24iLCJRdWF0IiwibGFzdENoYW5nZWRUaW1lIiwib3JpZW50YXRpb24iLCJkZXN0cm95IiwiZmlyZSIsInVwZGF0ZSIsImZyYW1lIiwibWFuYWdlciIsIl9tYW5hZ2VyIiwicG9zZSIsImdldFBvc2UiLCJwbGFuZVNwYWNlIiwiX3JlZmVyZW5jZVNwYWNlIiwiY29weSIsInRyYW5zZm9ybSIsInBvc2l0aW9uIiwiZ2V0UG9zaXRpb24iLCJnZXRSb3RhdGlvbiIsImlkIiwicG9pbnRzIiwicG9seWdvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBTUEsSUFBSUEsR0FBRyxHQUFHLENBQVYsQ0FBQTs7QUFNQSxNQUFNQyxPQUFOLFNBQXNCQyxZQUF0QixDQUFtQztBQWtEL0JDLEVBQUFBLFdBQVcsQ0FBQ0MsY0FBRCxFQUFpQkMsT0FBakIsRUFBMEI7QUFDakMsSUFBQSxLQUFBLEVBQUEsQ0FBQTtBQURpQyxJQUFBLElBQUEsQ0E3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
