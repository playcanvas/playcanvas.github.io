/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class WebglRenderTarget {
  constructor() {
    this._glFrameBuffer = null;
    this._glDepthBuffer = null;
    this._glResolveFrameBuffer = null;
    this._glMsaaColorBuffer = null;
    this._glMsaaDepthBuffer = null;
  }

  destroy(device) {
    const gl = device.gl;

    if (this._glFrameBuffer) {
      gl.deleteFramebuffer(this._glFrameBuffer);
      this._glFrameBuffer = null;
    }

    if (this._glDepthBuffer) {
      gl.deleteRenderbuffer(this._glDepthBuffer);
      this._glDepthBuffer = null;
    }

    if (this._glResolveFrameBuffer) {
      gl.deleteFramebuffer(this._glResolveFrameBuffer);
      this._glResolveFrameBuffer = null;
    }

    if (this._glMsaaColorBuffer) {
      gl.deleteRenderbuffer(this._glMsaaColorBuffer);
      this._glMsaaColorBuffer = null;
    }

    if (this._glMsaaDepthBuffer) {
      gl.deleteRenderbuffer(this._glMsaaDepthBuffer);
      this._glMsaaDepthBuffer = null;
    }
  }

  get initialized() {
    return this._glFrameBuffer !== null;
  }

  init(device, target) {
    const gl = device.gl;
    this._glFrameBuffer = gl.createFramebuffer();
    device.setFramebuffer(this._glFrameBuffer);
    const colorBuffer = target._colorBuffer;

    if (colorBuffer) {
      if (!colorBuffer.impl._glTexture) {
        colorBuffer._width = Math.min(colorBuffer.width, device.maxRenderBufferSize);
        colorBuffer._height = Math.min(colorBuffer.height, device.maxRenderBufferSize);
        device.setTexture(colorBuffer, 0);
      }

      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, colorBuffer._cubemap ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + target._face : gl.TEXTURE_2D, colorBuffer.impl._glTexture, 0);
    }

    const depthBuffer = target._depthBuffer;

    if (depthBuffer) {
      if (!depthBuffer.impl._glTexture) {
        depthBuffer._width = Math.min(depthBuffer.width, device.maxRenderBufferSize);
        depthBuffer._height = Math.min(depthBuffer.height, device.maxRenderBufferSize);
        device.setTexture(depthBuffer, 0);
      }

      if (target._stencil) {
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, depthBuffer._cubemap ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + target._face : gl.TEXTURE_2D, target._depthBuffer.impl._glTexture, 0);
      } else {
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, depthBuffer._cubemap ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + target._face : gl.TEXTURE_2D, target._depthBuffer.impl._glTexture, 0);
      }
    } else if (target._depth) {
      const willRenderMsaa = target._samples > 1 && device.webgl2;

      if (!willRenderMsaa) {
        if (!this._glDepthBuffer) {
          this._glDepthBuffer = gl.createRenderbuffer();
        }

        gl.bindRenderbuffer(gl.RENDERBUFFER, this._glDepthBuffer);

        if (target._stencil) {
          gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, target.width, target.height);
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this._glDepthBuffer);
        } else {
          const depthFormat = device.webgl2 ? gl.DEPTH_COMPONENT32F : gl.DEPTH_COMPONENT16;
          gl.renderbufferStorage(gl.RENDERBUFFER, depthFormat, target.width, target.height);
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this._glDepthBuffer);
        }

        gl.bindRenderbuffer(gl.RENDERBUFFER, null);
      }
    }

    this._checkFbo(device);

    if (device.webgl2 && target._samples > 1) {
      this._glResolveFrameBuffer = this._glFrameBuffer;
      this._glFrameBuffer = gl.createFramebuffer();
      device.setFramebuffer(this._glFrameBuffer);

      if (colorBuffer) {
        if (!this._glMsaaColorBuffer) {
          this._glMsaaColorBuffer = gl.createRenderbuffer();
        }

        gl.bindRenderbuffer(gl.RENDERBUFFER, this._glMsaaColorBuffer);
        gl.renderbufferStorageMultisample(gl.RENDERBUFFER, target._samples, colorBuffer.impl._glInternalFormat, target.width, target.height);
        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.RENDERBUFFER, this._glMsaaColorBuffer);
      }

      if (target._depth) {
        if (!this._glMsaaDepthBuffer) {
          this._glMsaaDepthBuffer = gl.createRenderbuffer();
        }

        gl.bindRenderbuffer(gl.RENDERBUFFER, this._glMsaaDepthBuffer);

        if (target._stencil) {
          gl.renderbufferStorageMultisample(gl.RENDERBUFFER, target._samples, gl.DEPTH24_STENCIL8, target.width, target.height);
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this._glMsaaDepthBuffer);
        } else {
          gl.renderbufferStorageMultisample(gl.RENDERBUFFER, target._samples, gl.DEPTH_COMPONENT32F, target.width, target.height);
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this._glMsaaDepthBuffer);
        }
      }

      this._checkFbo(device);
    }
  }

  _checkFbo(device) {
    const gl = device.gl;
    const status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);

    switch (status) {
      case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:
        console.error("ERROR: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
        break;

      case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:
        console.error("ERROR: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
        break;

      case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:
        console.error("ERROR: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
        break;

      case gl.FRAMEBUFFER_UNSUPPORTED:
        console.error("ERROR: FRAMEBUFFER_UNSUPPORTED");
        break;

      case gl.FRAMEBUFFER_COMPLETE:
        break;
    }
  }

  loseContext() {
    this._glFrameBuffer = null;
    this._glDepthBuffer = null;
    this._glResolveFrameBuffer = null;
    this._glMsaaColorBuffer = null;
    this._glMsaaDepthBuffer = null;
  }

  resolve(device, target, color, depth) {
    if (device.webgl2) {
      const gl = device.gl;
      gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this._glFrameBuffer);
      gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, this._glResolveFrameBuffer);
      gl.blitFramebuffer(0, 0, target.width, target.height, 0, 0, target.width, target.height, (color ? gl.COLOR_BUFFER_BIT : 0) | (depth ? gl.DEPTH_BUFFER_BIT : 0), gl.NEAREST);
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._glFrameBuffer);
    }
  }

}

export { WebglRenderTarget };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ2wtcmVuZGVyLXRhcmdldC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2dyYXBoaWNzL3dlYmdsL3dlYmdsLXJlbmRlci10YXJnZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBIFdlYkdMIGltcGxlbWVudGF0aW9uIG9mIHRoZSBSZW5kZXJUYXJnZXQuXG4gKlxuICogQGlnbm9yZVxuICovXG5jbGFzcyBXZWJnbFJlbmRlclRhcmdldCB7XG4gICAgX2dsRnJhbWVCdWZmZXIgPSBudWxsO1xuXG4gICAgX2dsRGVwdGhCdWZmZXIgPSBudWxsO1xuXG4gICAgX2dsUmVzb2x2ZUZyYW1lQnVmZmVyID0gbnVsbDtcblxuICAgIF9nbE1zYWFDb2xvckJ1ZmZlciA9IG51bGw7XG5cbiAgICBfZ2xNc2FhRGVwdGhCdWZmZXIgPSBudWxsO1xuXG4gICAgZGVzdHJveShkZXZpY2UpIHtcbiAgICAgICAgY29uc3QgZ2wgPSBkZXZpY2UuZ2w7XG4gICAgICAgIGlmICh0aGlzLl9nbEZyYW1lQnVmZmVyKSB7XG4gICAgICAgICAgICBnbC5kZWxldGVGcmFtZWJ1ZmZlcih0aGlzLl9nbEZyYW1lQnVmZmVyKTtcbiAgICAgICAgICAgIHRoaXMuX2dsRnJhbWVCdWZmZXIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2dsRGVwdGhCdWZmZXIpIHtcbiAgICAgICAgICAgIGdsLmRlbGV0ZVJlbmRlcmJ1ZmZlcih0aGlzLl9nbERlcHRoQnVmZmVyKTtcbiAgICAgICAgICAgIHRoaXMuX2dsRGVwdGhCdWZmZXIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2dsUmVzb2x2ZUZyYW1lQnVmZmVyKSB7XG4gICAgICAgICAgICBnbC5kZWxldGVGcmFtZWJ1ZmZlcih0aGlzLl9nbFJlc29sdmVGcmFtZUJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLl9nbFJlc29sdmVGcmFtZUJ1ZmZlciA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fZ2xNc2FhQ29sb3JCdWZmZXIpIHtcbiAgICAgICAgICAgIGdsLmRlbGV0ZVJlbmRlcmJ1ZmZlcih0aGlzLl9nbE1zYWFDb2xvckJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLl9nbE1zYWFDb2xvckJ1ZmZlciA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fZ2xNc2FhRGVwdGhCdWZmZXIpIHtcbiAgICAgICAgICAgIGdsLmRlbGV0ZVJlbmRlcmJ1ZmZlcih0aGlzLl9nbE1zYWFEZXB0aEJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLl9nbE1zYWFEZXB0aEJ1ZmZlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nbEZyYW1lQnVmZmVyICE9PSBudWxsO1xuICAgIH1cblxuICAgIGluaXQoZGV2aWNlLCB0YXJnZXQpIHtcbiAgICAgICAgY29uc3QgZ2wgPSBkZXZpY2UuZ2w7XG5cbiAgICAgICAgLy8gIyMjIyMgQ3JlYXRlIG1haW4gRkJPICMjIyMjXG4gICAgICAgIHRoaXMuX2dsRnJhbWVCdWZmZXIgPSBnbC5jcmVhdGVGcmFtZWJ1ZmZlcigpO1xuICAgICAgICBkZXZpY2Uuc2V0RnJhbWVidWZmZXIodGhpcy5fZ2xGcmFtZUJ1ZmZlcik7XG5cbiAgICAgICAgLy8gLS0tIEluaXQgdGhlIHByb3ZpZGVkIGNvbG9yIGJ1ZmZlciAob3B0aW9uYWwpIC0tLVxuICAgICAgICBjb25zdCBjb2xvckJ1ZmZlciA9IHRhcmdldC5fY29sb3JCdWZmZXI7XG4gICAgICAgIGlmIChjb2xvckJ1ZmZlcikge1xuICAgICAgICAgICAgaWYgKCFjb2xvckJ1ZmZlci5pbXBsLl9nbFRleHR1cmUpIHtcbiAgICAgICAgICAgICAgICAvLyBDbGFtcCB0aGUgcmVuZGVyIGJ1ZmZlciBzaXplIHRvIHRoZSBtYXhpbXVtIHN1cHBvcnRlZCBieSB0aGUgZGV2aWNlXG4gICAgICAgICAgICAgICAgY29sb3JCdWZmZXIuX3dpZHRoID0gTWF0aC5taW4oY29sb3JCdWZmZXIud2lkdGgsIGRldmljZS5tYXhSZW5kZXJCdWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICBjb2xvckJ1ZmZlci5faGVpZ2h0ID0gTWF0aC5taW4oY29sb3JCdWZmZXIuaGVpZ2h0LCBkZXZpY2UubWF4UmVuZGVyQnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgZGV2aWNlLnNldFRleHR1cmUoY29sb3JCdWZmZXIsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQXR0YWNoIHRoZSBjb2xvciBidWZmZXJcbiAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyVGV4dHVyZTJEKFxuICAgICAgICAgICAgICAgIGdsLkZSQU1FQlVGRkVSLFxuICAgICAgICAgICAgICAgIGdsLkNPTE9SX0FUVEFDSE1FTlQwLFxuICAgICAgICAgICAgICAgIGNvbG9yQnVmZmVyLl9jdWJlbWFwID8gZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YICsgdGFyZ2V0Ll9mYWNlIDogZ2wuVEVYVFVSRV8yRCxcbiAgICAgICAgICAgICAgICBjb2xvckJ1ZmZlci5pbXBsLl9nbFRleHR1cmUsXG4gICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlcHRoQnVmZmVyID0gdGFyZ2V0Ll9kZXB0aEJ1ZmZlcjtcbiAgICAgICAgaWYgKGRlcHRoQnVmZmVyKSB7XG4gICAgICAgICAgICAvLyAtLS0gSW5pdCB0aGUgcHJvdmlkZWQgZGVwdGgvc3RlbmNpbCBidWZmZXIgKG9wdGlvbmFsLCBXZWJHTDIgb25seSkgLS0tXG4gICAgICAgICAgICBpZiAoIWRlcHRoQnVmZmVyLmltcGwuX2dsVGV4dHVyZSkge1xuICAgICAgICAgICAgICAgIC8vIENsYW1wIHRoZSByZW5kZXIgYnVmZmVyIHNpemUgdG8gdGhlIG1heGltdW0gc3VwcG9ydGVkIGJ5IHRoZSBkZXZpY2VcbiAgICAgICAgICAgICAgICBkZXB0aEJ1ZmZlci5fd2lkdGggPSBNYXRoLm1pbihkZXB0aEJ1ZmZlci53aWR0aCwgZGV2aWNlLm1heFJlbmRlckJ1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgIGRlcHRoQnVmZmVyLl9oZWlnaHQgPSBNYXRoLm1pbihkZXB0aEJ1ZmZlci5oZWlnaHQsIGRldmljZS5tYXhSZW5kZXJCdWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICBkZXZpY2Uuc2V0VGV4dHVyZShkZXB0aEJ1ZmZlciwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBdHRhY2hcbiAgICAgICAgICAgIGlmICh0YXJnZXQuX3N0ZW5jaWwpIHtcbiAgICAgICAgICAgICAgICBnbC5mcmFtZWJ1ZmZlclRleHR1cmUyRChnbC5GUkFNRUJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRoQnVmZmVyLl9jdWJlbWFwID8gZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YICsgdGFyZ2V0Ll9mYWNlIDogZ2wuVEVYVFVSRV8yRCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuX2RlcHRoQnVmZmVyLmltcGwuX2dsVGV4dHVyZSwgMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyVGV4dHVyZTJEKGdsLkZSQU1FQlVGRkVSLCBnbC5ERVBUSF9BVFRBQ0hNRU5ULFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRoQnVmZmVyLl9jdWJlbWFwID8gZ2wuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YICsgdGFyZ2V0Ll9mYWNlIDogZ2wuVEVYVFVSRV8yRCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuX2RlcHRoQnVmZmVyLmltcGwuX2dsVGV4dHVyZSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0Ll9kZXB0aCkge1xuICAgICAgICAgICAgLy8gLS0tIEluaXQgYSBuZXcgZGVwdGgvc3RlbmNpbCBidWZmZXIgKG9wdGlvbmFsKSAtLS1cbiAgICAgICAgICAgIC8vIGlmIGRldmljZSBpcyBhIE1TQUEgUlQsIGFuZCBubyBidWZmZXIgdG8gcmVzb2x2ZSB0bywgc2tpcCBjcmVhdGluZyBub24tTVNBQSBkZXB0aFxuICAgICAgICAgICAgY29uc3Qgd2lsbFJlbmRlck1zYWEgPSB0YXJnZXQuX3NhbXBsZXMgPiAxICYmIGRldmljZS53ZWJnbDI7XG4gICAgICAgICAgICBpZiAoIXdpbGxSZW5kZXJNc2FhKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9nbERlcHRoQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dsRGVwdGhCdWZmZXIgPSBnbC5jcmVhdGVSZW5kZXJidWZmZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2wuYmluZFJlbmRlcmJ1ZmZlcihnbC5SRU5ERVJCVUZGRVIsIHRoaXMuX2dsRGVwdGhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuX3N0ZW5jaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2wucmVuZGVyYnVmZmVyU3RvcmFnZShnbC5SRU5ERVJCVUZGRVIsIGdsLkRFUFRIX1NURU5DSUwsIHRhcmdldC53aWR0aCwgdGFyZ2V0LmhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBnbC5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQsIGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xEZXB0aEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVwdGhGb3JtYXQgPSBkZXZpY2Uud2ViZ2wyID8gZ2wuREVQVEhfQ09NUE9ORU5UMzJGIDogZ2wuREVQVEhfQ09NUE9ORU5UMTY7XG4gICAgICAgICAgICAgICAgICAgIGdsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoZ2wuUkVOREVSQlVGRkVSLCBkZXB0aEZvcm1hdCwgdGFyZ2V0LndpZHRoLCB0YXJnZXQuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIGdsLkRFUFRIX0FUVEFDSE1FTlQsIGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xEZXB0aEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdsLmJpbmRSZW5kZXJidWZmZXIoZ2wuUkVOREVSQlVGRkVSLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vICNpZiBfREVCVUdcbiAgICAgICAgdGhpcy5fY2hlY2tGYm8oZGV2aWNlKTtcbiAgICAgICAgLy8gI2VuZGlmXG5cbiAgICAgICAgLy8gIyMjIyMgQ3JlYXRlIE1TQUEgRkJPIChXZWJHTDIgb25seSkgIyMjIyNcbiAgICAgICAgaWYgKGRldmljZS53ZWJnbDIgJiYgdGFyZ2V0Ll9zYW1wbGVzID4gMSkge1xuXG4gICAgICAgICAgICAvLyBVc2UgcHJldmlvdXMgRkJPIGZvciByZXNvbHZlc1xuICAgICAgICAgICAgdGhpcy5fZ2xSZXNvbHZlRnJhbWVCdWZmZXIgPSB0aGlzLl9nbEZyYW1lQnVmZmVyO1xuXG4gICAgICAgICAgICAvLyBBY3R1YWwgRkJPIHdpbGwgYmUgTVNBQVxuICAgICAgICAgICAgdGhpcy5fZ2xGcmFtZUJ1ZmZlciA9IGdsLmNyZWF0ZUZyYW1lYnVmZmVyKCk7XG4gICAgICAgICAgICBkZXZpY2Uuc2V0RnJhbWVidWZmZXIodGhpcy5fZ2xGcmFtZUJ1ZmZlcik7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBvcHRpb25hbCBNU0FBIGNvbG9yIGJ1ZmZlclxuICAgICAgICAgICAgaWYgKGNvbG9yQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9nbE1zYWFDb2xvckJ1ZmZlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9nbE1zYWFDb2xvckJ1ZmZlciA9IGdsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnbC5iaW5kUmVuZGVyYnVmZmVyKGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xNc2FhQ29sb3JCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGdsLnJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZShnbC5SRU5ERVJCVUZGRVIsIHRhcmdldC5fc2FtcGxlcywgY29sb3JCdWZmZXIuaW1wbC5fZ2xJbnRlcm5hbEZvcm1hdCwgdGFyZ2V0LndpZHRoLCB0YXJnZXQuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBnbC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgZ2wuQ09MT1JfQVRUQUNITUVOVDAsIGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xNc2FhQ29sb3JCdWZmZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPcHRpb25hbGx5IGFkZCBhIE1TQUEgZGVwdGgvc3RlbmNpbCBidWZmZXJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuX2RlcHRoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9nbE1zYWFEZXB0aEJ1ZmZlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9nbE1zYWFEZXB0aEJ1ZmZlciA9IGdsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnbC5iaW5kUmVuZGVyYnVmZmVyKGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xNc2FhRGVwdGhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuX3N0ZW5jaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKGdsLlJFTkRFUkJVRkZFUiwgdGFyZ2V0Ll9zYW1wbGVzLCBnbC5ERVBUSDI0X1NURU5DSUw4LCB0YXJnZXQud2lkdGgsIHRhcmdldC5oZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBnbC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULCBnbC5SRU5ERVJCVUZGRVIsIHRoaXMuX2dsTXNhYURlcHRoQnVmZmVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBnbC5yZW5kZXJidWZmZXJTdG9yYWdlTXVsdGlzYW1wbGUoZ2wuUkVOREVSQlVGRkVSLCB0YXJnZXQuX3NhbXBsZXMsIGdsLkRFUFRIX0NPTVBPTkVOVDMyRiwgdGFyZ2V0LndpZHRoLCB0YXJnZXQuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIGdsLkRFUFRIX0FUVEFDSE1FTlQsIGdsLlJFTkRFUkJVRkZFUiwgdGhpcy5fZ2xNc2FhRGVwdGhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vICNpZiBfREVCVUdcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrRmJvKGRldmljZSk7XG4gICAgICAgICAgICAvLyAjZW5kaWZcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGUgY29tcGxldGVuZXNzIHN0YXR1cyBvZiB0aGUgY3VycmVudGx5IGJvdW5kIFdlYkdMRnJhbWVidWZmZXIgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfY2hlY2tGYm8oZGV2aWNlKSB7XG4gICAgICAgIGNvbnN0IGdsID0gZGV2aWNlLmdsO1xuICAgICAgICBjb25zdCBzdGF0dXMgPSBnbC5jaGVja0ZyYW1lYnVmZmVyU3RhdHVzKGdsLkZSQU1FQlVGRkVSKTtcbiAgICAgICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgZ2wuRlJBTUVCVUZGRVJfSU5DT01QTEVURV9BVFRBQ0hNRU5UOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFUlJPUjogRlJBTUVCVUZGRVJfSU5DT01QTEVURV9BVFRBQ0hNRU5UXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBnbC5GUkFNRUJVRkZFUl9JTkNPTVBMRVRFX01JU1NJTkdfQVRUQUNITUVOVDpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRVJST1I6IEZSQU1FQlVGRkVSX0lOQ09NUExFVEVfTUlTU0lOR19BVFRBQ0hNRU5UXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBnbC5GUkFNRUJVRkZFUl9JTkNPTVBMRVRFX0RJTUVOU0lPTlM6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVSUk9SOiBGUkFNRUJVRkZFUl9JTkNPTVBMRVRFX0RJTUVOU0lPTlNcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGdsLkZSQU1FQlVGRkVSX1VOU1VQUE9SVEVEOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFUlJPUjogRlJBTUVCVUZGRVJfVU5TVVBQT1JURURcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGdsLkZSQU1FQlVGRkVSX0NPTVBMRVRFOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxvc2VDb250ZXh0KCkge1xuICAgICAgICB0aGlzLl9nbEZyYW1lQnVmZmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZ2xEZXB0aEJ1ZmZlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2dsUmVzb2x2ZUZyYW1lQnVmZmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZ2xNc2FhQ29sb3JCdWZmZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9nbE1zYWFEZXB0aEJ1ZmZlciA9IG51bGw7XG4gICAgfVxuXG4gICAgcmVzb2x2ZShkZXZpY2UsIHRhcmdldCwgY29sb3IsIGRlcHRoKSB7XG4gICAgICAgIGlmIChkZXZpY2Uud2ViZ2wyKSB7XG4gICAgICAgICAgICBjb25zdCBnbCA9IGRldmljZS5nbDtcbiAgICAgICAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcihnbC5SRUFEX0ZSQU1FQlVGRkVSLCB0aGlzLl9nbEZyYW1lQnVmZmVyKTtcbiAgICAgICAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcihnbC5EUkFXX0ZSQU1FQlVGRkVSLCB0aGlzLl9nbFJlc29sdmVGcmFtZUJ1ZmZlcik7XG4gICAgICAgICAgICBnbC5ibGl0RnJhbWVidWZmZXIoMCwgMCwgdGFyZ2V0LndpZHRoLCB0YXJnZXQuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsIDAsIHRhcmdldC53aWR0aCwgdGFyZ2V0LmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY29sb3IgPyBnbC5DT0xPUl9CVUZGRVJfQklUIDogMCkgfCAoZGVwdGggPyBnbC5ERVBUSF9CVUZGRVJfQklUIDogMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2wuTkVBUkVTVCk7XG4gICAgICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIHRoaXMuX2dsRnJhbWVCdWZmZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgeyBXZWJnbFJlbmRlclRhcmdldCB9O1xuIl0sIm5hbWVzIjpbIldlYmdsUmVuZGVyVGFyZ2V0IiwiX2dsRnJhbWVCdWZmZXIiLCJfZ2xEZXB0aEJ1ZmZlciIsIl9nbFJlc29sdmVGcmFtZUJ1ZmZlciIsIl9nbE1zYWFDb2xvckJ1ZmZlciIsIl9nbE1zYWFEZXB0aEJ1ZmZlciIsImRlc3Ryb3kiLCJkZXZpY2UiLCJnbCIsImRlbGV0ZUZyYW1lYnVmZmVyIiwiZGVsZXRlUmVuZGVyYnVmZmVyIiwiaW5pdGlhbGl6ZWQiLCJpbml0IiwidGFyZ2V0IiwiY3JlYXRlRnJhbWVidWZmZXIiLCJzZXRGcmFtZWJ1ZmZlciIsImNvbG9yQnVmZmVyIiwiX2NvbG9yQnVmZmVyIiwiaW1wbCIsIl9nbFRleHR1cmUiLCJfd2lkdGgiLCJNYXRoIiwibWluIiwid2lkdGgiLCJtYXhSZW5kZXJCdWZmZXJTaXplIiwiX2hlaWdodCIsImhlaWdodCIsInNldFRleHR1cmUiLCJmcmFtZWJ1ZmZlclRleHR1cmUyRCIsIkZSQU1FQlVGRkVSIiwiQ09MT1JfQVRUQUNITUVOVDAiLCJfY3ViZW1hcCIsIlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCIsIl9mYWNlIiwiVEVYVFVSRV8yRCIsImRlcHRoQnVmZmVyIiwiX2RlcHRoQnVmZmVyIiwiX3N0ZW5jaWwiLCJERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQiLCJERVBUSF9BVFRBQ0hNRU5UIiwiX2RlcHRoIiwid2lsbFJlbmRlck1zYWEiLCJfc2FtcGxlcyIsIndlYmdsMiIsImNyZWF0ZVJlbmRlcmJ1ZmZlciIsImJpbmRSZW5kZXJidWZmZXIiLCJSRU5ERVJCVUZGRVIiLCJyZW5kZXJidWZmZXJTdG9yYWdlIiwiREVQVEhfU1RFTkNJTCIsImZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyIiwiZGVwdGhGb3JtYXQiLCJERVBUSF9DT01QT05FTlQzMkYiLCJERVBUSF9DT01QT05FTlQxNiIsIl9jaGVja0ZibyIsInJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZSIsIl9nbEludGVybmFsRm9ybWF0IiwiREVQVEgyNF9TVEVOQ0lMOCIsInN0YXR1cyIsImNoZWNrRnJhbWVidWZmZXJTdGF0dXMiLCJGUkFNRUJVRkZFUl9JTkNPTVBMRVRFX0FUVEFDSE1FTlQiLCJjb25zb2xlIiwiZXJyb3IiLCJGUkFNRUJVRkZFUl9JTkNPTVBMRVRFX01JU1NJTkdfQVRUQUNITUVOVCIsIkZSQU1FQlVGRkVSX0lOQ09NUExFVEVfRElNRU5TSU9OUyIsIkZSQU1FQlVGRkVSX1VOU1VQUE9SVEVEIiwiRlJBTUVCVUZGRVJfQ09NUExFVEUiLCJsb3NlQ29udGV4dCIsInJlc29sdmUiLCJjb2xvciIsImRlcHRoIiwiYmluZEZyYW1lYnVmZmVyIiwiUkVBRF9GUkFNRUJVRkZFUiIsIkRSQVdfRlJBTUVCVUZGRVIiLCJibGl0RnJhbWVidWZmZXIiLCJDT0xPUl9CVUZGRVJfQklUIiwiREVQVEhfQlVGRkVSX0JJVCIsIk5FQVJFU1QiXSwibWFwcGluZ3MiOiI7Ozs7O0FBS0EsTUFBTUEsaUJBQU4sQ0FBd0I7QUFBQSxFQUFBLFdBQUEsR0FBQTtJQUFBLElBQ3BCQyxDQUFBQSxjQURvQixHQUNILElBREcsQ0FBQTtJQUFBLElBR3BCQyxDQUFBQSxjQUhvQixHQUdILElBSEcsQ0FBQTtJQUFBLElBS3BCQyxDQUFBQSxxQkFMb0IsR0FLSSxJQUxKLENBQUE7SUFBQSxJQU9wQkMsQ0FBQUEsa0JBUG9CLEdBT0MsSUFQRCxDQUFBO0lBQUEsSUFTcEJDLENBQUFBLGtCQVRvQixHQVNDLElBVEQsQ0FBQTtBQUFBLEdBQUE7O0VBV3BCQyxPQUFPLENBQUNDLE1BQUQsRUFBUztBQUNaLElBQUEsTUFBTUMsRUFBRSxHQUFHRCxNQUFNLENBQUNDLEVBQWxCLENBQUE7O0lBQ0EsSUFBSSxJQUFBLENBQUtQLGNBQVQsRUFBeUI7QUFDckJPLE1BQUFBLEVBQUUsQ0FBQ0MsaUJBQUgsQ0FBcUIsSUFBQSxDQUFLUixjQUExQixDQUFBLENBQUE7TUFDQSxJQUFLQSxDQUFBQSxjQUFMLEdBQXNCLElBQXRCLENBQUE7QUFDSCxLQUFBOztJQUVELElBQUksSUFBQSxDQUFLQyxjQUFULEVBQXlCO0FBQ3JCTSxNQUFB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
