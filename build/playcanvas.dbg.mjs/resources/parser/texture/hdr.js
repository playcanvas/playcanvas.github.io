/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { ReadStream } from '../../../core/read-stream.js';
import { Debug } from '../../../core/debug.js';
import { Texture } from '../../../graphics/texture.js';
import { TEXHINT_ASSET, ADDRESS_REPEAT, ADDRESS_CLAMP_TO_EDGE, FILTER_NEAREST, PIXELFORMAT_R8_G8_B8_A8, TEXTURETYPE_RGBE } from '../../../graphics/constants.js';
import { Asset } from '../../../asset/asset.js';

class HdrParser {
  constructor(registry) {
    this.maxRetries = 0;
  }

  load(url, callback, asset) {
    Asset.fetchArrayBuffer(url.load, callback, asset, this.maxRetries);
  }

  open(url, data, device) {
    const textureData = this.parse(data);

    if (!textureData) {
      return null;
    }

    const texture = new Texture(device, {
      name: url,
      profilerHint: TEXHINT_ASSET,
      addressU: ADDRESS_REPEAT,
      addressV: ADDRESS_CLAMP_TO_EDGE,
      minFilter: FILTER_NEAREST,
      magFilter: FILTER_NEAREST,
      width: textureData.width,
      height: textureData.height,
      levels: textureData.levels,
      format: PIXELFORMAT_R8_G8_B8_A8,
      type: TEXTURETYPE_RGBE,
      mipmaps: false
    });
    texture.upload();
    return texture;
  }

  parse(data) {
    const readStream = new ReadStream(data);
    const magic = readStream.readLine();

    if (!magic.startsWith('#?RADIANCE')) {
      Debug.error('radiance header has invalid magic');
      return null;
    }

    const variables = {};

    while (true) {
      const line = readStream.readLine();

      if (line.length === 0) {
        break;
      } else {
        const parts = line.split('=');

        if (parts.length === 2) {
          variables[parts[0]] = parts[1];
        }
      }
    }

    if (!variables.hasOwnProperty('FORMAT')) {
      Debug.error('radiance header missing FORMAT variable');
      return null;
    }

    const resolution = readStream.readLine().split(' ');

    if (resolution.length !== 4) {
      Debug.error('radiance header has invalid resolution');
      return null;
    }

    const height = parseInt(resolution[1], 10);
    const width = parseInt(resolution[3], 10);

    const pixels = this._readPixels(readStream, width, height, resolution[0] === '-Y');

    if (!pixels) {
      return null;
    }

    return {
      width: width,
      height: height,
      levels: [pixels]
    };
  }

  _readPixels(readStream, width, height, flipY) {
    if (width < 8 || width > 0x7fff) {
      return this._readPixelsFlat(readStream, width, height);
    }

    const rgbe = [0, 0, 0, 0];
    readStream.readArray(rgbe);

    if (rgbe[0] !== 2 || rgbe[1] !== 2 || (rgbe[2] & 0x80) !== 0) {
      readStream.skip(-4);
      return this._readPixelsFlat(readStream, width, height);
    }

    const buffer = new ArrayBuffer(width * height * 4);
    const view = new Uint8Array(buffer);
    let scanstart = flipY ? 0 : width * 4 * (height - 1);
    let x, y, i, channel, count, value;

    for (y = 0; y < height; ++y) {
      if (y) {
        readStream.readArray(rgbe);
      }

      if ((rgbe[2] << 8) + rgbe[3] !== width) {
        Debug.error('radiance has invalid scanline width');
        return null;
      }

      for (channel = 0; channel < 4; ++channel) {
        x = 0;

        while (x < width) {
          count = readStream.readU8();

          if (count > 128) {
            count -= 128;

            if (x + count > width) {
              Debug.error('radiance has invalid scanline data');
              return null;
            }

            value = readStream.readU8();

            for (i = 0; i < count; ++i) {
              view[scanstart + channel + 4 * x++] = value;
            }
          } else {
            if (count === 0 || x + count > width) {
              Debug.error('radiance has invalid scanline data');
              return null;
            }

            for (i = 0; i < count; ++i) {
              view[scanstart + channel + 4 * x++] = readStream.readU8();
            }
          }
        }
      }

      scanstart += width * 4 * (flipY ? 1 : -1);
    }

    return view;
  }

  _readPixelsFlat(readStream, width, height) {
    return readStream.remainingBytes === width * height * 4 ? new Uint8Array(readStream.arraybuffer, readStream.offset) : null;
  }

}

export { HdrParser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGRyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvcmVzb3VyY2VzL3BhcnNlci90ZXh0dXJlL2hkci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWFkU3RyZWFtIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9yZWFkLXN0cmVhbS5qcyc7XG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG5pbXBvcnQgeyBUZXh0dXJlIH0gZnJvbSAnLi4vLi4vLi4vZ3JhcGhpY3MvdGV4dHVyZS5qcyc7XG5pbXBvcnQge1xuICAgIFRFWEhJTlRfQVNTRVQsXG4gICAgQUREUkVTU19SRVBFQVQsIEFERFJFU1NfQ0xBTVBfVE9fRURHRSxcbiAgICBGSUxURVJfTkVBUkVTVCxcbiAgICBQSVhFTEZPUk1BVF9SOF9HOF9COF9BOCxcbiAgICBURVhUVVJFVFlQRV9SR0JFXG59IGZyb20gJy4uLy4uLy4uL2dyYXBoaWNzL2NvbnN0YW50cy5qcyc7XG5cbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vLi4vLi4vYXNzZXQvYXNzZXQuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vdGV4dHVyZS5qcycpLlRleHR1cmVQYXJzZXJ9IFRleHR1cmVQYXJzZXIgKi9cblxuLyoqXG4gKiBUZXh0dXJlIHBhcnNlciBmb3IgaGRyIGZpbGVzLlxuICpcbiAqIEBpbXBsZW1lbnRzIHtUZXh0dXJlUGFyc2VyfVxuICogQGlnbm9yZVxuICovXG5jbGFzcyBIZHJQYXJzZXIge1xuICAgIGNvbnN0cnVjdG9yKHJlZ2lzdHJ5KSB7XG4gICAgICAgIHRoaXMubWF4UmV0cmllcyA9IDA7XG4gICAgfVxuXG4gICAgbG9hZCh1cmwsIGNhbGxiYWNrLCBhc3NldCkge1xuICAgICAgICBBc3NldC5mZXRjaEFycmF5QnVmZmVyKHVybC5sb2FkLCBjYWxsYmFjaywgYXNzZXQsIHRoaXMubWF4UmV0cmllcyk7XG4gICAgfVxuXG4gICAgb3Blbih1cmwsIGRhdGEsIGRldmljZSkge1xuICAgICAgICBjb25zdCB0ZXh0dXJlRGF0YSA9IHRoaXMucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgaWYgKCF0ZXh0dXJlRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRleHR1cmUoZGV2aWNlLCB7XG4gICAgICAgICAgICBuYW1lOiB1cmwsXG4gICAgICAgICAgICAvLyAjaWYgX1BST0ZJTEVSXG4gICAgICAgICAgICBwcm9maWxlckhpbnQ6IFRFWEhJTlRfQVNTRVQsXG4gICAgICAgICAgICAvLyAjZW5kaWZcbiAgICAgICAgICAgIGFkZHJlc3NVOiBBRERSRVNTX1JFUEVBVCxcbiAgICAgICAgICAgIGFkZHJlc3NWOiBBRERSRVNTX0NMQU1QX1RPX0VER0UsXG4gICAgICAgICAgICBtaW5GaWx0ZXI6IEZJTFRFUl9ORUFSRVNULFxuICAgICAgICAgICAgbWFnRmlsdGVyOiBGSUxURVJfTkVBUkVTVCxcbiAgICAgICAgICAgIHdpZHRoOiB0ZXh0dXJlRGF0YS53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogdGV4dHVyZURhdGEuaGVpZ2h0LFxuICAgICAgICAgICAgbGV2ZWxzOiB0ZXh0dXJlRGF0YS5sZXZlbHMsXG4gICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1I4X0c4X0I4X0E4LFxuICAgICAgICAgICAgdHlwZTogVEVYVFVSRVRZUEVfUkdCRSxcbiAgICAgICAgICAgIC8vIFJHQkUgY2FuJ3QgYmUgZmlsdGVyZWQsIHNvIG1pcG1hcHMgYXJlIG91dCBvZiB0aGUgcXVlc3Rpb24hICh1bmxlc3Mgd2UgZ2VuZXJhdGVkIHRoZW0gb3Vyc2VsdmVzKVxuICAgICAgICAgICAgbWlwbWFwczogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGV4dHVyZS51cGxvYWQoKTtcblxuICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICB9XG5cbiAgICAvLyBodHRwczovL2Zsb3lkLmxibC5nb3YvcmFkaWFuY2UvcmVmZXIvZmlsZWZtdHMucGRmIHdpdGggaGVscCBmcm9tIGh0dHA6Ly93d3cuZ3JhcGhpY3MuY29ybmVsbC5lZHUvfmJqdy9yZ2JlL3JnYmUuY1xuICAgIHBhcnNlKGRhdGEpIHtcbiAgICAgICAgY29uc3QgcmVhZFN0cmVhbSA9IG5ldyBSZWFkU3RyZWFtKGRhdGEpO1xuXG4gICAgICAgIC8vIHJlcXVpcmUgbWFnaWNcbiAgICAgICAgY29uc3QgbWFnaWMgPSByZWFkU3RyZWFtLnJlYWRMaW5lKCk7XG4gICAgICAgIGlmICghbWFnaWMuc3RhcnRzV2l0aCgnIz9SQURJQU5DRScpKSB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcigncmFkaWFuY2UgaGVhZGVyIGhhcyBpbnZhbGlkIG1hZ2ljJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlYWQgaGVhZGVyIHZhcmlhYmxlc1xuICAgICAgICBjb25zdCB2YXJpYWJsZXMgPSB7IH07XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gcmVhZFN0cmVhbS5yZWFkTGluZSgpO1xuICAgICAgICAgICAgaWYgKGxpbmUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gZW1wdHkgbGluZSBzaWduYWxzIGVuZCBvZiBoZWFkZXJcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsaW5lLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXNbcGFydHNbMF1dID0gcGFydHNbMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gd2UgcmVxdWlyZSBGT1JNQVQgdmFyaWFibGVcbiAgICAgICAgaWYgKCF2YXJpYWJsZXMuaGFzT3duUHJvcGVydHkoJ0ZPUk1BVCcpKSB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcigncmFkaWFuY2UgaGVhZGVyIG1pc3NpbmcgRk9STUFUIHZhcmlhYmxlJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlYWQgdGhlIHJlc29sdXRpb24gc3BlY2lmaWVyXG4gICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSByZWFkU3RyZWFtLnJlYWRMaW5lKCkuc3BsaXQoJyAnKTtcbiAgICAgICAgaWYgKHJlc29sdXRpb24ubGVuZ3RoICE9PSA0KSB7XG4gICAgICAgICAgICBEZWJ1Zy5lcnJvcigncmFkaWFuY2UgaGVhZGVyIGhhcyBpbnZhbGlkIHJlc29sdXRpb24nKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gcGFyc2VJbnQocmVzb2x1dGlvblsxXSwgMTApO1xuICAgICAgICBjb25zdCB3aWR0aCA9IHBhcnNlSW50KHJlc29sdXRpb25bM10sIDEwKTtcbiAgICAgICAgY29uc3QgcGl4ZWxzID0gdGhpcy5fcmVhZFBpeGVscyhyZWFkU3RyZWFtLCB3aWR0aCwgaGVpZ2h0LCByZXNvbHV0aW9uWzBdID09PSAnLVknKTtcblxuICAgICAgICBpZiAoIXBpeGVscykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjcmVhdGUgdGV4dHVyZVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICBsZXZlbHM6IFtwaXhlbHNdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX3JlYWRQaXhlbHMocmVhZFN0cmVhbSwgd2lkdGgsIGhlaWdodCwgZmxpcFkpIHtcbiAgICAgICAgLy8gb3V0IG9mIGJvdW5kc1xuICAgICAgICBpZiAod2lkdGggPCA4IHx8IHdpZHRoID4gMHg3ZmZmKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVhZFBpeGVsc0ZsYXQocmVhZFN0cmVhbSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZ2JlID0gWzAsIDAsIDAsIDBdO1xuXG4gICAgICAgIC8vIGNoZWNrIGZpcnN0IHNjYW5saW5lIHdpZHRoIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBmaWxlIGlzIFJMRVxuICAgICAgICByZWFkU3RyZWFtLnJlYWRBcnJheShyZ2JlKTtcbiAgICAgICAgaWYgKChyZ2JlWzBdICE9PSAyIHx8IHJnYmVbMV0gIT09IDIgfHwgKHJnYmVbMl0gJiAweDgwKSAhPT0gMCkpIHtcbiAgICAgICAgICAgIC8vIG5vdCBSTEVcbiAgICAgICAgICAgIHJlYWRTdHJlYW0uc2tpcCgtNCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVhZFBpeGVsc0ZsYXQocmVhZFN0cmVhbSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBhbGxvY2F0ZSB0ZXh0dXJlIGJ1ZmZlclxuICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiBoZWlnaHQgKiA0KTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgICAgIGxldCBzY2Fuc3RhcnQgPSBmbGlwWSA/IDAgOiB3aWR0aCAqIDQgKiAoaGVpZ2h0IC0gMSk7XG4gICAgICAgIGxldCB4LCB5LCBpLCBjaGFubmVsLCBjb3VudCwgdmFsdWU7XG5cbiAgICAgICAgZm9yICh5ID0gMDsgeSA8IGhlaWdodDsgKyt5KSB7XG4gICAgICAgICAgICAvLyByZWFkIHNjYW5saW5lIHdpZHRoIHNwZWNpZmllclxuICAgICAgICAgICAgaWYgKHkpIHtcbiAgICAgICAgICAgICAgICByZWFkU3RyZWFtLnJlYWRBcnJheShyZ2JlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc2FuaXR5IGNoZWNrIGl0XG4gICAgICAgICAgICBpZiAoKHJnYmVbMl0gPDwgOCkgKyByZ2JlWzNdICE9PSB3aWR0aCkge1xuICAgICAgICAgICAgICAgIERlYnVnLmVycm9yKCdyYWRpYW5jZSBoYXMgaW52YWxpZCBzY2FubGluZSB3aWR0aCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBlYWNoIHNjYW5saW5lIGlzIHN0b3JlZCBieSBjaGFubmVsXG4gICAgICAgICAgICBmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgNDsgKytjaGFubmVsKSB7XG4gICAgICAgICAgICAgICAgeCA9IDA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHggPCB3aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudCA9IHJlYWRTdHJlYW0ucmVhZFU4KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCA+IDEyOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcnVuIG9mIHRoZSBzYW1lIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCAtPSAxMjg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeCArIGNvdW50ID4gd2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWJ1Zy5lcnJvcigncmFkaWFuY2UgaGFzIGludmFsaWQgc2NhbmxpbmUgZGF0YScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByZWFkU3RyZWFtLnJlYWRVOCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NjYW5zdGFydCArIGNoYW5uZWwgKyA0ICogeCsrXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9uLXJ1blxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID09PSAwIHx8IHggKyBjb3VudCA+IHdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVidWcuZXJyb3IoJ3JhZGlhbmNlIGhhcyBpbnZhbGlkIHNjYW5saW5lIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzY2Fuc3RhcnQgKyBjaGFubmVsICsgNCAqIHgrK10gPSByZWFkU3RyZWFtLnJlYWRVOCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY2Fuc3RhcnQgKz0gd2lkdGggKiA0ICogKGZsaXBZID8gMSA6IC0xKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH1cblxuICAgIF9yZWFkUGl4ZWxzRmxhdChyZWFkU3RyZWFtLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHJldHVybiByZWFkU3RyZWFtLnJlbWFpbmluZ0J5dGVzID09PSB3aWR0aCAqIGhlaWdodCAqIDQgPyBuZXcgVWludDhBcnJheShyZWFkU3RyZWFtLmFycmF5YnVmZmVyLCByZWFkU3RyZWFtLm9mZnNldCkgOiBudWxsO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgSGRyUGFyc2VyIH07XG4iXSwibmFtZXMiOlsiSGRyUGFyc2VyIiwiY29uc3RydWN0b3IiLCJyZWdpc3RyeSIsIm1heFJldHJpZXMiLCJsb2FkIiwidXJsIiwiY2FsbGJhY2siLCJhc3NldCIsIkFzc2V0IiwiZmV0Y2hBcnJheUJ1ZmZlciIsIm9wZW4iLCJkYXRhIiwiZGV2aWNlIiwidGV4dHVyZURhdGEiLCJwYXJzZSIsInRleHR1cmUiLCJUZXh0dXJlIiwibmFtZSIsInByb2ZpbGVySGludCIsIlRFWEhJTlRfQVNTRVQiLCJhZGRyZXNzVSIsIkFERFJFU1NfUkVQRUFUIiwiYWRkcmVzc1YiLCJBRERSRVNTX0NMQU1QX1RPX0VER0UiLCJtaW5GaWx0ZXIiLCJGSUxURVJfTkVBUkVTVCIsIm1hZ0ZpbHRlciIsIndpZHRoIiwiaGVpZ2h0IiwibGV2ZWxzIiwiZm9ybWF0IiwiUElYRUxGT1JNQVRfUjhfRzhfQjhfQTgiLCJ0eXBlIiwiVEVYVFVSRVRZUEVfUkdCRSIsIm1pcG1hcHMiLCJ1cGxvYWQiLCJyZWFkU3RyZWFtIiwiUmVhZFN0cmVhbSIsIm1hZ2ljIiwicmVhZExpbmUiLCJzdGFydHNXaXRoIiwiRGVidWciLCJlcnJvciIsInZhcmlhYmxlcyIsImxpbmUiLCJsZW5ndGgiLCJwYXJ0cyIsInNwbGl0IiwiaGFzT3duUHJvcGVydHkiLCJyZXNvbHV0aW9uIiwicGFyc2VJbnQiLCJwaXhlbHMiLCJfcmVhZFBpeGVscyIsImZsaXBZIiwiX3JlYWRQaXhlbHNGbGF0IiwicmdiZSIsInJlYWRBcnJheSIsInNraXAiLCJidWZmZXIiLCJBcnJheUJ1ZmZlciIsInZpZXciLCJVaW50OEFycmF5Iiwic2NhbnN0YXJ0IiwieCIsInkiLCJpIiwiY2hhbm5lbCIsImNvdW50IiwidmFsdWUiLCJyZWFkVTgiLCJyZW1haW5pbmdCeXRlcyIsImFycmF5YnVmZmVyIiwib2Zmc2V0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQXNCQSxNQUFNQSxTQUFOLENBQWdCO0VBQ1pDLFdBQVcsQ0FBQ0MsUUFBRCxFQUFXO0lBQ2xCLElBQUtDLENBQUFBLFVBQUwsR0FBa0IsQ0FBbEIsQ0FBQTtBQUNILEdBQUE7O0FBRURDLEVBQUFBLElBQUksQ0FBQ0MsR0FBRCxFQUFNQyxRQUFOLEVBQWdCQyxLQUFoQixFQUF1QjtBQUN2QkMsSUFBQUEsS0FBSyxDQUFDQyxnQkFBTixDQUF1QkosR0FBRyxDQUFDRCxJQUEzQixFQUFpQ0UsUUFBakMsRUFBMkNDLEtBQTNDLEVBQWtELElBQUEsQ0FBS0osVUFBdkQsQ0FBQSxDQUFBO0FBQ0gsR0FBQTs7QUFFRE8sRUFBQUEsSUFBSSxDQUFDTCxHQUFELEVBQU1NLElBQU4sRUFBWUMsTUFBWixFQUFvQjtBQUNwQixJQUFBLE1BQU1DLFdBQVcsR0FBRyxJQUFBLENBQUtDLEtBQUwsQ0FBV0gsSUFBWCxDQUFwQixDQUFBOztJQUVBLElBQUksQ0FBQ0UsV0FBTCxFQUFrQjtBQUNkLE1BQUEsT0FBTyxJQUFQLENBQUE7QUFDSCxLQUFBOztBQUVELElBQUEsTUFBTUUsT0FBTyxHQUFHLElBQUlDLE9BQUosQ0FBWUosTUFBWixFQUFvQjtBQUNoQ0ssTUFBQUEsSUFBSSxFQUFFWixHQUQwQjtBQUdoQ2EsTUFBQUEsWUFBWSxFQUFFQyxhQUhrQjtBQUtoQ0MsTUFBQUEsUUFBUSxFQUFFQyxjQUxzQjtBQU1oQ0MsTUFBQUEsUUFBUSxFQUFFQyxxQkFOc0I7QUFPaENDLE1BQUFBLFNBQVMsRUFBRUMsY0FQcUI7QUFRaENDLE1BQUFBLFNBQVMsRUFBRUQsY0FScUI7TUFTaENFLEtBQUssRUFBRWQsV0FBVyxDQUFDYyxLQVRhO01BVWhDQyxNQUFNLEVBQUVmLFdBQVcsQ0FBQ2UsTUFWWTtNQVdoQ0MsTUFBTSxFQUFFaEIsV0FBVyxDQUFDZ0IsTUFYWTtBQVloQ0MsTUFBQUEsTUFBTSxFQUFFQyx1QkFad0I7QUFhaENDLE1BQUFBLElBQUksRUFBRUMsZ0JBYjBCO0FBZWhDQyxNQUFBQSxPQUFPLEVBQUUsS0FBQTtBQWZ1QixLQUFwQixDQUFoQixDQUFBO0FBa0JBbkIsSUFBQUEsT0FBTyxDQUFDb0IsTUFBUixFQUFBLENBQUE7QUFFQSxJQUFBLE9BQU9wQixPQUFQLENBQUE7QUFDSCxHQUFBOztFQUdERCxLQUFLLENBQUNILElBQUQsRUFBTztBQUNSLElBQUEsTUFBTXlCLFVBQVUsR0FBRyxJQUFJQyxVQUFKLENBQWUxQixJQUFmLENBQW5CLENBQUE7QUFHQSxJQUFBLE1BQU0yQixLQUFLLEdBQUdGLFVBQVUsQ0FBQ0csUUFBWCxFQUFkLENBQUE7O0FBQ0EsSUFBQSxJQUFJLENBQUNELEtBQUssQ0FBQ0UsVUFBTixDQUFpQixZQUFqQixDQUFMLEVBQXFDO01BQ2pDQyxLQUFLLENBQUNDLEtBQU4sQ0FBWSxtQ0FBWixDQUFBLENBQUE7QUFDQSxNQUFBLE9BQU8sSUFBUCxDQUFBO0FBQ0gsS0FBQTs7SUFHRCxNQUFNQyxTQUFTLEdBQUcsRUFBbEIsQ0FBQTs7QUFDQSxJQUFBLE9BQU8sSUFBUCxFQUFhO0FBQ1QsTUFBQSxNQUFNQyxJQUFJLEdBQUdSLFVBQVUsQ0FBQ0csUUFBWCxFQUFiLENBQUE7O0FBQ0EsTUFBQSxJQUFJSyxJQUFJLENBQUNDLE1BQUwsS0FBZ0IsQ0FBcEIsRUFBdUI7QUFFbkIsUUFBQSxNQUFBO0FBQ0gsT0FIRCxNQUdPO0FBQ0gsUUFBQSxNQUFNQyxLQUFLLEdBQUdGLElBQUksQ0FBQ0csS0FBTCxDQUFXLEdBQVgsQ0FBZCxDQUFBOztBQUNBLFFBQUEsSUFBSUQsS0FBSyxDQUFDRCxNQUFOLEtBQWlCLENBQXJCLEVBQXdCO1VBQ3BCRixTQUFTLENBQUNHLEtBQUssQ0FBQyxDQUFELENBQU4sQ0FBVCxHQUFzQkEsS0FBSyxDQUFDLENBQUQsQ0FBM0IsQ0FBQTtBQUNILFNBQUE7QUFDSixPQUFBO0FBQ0osS0FBQTs7QUFHRCxJQUFBLElBQUksQ0FBQ0gsU0FBUyxDQUFDSyxjQUFWLENBQXlCLFFBQXpCLENBQUwsRUFBeUM7TUFDckNQLEtBQUssQ0FBQ0MsS0FBTixDQUFZLHlDQUFaLENBQUEsQ0FBQTtBQUNBLE1BQUEsT0FBTyxJQUFQLENBQUE7QUFDSCxLQUFBOztJQUdELE1BQU1PLFVBQVUsR0FBR2IsVUFBVSxDQUFDRyxRQUFYLEVBQXNCUSxDQUFBQSxLQUF0QixDQUE0QixHQUE1QixDQUFuQixDQUFBOztBQUNBLElBQUEsSUFBSUUsVUFBVSxDQUFDSixNQUFYLEtBQXNCLENBQTFCLEVBQTZCO01BQ3pCSixLQUFLLENBQUNDLEtBQU4sQ0FBWSx3Q0FBWixDQUFBLENBQUE7QUFDQSxNQUFBLE9BQU8sSUFBUCxDQUFBO0FBQ0gsS0FBQTs7SUFFRCxNQUFNZCxNQUFNLEdBQUdzQixRQUFRLENBQUNELFVBQVUsQ0FBQyxDQUFELENBQVgsRUFBZ0IsRUFBaEIsQ0FBdkIsQ0FBQTtJQUNBLE1BQU10QixLQUFLLEdBQUd1QixRQUFRLENBQUNELFVBQVUsQ0FBQyxDQUFELENBQVgsRUFBZ0IsRUFBaEIsQ0FBdEIsQ0FBQTs7QUFDQSxJQUFBLE1BQU1FLE1BQU0sR0FBRyxJQUFBLENBQUtDLFdBQUwsQ0FBaUJoQixVQUFqQixFQUE2QlQsS0FBN0IsRUFBb0NDLE1BQXBDLEVBQTRDcUIsVUFBVSxDQUFDLENBQUQsQ0FBVixLQUFrQixJQUE5RCxDQUFmLENBQUE7O0lBRUEsSUFBSSxDQUFDRSxNQUFMLEVBQWE7QUFDVCxNQUFBLE9BQU8sSUFBUCxDQUFBO0FBQ0gsS0FBQTs7SUFHRCxPQUFPO0FBQ0h4QixNQUFBQSxLQUFLLEVBQUVBLEtBREo7QUFFSEMsTUFBQUEsTUFBTSxFQUFFQSxNQUZMO01BR0hDLE1BQU0sRUFBRSxDQUFDc0IsTUFBRCxDQUFBO0tBSFosQ0FBQTtBQUtILEdBQUE7O0VBRURDLFdBQVcsQ0FBQ2hCLFVBQUQsRUFBYVQsS0FBYixFQUFvQkMsTUFBcEIsRUFBNEJ5QixLQUE1QixFQUFtQztBQUUxQyxJQUFBLElBQUkxQixLQUFLLEdBQUcsQ0FBUixJQUFhQSxLQUFLLEdBQUcsTUFBekIsRUFBaUM7TUFDN0IsT0FBTyxJQUFBLENBQUsyQixlQUFMLENBQXFCbEIsVUFBckIsRUFBaUNULEtBQWpDLEVBQXdDQyxNQUF4QyxDQUFQLENBQUE7QUFDSCxLQUFBOztJQUVELE1BQU0yQixJQUFJLEdBQUcsQ0FBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQVAsRUFBVSxDQUFWLENBQWIsQ0FBQTtJQUdBbkIsVUFBVSxDQUFDb0IsU0FBWCxDQUFxQkQsSUFBckIsQ0FBQSxDQUFBOztJQUNBLElBQUtBLElBQUksQ0FBQyxDQUFELENBQUosS0FBWSxDQUFaLElBQWlCQSxJQUFJLENBQUMsQ0FBRCxDQUFKLEtBQVksQ0FBN0IsSUFBa0MsQ0FBQ0EsSUFBSSxDQUFDLENBQUQsQ0FBSixHQUFVLElBQVgsTUFBcUIsQ0FBNUQsRUFBZ0U7QUFFNURuQixNQUFBQSxVQUFVLENBQUNxQixJQUFYLENBQWdCLENBQUMsQ0FBakIsQ0FBQSxDQUFBO01BQ0EsT0FBTyxJQUFBLENBQUtILGVBQUwsQ0FBcUJsQixVQUFyQixFQUFpQ1QsS0FBakMsRUFBd0NDLE1BQXhDLENBQVAsQ0FBQTtBQUNILEtBQUE7O0lBR0QsTUFBTThCLE1BQU0sR0FBRyxJQUFJQyxXQUFKLENBQWdCaEMsS0FBSyxHQUFHQyxNQUFSLEdBQWlCLENBQWpDLENBQWYsQ0FBQTtBQUNBLElBQUEsTUFBTWdDLElBQUksR0FBRyxJQUFJQyxVQUFKLENBQWVILE1BQWYsQ0FBYixDQUFBO0FBQ0EsSUFBQSxJQUFJSSxTQUFTLEdBQUdULEtBQUssR0FBRyxDQUFILEdBQU8xQixLQUFLLEdBQUcsQ0FBUixJQUFhQyxNQUFNLEdBQUcsQ0FBdEIsQ0FBNUIsQ0FBQTtJQUNBLElBQUltQyxDQUFKLEVBQU9DLENBQVAsRUFBVUMsQ0FBVixFQUFhQyxPQUFiLEVBQXNCQyxLQUF0QixFQUE2QkMsS0FBN0IsQ0FBQTs7SUFFQSxLQUFLSixDQUFDLEdBQUcsQ0FBVCxFQUFZQSxDQUFDLEdBQUdwQyxNQUFoQixFQUF3QixFQUFFb0MsQ0FBMUIsRUFBNkI7QUFFekIsTUFBQSxJQUFJQSxDQUFKLEVBQU87UUFDSDVCLFVBQVUsQ0FBQ29CLFNBQVgsQ0FBcUJELElBQXJCLENBQUEsQ0FBQTtBQUNILE9BQUE7O0FBR0QsTUFBQSxJQUFJLENBQUNBLElBQUksQ0FBQyxDQUFELENBQUosSUFBVyxDQUFaLElBQWlCQSxJQUFJLENBQUMsQ0FBRCxDQUFyQixLQUE2QjVCLEtBQWpDLEVBQXdDO1FBQ3BDYyxLQUFLLENBQUNDLEtBQU4sQ0FBWSxxQ0FBWixDQUFBLENBQUE7QUFDQSxRQUFBLE9BQU8sSUFBUCxDQUFBO0FBQ0gsT0FBQTs7TUFHRCxLQUFLd0IsT0FBTyxHQUFHLENBQWYsRUFBa0JBLE9BQU8sR0FBRyxDQUE1QixFQUErQixFQUFFQSxPQUFqQyxFQUEwQztBQUN0Q0gsUUFBQUEsQ0FBQyxHQUFHLENBQUosQ0FBQTs7UUFDQSxPQUFPQSxDQUFDLEdBQUdwQyxLQUFYLEVBQWtCO0FBQ2R3QyxVQUFBQSxLQUFLLEdBQUcvQixVQUFVLENBQUNpQyxNQUFYLEVBQVIsQ0FBQTs7VUFDQSxJQUFJRixLQUFLLEdBQUcsR0FBWixFQUFpQjtBQUViQSxZQUFBQSxLQUFLLElBQUksR0FBVCxDQUFBOztBQUNBLFlBQUEsSUFBSUosQ0FBQyxHQUFHSSxLQUFKLEdBQVl4QyxLQUFoQixFQUF1QjtjQUNuQmMsS0FBSyxDQUFDQyxLQUFOLENBQVksb0NBQVosQ0FBQSxDQUFBO0FBQ0EsY0FBQSxPQUFPLElBQVAsQ0FBQTtBQUNILGFBQUE7O0FBQ0QwQixZQUFBQSxLQUFLLEdBQUdoQyxVQUFVLENBQUNpQyxNQUFYLEVBQVIsQ0FBQTs7WUFDQSxLQUFLSixDQUFDLEdBQUcsQ0FBVCxFQUFZQSxDQUFDLEdBQUdFLEtBQWhCLEVBQXVCLEVBQUVGLENBQXpCLEVBQTRCO2NBQ3hCTCxJQUFJLENBQUNFLFNBQVMsR0FBR0ksT0FBWixHQUFzQixJQUFJSCxDQUFDLEVBQTVCLENBQUosR0FBc0NLLEtBQXRDLENBQUE7QUFDSCxhQUFBO0FBQ0osV0FYRCxNQVdPO1lBRUgsSUFBSUQsS0FBSyxLQUFLLENBQVYsSUFBZUosQ0FBQyxHQUFHSSxLQUFKLEdBQVl4QyxLQUEvQixFQUFzQztjQUNsQ2MsS0FBSyxDQUFDQyxLQUFOLENBQVksb0NBQVosQ0FBQSxDQUFBO0FBQ0EsY0FBQSxPQUFPLElBQVAsQ0FBQTtBQUNILGFBQUE7O1lBQ0QsS0FBS3VCLENBQUMsR0FBRyxDQUFULEVBQVlBLENBQUMsR0FBR0UsS0FBaEIsRUFBdUIsRUFBRUYsQ0FBekIsRUFBNEI7QUFDeEJMLGNBQUFBLElBQUksQ0FBQ0UsU0FBUyxHQUFHSSxPQUFaLEdBQXNCLENBQUEsR0FBSUgsQ0FBQyxFQUE1QixDQUFKLEdBQXNDM0IsVUFBVSxDQUFDaUMsTUFBWCxFQUF0QyxDQUFBO0FBQ0gsYUFBQTtBQUNKLFdBQUE7QUFDSixTQUFBO0FBQ0osT0FBQTs7TUFFRFAsU0FBUyxJQUFJbkMsS0FBSyxHQUFHLENBQVIsSUFBYTBCLEtBQUssR0FBRyxDQUFILEdBQU8sQ0FBQyxDQUExQixDQUFiLENBQUE7QUFDSCxLQUFBOztBQUVELElBQUEsT0FBT08sSUFBUCxDQUFBO0FBQ0gsR0FBQTs7QUFFRE4sRUFBQUEsZUFBZSxDQUFDbEIsVUFBRCxFQUFhVCxLQUFiLEVBQW9CQyxNQUFwQixFQUE0QjtJQUN2QyxPQUFPUSxVQUFVLENBQUNrQyxjQUFYLEtBQThCM0MsS0FBSyxHQUFHQyxNQUFSLEdBQWlCLENBQS9DLEdBQW1ELElBQUlpQyxVQUFKLENBQWV6QixVQUFVLENBQUNtQyxXQUExQixFQUF1Q25DLFVBQVUsQ0FBQ29DLE1BQWxELENBQW5ELEdBQStHLElBQXRILENBQUE7QUFDSCxHQUFBOztBQXJLVzs7OzsifQ==
