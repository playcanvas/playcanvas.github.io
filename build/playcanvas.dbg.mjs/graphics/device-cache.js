/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class DeviceCache {
  constructor() {
    this._cache = new Map();
  }

  get(device, onCreate) {
    if (!this._cache.has(device)) {
      this._cache.set(device, onCreate());

      device.on('destroy', () => {
        this.remove(device);
      });
    }

    return this._cache.get(device);
  }

  remove(device) {
    var _this$_cache$get;

    (_this$_cache$get = this._cache.get(device)) == null ? void 0 : _this$_cache$get.destroy();

    this._cache.delete(device);
  }

}

export { DeviceCache };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNlLWNhY2hlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZ3JhcGhpY3MvZGV2aWNlLWNhY2hlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2dyYXBoaWNzLWRldmljZS5qcycpLkdyYXBoaWNzRGV2aWNlfSBHcmFwaGljc0RldmljZSAqL1xuXG4vKipcbiAqIEEgY2FjaGUgc3RvcmluZyBzaGFyZWQgcmVzb3VyY2VzIGFzc29jaWF0ZWQgd2l0aCBhIGRldmljZS4gVGhlIHJlc291cmNlcyBhcmUgcmVtb3ZlZFxuICogZnJvbSB0aGUgY2FjaGUgd2hlbiB0aGUgZGV2aWNlIGlzIGRlc3Ryb3llZC5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIERldmljZUNhY2hlIHtcbiAgICAvKipcbiAgICAgKiBDYWNoZSBzdG9yaW5nIHRoZSByZXNvdXJjZSBmb3IgZWFjaCBHcmFwaGljc0RldmljZVxuICAgICAqXG4gICAgICogQHR5cGUge01hcDxHcmFwaGljc0RldmljZSwgYW55Pn1cbiAgICAgKi9cbiAgICBfY2FjaGUgPSBuZXcgTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXNvdXJjZXMgZm9yIHRoZSBzdXBwbGllZCBkZXZpY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0dyYXBoaWNzRGV2aWNlfSBkZXZpY2UgLSBUaGUgZ3JhcGhpY3MgZGV2aWNlLlxuICAgICAqIEByZXR1cm5zIHthbnl9IFRoZSByZXNvdXJjZSBmb3IgdGhlIGRldmljZS5cbiAgICAgKi9cbiAgICBnZXQoZGV2aWNlLCBvbkNyZWF0ZSkge1xuXG4gICAgICAgIGlmICghdGhpcy5fY2FjaGUuaGFzKGRldmljZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLnNldChkZXZpY2UsIG9uQ3JlYXRlKCkpO1xuXG4gICAgICAgICAgICAvLyB3aGVuIHRoZSBkZXZpY2UgaXMgZGVzdHJveWVkLCBkZXN0cm95IGFuZCByZW1vdmUgaXRzIGVudHJ5XG4gICAgICAgICAgICBkZXZpY2Uub24oJ2Rlc3Ryb3knLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGV2aWNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlLmdldChkZXZpY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3llcyBhbmQgcmVtb3ZlcyB0aGUgY29udGVudCBvZiB0aGUgY2FjaGUgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZXZpY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7R3JhcGhpY3NEZXZpY2V9IGRldmljZSAtIFRoZSBncmFwaGljcyBkZXZpY2UuXG4gICAgICovXG4gICAgcmVtb3ZlKGRldmljZSkge1xuICAgICAgICB0aGlzLl9jYWNoZS5nZXQoZGV2aWNlKT8uZGVzdHJveSgpO1xuICAgICAgICB0aGlzLl9jYWNoZS5kZWxldGUoZGV2aWNlKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IERldmljZUNhY2hlIH07XG4iXSwibmFtZXMiOlsiRGV2aWNlQ2FjaGUiLCJfY2FjaGUiLCJNYXAiLCJnZXQiLCJkZXZpY2UiLCJvbkNyZWF0ZSIsImhhcyIsInNldCIsIm9uIiwicmVtb3ZlIiwiZGVzdHJveSIsImRlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFRQSxNQUFNQSxXQUFOLENBQWtCO0FBQUEsRUFBQSxXQUFBLEdBQUE7QUFBQSxJQUFBLElBQUEsQ0FNZEMsTUFOYyxHQU1MLElBQUlDLEdBQUosRUFOSyxDQUFBO0FBQUEsR0FBQTs7QUFjZEMsRUFBQUEsR0FBRyxDQUFDQyxNQUFELEVBQVNDLFFBQVQsRUFBbUI7SUFFbEIsSUFBSSxDQUFDLEtBQUtKLE1BQUwsQ0FBWUssR0FBWixDQUFnQkYsTUFBaEIsQ0FBTCxFQUE4QjtBQUMxQixNQUFBLElBQUEsQ0FBS0gsTUFBTCxDQUFZTSxHQUFaLENBQWdCSCxNQUFoQixFQUF3QkMsUUFBUSxFQUFoQyxDQUFBLENBQUE7O0FBR0FELE1BQUFBLE1BQU0sQ0FBQ0ksRUFBUCxDQUFVLFNBQVYsRUFBcUIsTUFBTTtRQUN2QixJQUFLQyxDQUFBQSxNQUFMLENBQVlMLE1BQVosQ0FBQSxDQUFBO09BREosQ0FBQSxDQUFBO0FBR0gsS0FBQTs7QUFFRCxJQUFBLE9BQU8sS0FBS0gsTUFBTCxDQUFZRSxHQUFaLENBQWdCQyxNQUFoQixDQUFQLENBQUE7QUFDSCxHQUFBOztFQU9ESyxNQUFNLENBQUNMLE1BQUQsRUFBUztBQUFBLElBQUEsSUFBQSxnQkFBQSxDQUFBOztBQUNYLElBQUEsQ0FBQSxnQkFBQSxHQUFBLElBQUEsQ0FBS0gsTUFBTCxDQUFZRSxHQUFaLENBQWdCQyxNQUFoQix1Q0FBeUJNLE9BQXpCLEVBQUEsQ0FBQTs7QUFDQSxJQUFBLElBQUEsQ0FBS1QsTUFBTCxDQUFZVSxNQUFaLENBQW1CUCxNQUFuQixDQUFBLENBQUE7QUFDSCxHQUFBOztBQXBDYTs7OzsifQ==
