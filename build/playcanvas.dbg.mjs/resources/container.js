/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { path } from '../core/path.js';
import { GlbParser } from './parser/glb-parser.js';

class ContainerResource {
  instantiateModelEntity(options) {
    return null;
  }

  instantiateRenderEntity(options) {
    return null;
  }

  getMaterialVariants() {
    return null;
  }

  applyMaterialVariant(entity, name) {}

  applyMaterialVariantInstances(instances, name) {}

}

class ContainerHandler {
  constructor(app) {
    this.handlerType = "container";
    this.glbParser = new GlbParser(app.graphicsDevice, app.assets, 0);
    this.parsers = {};
  }

  set maxRetries(value) {
    this.glbParser.maxRetries = value;

    for (const parser in this.parsers) {
      if (this.parsers.hasOwnProperty(parser)) {
        this.parsers[parser].maxRetries = value;
      }
    }
  }

  get maxRetries() {
    return this.glbParser.maxRetries;
  }

  _getUrlWithoutParams(url) {
    return url.indexOf('?') >= 0 ? url.split('?')[0] : url;
  }

  _getParser(url) {
    const ext = url ? path.getExtension(this._getUrlWithoutParams(url)).toLowerCase().replace('.', '') : null;
    return this.parsers[ext] || this.glbParser;
  }

  load(url, callback, asset) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }

    this._getParser(url.original).load(url, callback, asset);
  }

  open(url, data, asset) {
    return this._getParser(url).open(url, data, asset);
  }

  patch(asset, assets) {}

}

export { ContainerHandler, ContainerResource };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvcmVzb3VyY2VzL2NvbnRhaW5lci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXRoIH0gZnJvbSAnLi4vY29yZS9wYXRoLmpzJztcbmltcG9ydCB7IEdsYlBhcnNlciB9IGZyb20gJy4vcGFyc2VyL2dsYi1wYXJzZXIuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vZnJhbWV3b3JrL2VudGl0eS5qcycpLkVudGl0eX0gRW50aXR5ICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vc2NlbmUvbWVzaC1pbnN0YW5jZScpLk1lc2hJbnN0YW5jZX0gTWVzaEluc3RhbmNlICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vZnJhbWV3b3JrL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gQXBwQmFzZSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vaGFuZGxlci5qcycpLlJlc291cmNlSGFuZGxlcn0gUmVzb3VyY2VIYW5kbGVyICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi9oYW5kbGVyLmpzJykuUmVzb3VyY2VIYW5kbGVyQ2FsbGJhY2t9IFJlc291cmNlSGFuZGxlckNhbGxiYWNrICovXG5cbi8qKlxuICogQGludGVyZmFjZVxuICogQG5hbWUgQ29udGFpbmVyUmVzb3VyY2VcbiAqIEBkZXNjcmlwdGlvbiBDb250YWluZXIgZm9yIGEgbGlzdCBvZiBhbmltYXRpb25zLCB0ZXh0dXJlcywgbWF0ZXJpYWxzLCByZW5kZXJzIGFuZCBhIG1vZGVsLlxuICovXG5jbGFzcyBDb250YWluZXJSZXNvdXJjZSB7XG4gICAgLyoqXG4gICAgICogSW5zdGFudGlhdGVzIGFuIGVudGl0eSB3aXRoIGEgbW9kZWwgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBpbml0aWFsaXphdGlvbiBkYXRhIGZvciB0aGUgbW9kZWwgY29tcG9uZW50IHR5cGVcbiAgICAgKiB7QGxpbmsgTW9kZWxDb21wb25lbnR9LlxuICAgICAqIEByZXR1cm5zIHtFbnRpdHl9IEEgc2luZ2xlIGVudGl0eSB3aXRoIGEgbW9kZWwgY29tcG9uZW50LiBNb2RlbCBjb21wb25lbnQgaW50ZXJuYWxseVxuICAgICAqIGNvbnRhaW5zIGEgaGllcmFyY2h5IGJhc2VkIG9uIHtAbGluayBHcmFwaE5vZGV9LlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gbG9hZCBhIGdsYiBmaWxlIGFuZCBpbnN0YW50aWF0ZSBhbiBlbnRpdHkgd2l0aCBhIG1vZGVsIGNvbXBvbmVudCBiYXNlZCBvbiBpdFxuICAgICAqIGFwcC5hc3NldHMubG9hZEZyb21VcmwoXCJzdGF0dWUuZ2xiXCIsIFwiY29udGFpbmVyXCIsIGZ1bmN0aW9uIChlcnIsIGFzc2V0KSB7XG4gICAgICogICAgIHZhciBlbnRpdHkgPSBhc3NldC5yZXNvdXJjZS5pbnN0YW50aWF0ZU1vZGVsRW50aXR5KHtcbiAgICAgKiAgICAgICAgIGNhc3RTaGFkb3dzOiB0cnVlXG4gICAgICogICAgIH0pO1xuICAgICAqICAgICBhcHAucm9vdC5hZGRDaGlsZChlbnRpdHkpO1xuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGluc3RhbnRpYXRlTW9kZWxFbnRpdHkob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnN0YW50aWF0ZXMgYW4gZW50aXR5IHdpdGggYSByZW5kZXIgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBpbml0aWFsaXphdGlvbiBkYXRhIGZvciB0aGUgcmVuZGVyIGNvbXBvbmVudCB0eXBlXG4gICAgICoge0BsaW5rIFJlbmRlckNvbXBvbmVudH0uXG4gICAgICogQHJldHVybnMge0VudGl0eX0gQSBoaWVyYXJjaHkgb2YgZW50aXRpZXMgd2l0aCByZW5kZXIgY29tcG9uZW50cyBvbiBlbnRpdGllcyBjb250YWluaW5nXG4gICAgICogcmVuZGVyYWJsZSBnZW9tZXRyeS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGxvYWQgYSBnbGIgZmlsZSBhbmQgaW5zdGFudGlhdGUgYW4gZW50aXR5IHdpdGggYSByZW5kZXIgY29tcG9uZW50IGJhc2VkIG9uIGl0XG4gICAgICogYXBwLmFzc2V0cy5sb2FkRnJvbVVybChcInN0YXR1ZS5nbGJcIiwgXCJjb250YWluZXJcIiwgZnVuY3Rpb24gKGVyciwgYXNzZXQpIHtcbiAgICAgKiAgICAgdmFyIGVudGl0eSA9IGFzc2V0LnJlc291cmNlLmluc3RhbnRpYXRlUmVuZGVyRW50aXR5KHtcbiAgICAgKiAgICAgICAgIGNhc3RTaGFkb3dzOiB0cnVlXG4gICAgICogICAgIH0pO1xuICAgICAqICAgICBhcHAucm9vdC5hZGRDaGlsZChlbnRpdHkpO1xuICAgICAqXG4gICAgICogICAgIC8vIGZpbmQgYWxsIHJlbmRlciBjb21wb25lbnRzIGNvbnRhaW5pbmcgbWVzaCBpbnN0YW5jZXMsIGFuZCBjaGFuZ2UgYmxlbmQgbW9kZSBvbiB0aGVpciBtYXRlcmlhbHNcbiAgICAgKiAgICAgdmFyIHJlbmRlcnMgPSBlbnRpdHkuZmluZENvbXBvbmVudHMoXCJyZW5kZXJcIik7XG4gICAgICogICAgIHJlbmRlcnMuZm9yRWFjaChmdW5jdGlvbiAocmVuZGVyKSB7XG4gICAgICogICAgICAgICByZW5kZXIubWVzaEluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChtZXNoSW5zdGFuY2UpIHtcbiAgICAgKiAgICAgICAgICAgICBtZXNoSW5zdGFuY2UubWF0ZXJpYWwuYmxlbmRUeXBlID0gcGMuQkxFTkRfTVVMVElQTElDQVRJVkU7XG4gICAgICogICAgICAgICAgICAgbWVzaEluc3RhbmNlLm1hdGVyaWFsLnVwZGF0ZSgpO1xuICAgICAqICAgICAgICAgfSk7XG4gICAgICogICAgIH0pO1xuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGluc3RhbnRpYXRlUmVuZGVyRW50aXR5KG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUXVlcmllcyB0aGUgbGlzdCBvZiBhdmFpbGFibGUgbWF0ZXJpYWwgdmFyaWFudHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IEFuIGFycmF5IG9mIHZhcmlhbnQgbmFtZXMuXG4gICAgICovXG4gICAgZ2V0TWF0ZXJpYWxWYXJpYW50cygpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhIG1hdGVyaWFsIHZhcmlhbnQgdG8gYW4gZW50aXR5IGhpZXJhcmNoeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgLSBUaGUgZW50aXR5IHJvb3QgdG8gd2hpY2ggbWF0ZXJpYWwgdmFyaWFudHMgd2lsbCBiZSBhcHBsaWVkXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtuYW1lXSAtIFRoZSBuYW1lIG9mIHRoZSB2YXJpYW50LCBhcyBxdWVyaWVkIGZyb20gZ2V0TWF0ZXJpYWxWYXJpYW50cyxcbiAgICAgKiBpZiBudWxsIHRoZSB2YXJpYW50IHdpbGwgYmUgcmVzZXQgdG8gdGhlIGRlZmF1bHRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGxvYWQgYSBnbGIgZmlsZSBhbmQgaW5zdGFudGlhdGUgYW4gZW50aXR5IHdpdGggYSByZW5kZXIgY29tcG9uZW50IGJhc2VkIG9uIGl0XG4gICAgICogYXBwLmFzc2V0cy5sb2FkRnJvbVVybChcInN0YXR1ZS5nbGJcIiwgXCJjb250YWluZXJcIiwgZnVuY3Rpb24gKGVyciwgYXNzZXQpIHtcbiAgICAgKiAgICAgdmFyIGVudGl0eSA9IGFzc2V0LnJlc291cmNlLmluc3RhbnRpYXRlUmVuZGVyRW50aXR5KHtcbiAgICAgKiAgICAgICAgIGNhc3RTaGFkb3dzOiB0cnVlXG4gICAgICogICAgIH0pO1xuICAgICAqICAgICBhcHAucm9vdC5hZGRDaGlsZChlbnRpdHkpO1xuICAgICAqICAgICB2YXIgbWF0ZXJpYWxWYXJpYW50cyA9IGFzc2V0LnJlc291cmNlLmdldE1hdGVyaWFsVmFyaWFudHMoKTtcbiAgICAgKiAgICAgYXNzZXQucmVzb3VyY2UuYXBwbHlNYXRlcmlhbFZhcmlhbnQoZW50aXR5LCBtYXRlcmlhbFZhcmlhbnRzWzBdKTtcbiAgICAgKi9cbiAgICBhcHBseU1hdGVyaWFsVmFyaWFudChlbnRpdHksIG5hbWUpIHt9XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGEgbWF0ZXJpYWwgdmFyaWFudCB0byBhIHNldCBvZiBtZXNoIGluc3RhbmNlcy4gQ29tcGFyZWQgdG8gdGhlIGFwcGx5TWF0ZXJpYWxWYXJpYW50LFxuICAgICAqIHRoaXMgbWV0aG9kIGFsbG93cyBmb3Igc2V0dGluZyB0aGUgdmFyaWFudCBvbiBhIHNwZWNpZmljIHNldCBvZiBtZXNoIGluc3RhbmNlcyBpbnN0ZWFkIG9mIHRoZVxuICAgICAqIHdob2xlIGVudGl0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TWVzaEluc3RhbmNlW119IGluc3RhbmNlcyAtIEFuIGFycmF5IG9mIG1lc2ggaW5zdGFuY2VzXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtuYW1lXSAtIFRoZSB0aGUgbmFtZSBvZiB0aGUgdmFyaWFudCwgYXMgcXVlcmVkIGZyb20gZ2V0TWF0ZXJpYWxWYXJpYW50cyxcbiAgICAgKiBpZiBudWxsIHRoZSB2YXJpYW50IHdpbGwgYmUgcmVzZXQgdG8gdGhlIGRlZmF1bHRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGxvYWQgYSBnbGIgZmlsZSBhbmQgaW5zdGFudGlhdGUgYW4gZW50aXR5IHdpdGggYSByZW5kZXIgY29tcG9uZW50IGJhc2VkIG9uIGl0XG4gICAgICogYXBwLmFzc2V0cy5sb2FkRnJvbVVybChcInN0YXR1ZS5nbGJcIiwgXCJjb250YWluZXJcIiwgZnVuY3Rpb24gKGVyciwgYXNzZXQpIHtcbiAgICAgKiAgICAgdmFyIGVudGl0eSA9IGFzc2V0LnJlc291cmNlLmluc3RhbnRpYXRlUmVuZGVyRW50aXR5KHtcbiAgICAgKiAgICAgICAgIGNhc3RTaGFkb3dzOiB0cnVlXG4gICAgICogICAgIH0pO1xuICAgICAqICAgICBhcHAucm9vdC5hZGRDaGlsZChlbnRpdHkpO1xuICAgICAqICAgICB2YXIgbWF0ZXJpYWxWYXJpYW50cyA9IGFzc2V0LnJlc291cmNlLmdldE1hdGVyaWFsVmFyaWFudHMoKTtcbiAgICAgKiAgICAgdmFyIHJlbmRlcnMgPSBlbnRpdHkuZmluZENvbXBvbmVudHMoXCJyZW5kZXJcIik7XG4gICAgICogICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVuZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAqICAgICAgICAgdmFyIHJlbmRlckNvbXBvbmVudCA9IHJlbmRlcnNbaV07XG4gICAgICogICAgICAgICBhc3NldC5yZXNvdXJjZS5hcHBseU1hdGVyaWFsVmFyaWFudEluc3RhbmNlcyhyZW5kZXJDb21wb25lbnQubWVzaEluc3RhbmNlcywgbWF0ZXJpYWxWYXJpYW50c1swXSk7XG4gICAgICogICAgIH1cbiAgICAgKi9cbiAgICBhcHBseU1hdGVyaWFsVmFyaWFudEluc3RhbmNlcyhpbnN0YW5jZXMsIG5hbWUpIHt9XG59XG5cbi8qKlxuICogTG9hZHMgZmlsZXMgdGhhdCBjb250YWluIG11bHRpcGxlIHJlc291cmNlcy4gRm9yIGV4YW1wbGUgZ2xURiBmaWxlcyBjYW4gY29udGFpbiB0ZXh0dXJlcywgbW9kZWxzXG4gKiBhbmQgYW5pbWF0aW9ucy5cbiAqXG4gKiBGb3IgZ2xURiBmaWxlcywgdGhlIGFzc2V0IG9wdGlvbnMgb2JqZWN0IGNhbiBiZSB1c2VkIHRvIHBhc3MgbG9hZCB0aW1lIGNhbGxiYWNrcyBmb3IgaGFuZGxpbmdcbiAqIHRoZSB2YXJpb3VzIHJlc291cmNlcyBhdCBkaWZmZXJlbnQgc3RhZ2VzIG9mIGxvYWRpbmcuIFRoZSB0YWJsZSBiZWxvdyBsaXN0cyB0aGUgcmVzb3VyY2UgdHlwZXNcbiAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBzdXBwb3J0ZWQgcHJvY2VzcyBmdW5jdGlvbnMuXG4gKlxuICogYGBgXG4gKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICogfCAgcmVzb3VyY2UgICB8ICBwcmVwcm9jZXNzIHwgICBwcm9jZXNzICAgfHByb2Nlc3NBc3luYyB8IHBvc3Rwcm9jZXNzIHxcbiAqIHwtLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS18XG4gKiB8IGdsb2JhbCAgICAgIHwgICAgICB4ICAgICAgfCAgICAgICAgICAgICB8ICAgICAgICAgICAgIHwgICAgICB4ICAgICAgfFxuICogfCBub2RlICAgICAgICB8ICAgICAgeCAgICAgIHwgICAgICB4ICAgICAgfCAgICAgICAgICAgICB8ICAgICAgeCAgICAgIHxcbiAqIHwgbGlnaHQgICAgICAgfCAgICAgIHggICAgICB8ICAgICAgeCAgICAgIHwgICAgICAgICAgICAgfCAgICAgIHggICAgICB8XG4gKiB8IGNhbWVyYSAgICAgIHwgICAgICB4ICAgICAgfCAgICAgIHggICAgICB8ICAgICAgICAgICAgIHwgICAgICB4ICAgICAgfFxuICogfCBhbmltYXRpb24gICB8ICAgICAgeCAgICAgIHwgICAgICAgICAgICAgfCAgICAgICAgICAgICB8ICAgICAgeCAgICAgIHxcbiAqIHwgbWF0ZXJpYWwgICAgfCAgICAgIHggICAgICB8ICAgICAgeCAgICAgIHwgICAgICAgICAgICAgfCAgICAgIHggICAgICB8XG4gKiB8IGltYWdlICAgICAgIHwgICAgICB4ICAgICAgfCAgICAgICAgICAgICB8ICAgICAgeCAgICAgIHwgICAgICB4ICAgICAgfFxuICogfCB0ZXh0dXJlICAgICB8ICAgICAgeCAgICAgIHwgICAgICAgICAgICAgfCAgICAgIHggICAgICB8ICAgICAgeCAgICAgIHxcbiAqIHwgYnVmZmVyICAgICAgfCAgICAgIHggICAgICB8ICAgICAgICAgICAgIHwgICAgICB4ICAgICAgfCAgICAgIHggICAgICB8XG4gKiB8IGJ1ZmZlclZpZXcgIHwgICAgICB4ICAgICAgfCAgICAgICAgICAgICB8ICAgICAgeCAgICAgIHwgICAgICB4ICAgICAgfFxuICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbiAqIGBgYFxuICpcbiAqIEFkZGl0aW9uYWwgb3B0aW9ucyB0aGF0IGNhbiBiZSBwYXNzZWQgZm9yIGdsVEYgZmlsZXM6XG4gKiBbb3B0aW9ucy5tb3JwaFByZXNlcnZlRGF0YV0gLSBXaGVuIHRydWUsIHRoZSBtb3JwaCB0YXJnZXQga2VlcHMgaXRzIGRhdGEgcGFzc2VkIHVzaW5nIHRoZSBvcHRpb25zLFxuICogYWxsb3dpbmcgdGhlIGNsb25lIG9wZXJhdGlvbi5cbiAqXG4gKiBGb3IgZXhhbXBsZSwgdG8gcmVjZWl2ZSBhIHRleHR1cmUgcHJlcHJvY2VzcyBjYWxsYmFjazpcbiAqXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiB2YXIgY29udGFpbmVyQXNzZXQgPSBuZXcgcGMuQXNzZXQoZmlsZW5hbWUsICdjb250YWluZXInLCB7IHVybDogdXJsLCBmaWxlbmFtZTogZmlsZW5hbWUgfSwgbnVsbCwge1xuICogICAgIHRleHR1cmU6IHtcbiAqICAgICAgICAgcHJlcHJvY2VzcyhnbHRmVGV4dHVyZSkgeyBjb25zb2xlLmxvZyhcInRleHR1cmUgcHJlcHJvY2Vzc1wiKTsgfVxuICogICAgIH0sXG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEBpbXBsZW1lbnRzIHtSZXNvdXJjZUhhbmRsZXJ9XG4gKi9cbmNsYXNzIENvbnRhaW5lckhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIFR5cGUgb2YgdGhlIHJlc291cmNlIHRoZSBoYW5kbGVyIGhhbmRsZXMuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGhhbmRsZXJUeXBlID0gXCJjb250YWluZXJcIjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBDb250YWluZXJSZXNvdXJjZSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXBwQmFzZX0gYXBwIC0gVGhlIHJ1bm5pbmcge0BsaW5rIEFwcEJhc2V9LlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgdGhpcy5nbGJQYXJzZXIgPSBuZXcgR2xiUGFyc2VyKGFwcC5ncmFwaGljc0RldmljZSwgYXBwLmFzc2V0cywgMCk7XG4gICAgICAgIHRoaXMucGFyc2VycyA9IHsgfTtcbiAgICB9XG5cbiAgICBzZXQgbWF4UmV0cmllcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLmdsYlBhcnNlci5tYXhSZXRyaWVzID0gdmFsdWU7XG4gICAgICAgIGZvciAoY29uc3QgcGFyc2VyIGluIHRoaXMucGFyc2Vycykge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyc2Vycy5oYXNPd25Qcm9wZXJ0eShwYXJzZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZXJzW3BhcnNlcl0ubWF4UmV0cmllcyA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG1heFJldHJpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdsYlBhcnNlci5tYXhSZXRyaWVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgcmVzb3VyY2UgVVJMLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBVUkwgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzIHJlbW92ZWQuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZ2V0VXJsV2l0aG91dFBhcmFtcyh1cmwpIHtcbiAgICAgICAgcmV0dXJuIHVybC5pbmRleE9mKCc/JykgPj0gMCA/IHVybC5zcGxpdCgnPycpWzBdIDogdXJsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgcmVzb3VyY2UgVVJMLlxuICAgICAqIEByZXR1cm5zIHsqfSBBIHN1aXRhYmxlIHBhcnNlciB0byBwYXJzZSB0aGUgcmVzb3VyY2UuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZ2V0UGFyc2VyKHVybCkge1xuICAgICAgICBjb25zdCBleHQgPSB1cmwgPyBwYXRoLmdldEV4dGVuc2lvbih0aGlzLl9nZXRVcmxXaXRob3V0UGFyYW1zKHVybCkpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnLicsICcnKSA6IG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlcnNbZXh0XSB8fCB0aGlzLmdsYlBhcnNlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IHVybCAtIEVpdGhlciB0aGUgVVJMIG9mIHRoZSByZXNvdXJjZSB0byBsb2FkIG9yIGEgc3RydWN0dXJlXG4gICAgICogY29udGFpbmluZyB0aGUgbG9hZCBhbmQgb3JpZ2luYWwgVVJMLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbdXJsLmxvYWRdIC0gVGhlIFVSTCB0byBiZSB1c2VkIGZvciBsb2FkaW5nIHRoZSByZXNvdXJjZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3VybC5vcmlnaW5hbF0gLSBUaGUgb3JpZ2luYWwgVVJMIHRvIGJlIHVzZWQgZm9yIGlkZW50aWZ5aW5nIHRoZSByZXNvdXJjZVxuICAgICAqIGZvcm1hdC4gVGhpcyBpcyBuZWNlc3Nhcnkgd2hlbiBsb2FkaW5nLCBmb3IgZXhhbXBsZSBmcm9tIGJsb2IuXG4gICAgICogQHBhcmFtIHtSZXNvdXJjZUhhbmRsZXJDYWxsYmFja30gY2FsbGJhY2sgLSBUaGUgY2FsbGJhY2sgdXNlZCB3aGVuIHRoZSByZXNvdXJjZSBpcyBsb2FkZWQgb3JcbiAgICAgKiBhbiBlcnJvciBvY2N1cnMuXG4gICAgICogQHBhcmFtIHtBc3NldH0gW2Fzc2V0XSAtIE9wdGlvbmFsIGFzc2V0IHRoYXQgaXMgcGFzc2VkIGJ5IFJlc291cmNlTG9hZGVyLlxuICAgICAqL1xuICAgIGxvYWQodXJsLCBjYWxsYmFjaywgYXNzZXQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB1cmwgPSB7XG4gICAgICAgICAgICAgICAgbG9hZDogdXJsLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiB1cmxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9nZXRQYXJzZXIodXJsLm9yaWdpbmFsKS5sb2FkKHVybCwgY2FsbGJhY2ssIGFzc2V0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVGhlIFVSTCBvZiB0aGUgcmVzb3VyY2UgdG8gb3Blbi5cbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgLSBUaGUgcmF3IHJlc291cmNlIGRhdGEgcGFzc2VkIGJ5IGNhbGxiYWNrIGZyb20ge0BsaW5rIFJlc291cmNlSGFuZGxlciNsb2FkfS5cbiAgICAgKiBAcGFyYW0ge0Fzc2V0fSBbYXNzZXRdIC0gT3B0aW9uYWwgYXNzZXQgdGhhdCBpcyBwYXNzZWQgYnkgUmVzb3VyY2VMb2FkZXIuXG4gICAgICogQHJldHVybnMgeyp9IFRoZSBwYXJzZWQgcmVzb3VyY2UgZGF0YS5cbiAgICAgKi9cbiAgICBvcGVuKHVybCwgZGF0YSwgYXNzZXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFBhcnNlcih1cmwpLm9wZW4odXJsLCBkYXRhLCBhc3NldCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtBc3NldH0gYXNzZXQgLSBUaGUgYXNzZXQgdG8gcGF0Y2guXG4gICAgICogQHBhcmFtIHtBc3NldFJlZ2lzdHJ5fSBhc3NldHMgLSBUaGUgYXNzZXQgcmVnaXN0cnkuXG4gICAgICovXG4gICAgcGF0Y2goYXNzZXQsIGFzc2V0cykge1xuXG4gICAgfVxufVxuXG5leHBvcnQgeyBDb250YWluZXJSZXNvdXJjZSwgQ29udGFpbmVySGFuZGxlciB9O1xuIl0sIm5hbWVzIjpbIkNvbnRhaW5lclJlc291cmNlIiwiaW5zdGFudGlhdGVNb2RlbEVudGl0eSIsIm9wdGlvbnMiLCJpbnN0YW50aWF0ZVJlbmRlckVudGl0eSIsImdldE1hdGVyaWFsVmFyaWFudHMiLCJhcHBseU1hdGVyaWFsVmFyaWFudCIsImVudGl0eSIsIm5hbWUiLCJhcHBseU1hdGVyaWFsVmFyaWFudEluc3RhbmNlcyIsImluc3RhbmNlcyIsIkNvbnRhaW5lckhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsImFwcCIsImhhbmRsZXJUeXBlIiwiZ2xiUGFyc2VyIiwiR2xiUGFyc2VyIiwiZ3JhcGhpY3NEZXZpY2UiLCJhc3NldHMiLCJwYXJzZXJzIiwibWF4UmV0cmllcyIsInZhbHVlIiwicGFyc2VyIiwiaGFzT3duUHJvcGVydHkiLCJfZ2V0VXJsV2l0aG91dFBhcmFtcyIsInVybCIsImluZGV4T2YiLCJzcGxpdCIsIl9nZXRQYXJzZXIiLCJleHQiLCJwYXRoIiwiZ2V0RXh0ZW5zaW9uIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwibG9hZCIsImNhbGxiYWNrIiwiYXNzZXQiLCJvcmlnaW5hbCIsIm9wZW4iLCJkYXRhIiwicGF0Y2giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBY0EsTUFBTUEsaUJBQU4sQ0FBd0I7RUFpQnBCQyxzQkFBc0IsQ0FBQ0MsT0FBRCxFQUFVO0FBQzVCLElBQUEsT0FBTyxJQUFQLENBQUE7QUFDSCxHQUFBOztFQTJCREMsdUJBQXVCLENBQUNELE9BQUQsRUFBVTtBQUM3QixJQUFBLE9BQU8sSUFBUCxDQUFBO0FBQ0gsR0FBQTs7QUFPREUsRUFBQUEsbUJBQW1CLEdBQUc7QUFDbEIsSUFBQSxPQUFPLElBQVAsQ0FBQTtBQUNILEdBQUE7O0FBa0JEQyxFQUFBQSxvQkFBb0IsQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWUsRUFBRTs7QUF3QnJDQyxFQUFBQSw2QkFBNkIsQ0FBQ0MsU0FBRCxFQUFZRixJQUFaLEVBQWtCLEVBQUU7O0FBbkc3QixDQUFBOztBQStJeEIsTUFBTUcsZ0JBQU4sQ0FBdUI7RUFjbkJDLFdBQVcsQ0FBQ0MsR0FBRCxFQUFNO0lBQUEsSUFSakJDLENBQUFBLFdBUWlCLEdBUkgsV0FRRyxDQUFBO0FBQ2IsSUFBQSxJQUFBLENBQUtDLFNBQUwsR0FBaUIsSUFBSUMsU0FBSixDQUFjSCxHQUFHLENBQUNJLGNBQWxCLEVBQWtDSixHQUFHLENBQUNLLE1BQXRDLEVBQThDLENBQTlDLENBQWpCLENBQUE7SUFDQSxJQUFLQyxDQUFBQSxPQUFMLEdBQWUsRUFBZixDQUFBO0FBQ0gsR0FBQTs7RUFFYSxJQUFWQyxVQUFVLENBQUNDLEtBQUQsRUFBUTtBQUNsQixJQUFBLElBQUEsQ0FBS04sU0FBTCxDQUFlSyxVQUFmLEdBQTRCQyxLQUE1QixDQUFBOztBQUNBLElBQUEsS0FBSyxNQUFNQyxNQUFYLElBQXFCLElBQUEsQ0FBS0gsT0FBMUIsRUFBbUM7QUFDL0IsTUFBQSxJQUFJLEtBQUtBLE9BQUwsQ0FBYUksY0FBYixDQUE0QkQsTUFBNUIsQ0FBSixFQUF5QztBQUNyQyxRQUFBLElBQUEsQ0FBS0gsT0FBTCxDQUFhRyxNQUFiLENBQXFCRixDQUFBQSxVQUFyQixHQUFrQ0MsS0FBbEMsQ0FBQTtBQUNILE9BQUE7QUFDSixLQUFBO0FBQ0osR0FBQTs7QUFFYSxFQUFBLElBQVZELFVBQVUsR0FBRztJQUNiLE9BQU8sSUFBQSxDQUFLTCxTQUFMLENBQWVLLFVBQXRCLENBQUE7QUFDSCxHQUFBOztFQU9ESSxvQkFBb0IsQ0FBQ0MsR0FBRCxFQUFNO0FBQ3RCLElBQUEsT0FBT0EsR0FBRyxDQUFDQyxPQUFKLENBQVksR0FBWixLQUFvQixDQUFwQixHQUF3QkQsR0FBRyxDQUFDRSxLQUFKLENBQVUsR0FBVixFQUFlLENBQWYsQ0FBeEIsR0FBNENGLEdBQW5ELENBQUE7QUFDSCxHQUFBOztFQU9ERyxVQUFVLENBQUNILEdBQUQsRUFBTTtJQUNaLE1BQU1JLEdBQUcsR0FBR0osR0FBRyxHQUFHSyxJQUFJLENBQUNDLFlBQUwsQ0FBa0IsSUFBQSxDQUFLUCxvQkFBTCxDQUEwQkMsR0FBMUIsQ0FBbEIsQ0FBQSxDQUFrRE8sV0FBbEQsRUFBQSxDQUFnRUMsT0FBaEUsQ0FBd0UsR0FBeEUsRUFBNkUsRUFBN0UsQ0FBSCxHQUFzRixJQUFyRyxDQUFBO0FBQ0EsSUFBQSxPQUFPLEtBQUtkLE9BQUwsQ0FBYVUsR0FBYixDQUFBLElBQXFCLEtBQUtkLFNBQWpDLENBQUE7QUFDSCxHQUFBOztBQVlEbUIsRUFBQUEsSUFBSSxDQUFDVCxHQUFELEVBQU1VLFFBQU4sRUFBZ0JDLEtBQWhCLEVBQXVCO0FBQ3ZCLElBQUEsSUFBSSxPQUFPWCxHQUFQLEtBQWUsUUFBbkIsRUFBNkI7QUFDekJBLE1BQUFBLEdBQUcsR0FBRztBQUNGUyxRQUFBQSxJQUFJLEVBQUVULEdBREo7QUFFRlksUUFBQUEsUUFBUSxFQUFFWixHQUFBQTtPQUZkLENBQUE7QUFJSCxLQUFBOztBQUVELElBQUEsSUFBQSxDQUFLRyxVQUFMLENBQWdCSCxHQUFHLENBQUNZLFFBQXBCLENBQUEsQ0FBOEJILElBQTlCLENBQW1DVCxHQUFuQyxFQUF3Q1UsUUFBeEMsRUFBa0RDLEtBQWxELENBQUEsQ0FBQTtBQUNILEdBQUE7O0FBUURFLEVBQUFBLElBQUksQ0FBQ2IsR0FBRCxFQUFNYyxJQUFOLEVBQVlILEtBQVosRUFBbUI7QUFDbkIsSUFBQSxPQUFPLElBQUtSLENBQUFBLFVBQUwsQ0FBZ0JILEdBQWhCLENBQXFCYSxDQUFBQSxJQUFyQixDQUEwQmIsR0FBMUIsRUFBK0JjLElBQS9CLEVBQXFDSCxLQUFyQyxDQUFQLENBQUE7QUFDSCxHQUFBOztBQU1ESSxFQUFBQSxLQUFLLENBQUNKLEtBQUQsRUFBUWxCLE1BQVIsRUFBZ0IsRUFFcEI7O0FBeEZrQjs7OzsifQ==
