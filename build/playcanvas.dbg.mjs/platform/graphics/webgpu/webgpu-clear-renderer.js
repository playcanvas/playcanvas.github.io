/**
 * @license
 * PlayCanvas Engine v1.62.0 revision 818511d2b (DEBUG PROFILER)
 * Copyright 2011-2023 PlayCanvas Ltd. All rights reserved.
 */
import { DebugHelper, Debug } from '../../../core/debug.js';
import { BindGroupFormat, BindBufferFormat } from '../bind-group-format.js';
import { UniformBufferFormat, UniformFormat } from '../uniform-buffer-format.js';
import { BlendState } from '../blend-state.js';
import { SHADERLANGUAGE_WGSL, UNIFORMTYPE_VEC4, UNIFORMTYPE_FLOAT, UNIFORM_BUFFER_DEFAULT_SLOT_NAME, SHADERSTAGE_VERTEX, SHADERSTAGE_FRAGMENT, CLEARFLAG_COLOR, CLEARFLAG_DEPTH, CLEARFLAG_STENCIL, BINDGROUP_MESH, PRIMITIVE_TRISTRIP } from '../constants.js';
import { Shader } from '../shader.js';
import { BindGroup } from '../bind-group.js';
import { UniformBuffer } from '../uniform-buffer.js';
import { DebugGraphics } from '../debug-graphics.js';
import { DepthState } from '../depth-state.js';

const primitive = {
  type: PRIMITIVE_TRISTRIP,
  base: 0,
  count: 4,
  indexed: false
};

/**
 * A WebGPU helper class implementing a viewport clear operation. When rendering to a texture,
 * the whole surface can be cleared using loadOp, but if only a viewport needs to be cleared, or if
 * it needs to be cleared later during the rendering, this need to be archieved by rendering a quad.
 * This class renders a full-screen quad, and expects the viewport / scissor to be set up to clip
 * it to only required area.
 *
 * @ignore
 */
class WebgpuClearRenderer {
  constructor(device) {
    // shader that can write out color and depth values
    const code = `

            struct ub_mesh {
                color : vec4f,
                depth: f32
            }

            @group(0) @binding(0) var<uniform> ubMesh : ub_mesh;

            var<private> pos : array<vec2f, 4> = array<vec2f, 4>(
                vec2(-1.0, 1.0), vec2(1.0, 1.0),
                vec2(-1.0, -1.0), vec2(1.0, -1.0)
            );

            struct VertexOutput {
                @builtin(position) position : vec4f
            }

            @vertex
            fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                var output : VertexOutput;
                output.position = vec4(pos[vertexIndex], ubMesh.depth, 1.0);
                return output;
            }

            @fragment
            fn fragmentMain() -> @location(0) vec4f {
                return ubMesh.color;
            }
        `;
    this.shader = new Shader(device, {
      name: 'WebGPUClearRendererShader',
      shaderLanguage: SHADERLANGUAGE_WGSL,
      vshader: code,
      fshader: code
    });

    // uniforms
    this.uniformBuffer = new UniformBuffer(device, new UniformBufferFormat(device, [new UniformFormat('color', UNIFORMTYPE_VEC4), new UniformFormat('depth', UNIFORMTYPE_FLOAT)]));

    // format of the bind group
    const bindGroupFormat = new BindGroupFormat(device, [new BindBufferFormat(UNIFORM_BUFFER_DEFAULT_SLOT_NAME, SHADERSTAGE_VERTEX | SHADERSTAGE_FRAGMENT)]);

    // bind group
    this.bindGroup = new BindGroup(device, bindGroupFormat, this.uniformBuffer);
    DebugHelper.setName(this.bindGroup, `ClearRenderer-BindGroup_${this.bindGroup.id}`);

    // uniform data
    this.colorData = new Float32Array(4);
    this.colorId = device.scope.resolve('color');
    this.depthId = device.scope.resolve('depth');
  }
  clear(device, renderTarget, options, defaultOptions) {
    var _options$flags;
    options = options || defaultOptions;
    const flags = (_options$flags = options.flags) != null ? _options$flags : defaultOptions.flags;
    if (flags !== 0) {
      DebugGraphics.pushGpuMarker(device, 'CLEAR-RENDERER');

      // setup clear color
      if (flags & CLEARFLAG_COLOR && renderTarget.colorBuffer) {
        var _options$color;
        const color = (_options$color = options.color) != null ? _options$color : defaultOptions.color;
        this.colorData.set(color);
        device.setBlendState(BlendState.DEFAULT);
      } else {
        device.setBlendState(BlendState.NOWRITE);
      }
      this.colorId.setValue(this.colorData);

      // setup depth clear
      if (flags & CLEARFLAG_DEPTH && renderTarget.depth) {
        var _options$depth;
        const depth = (_options$depth = options.depth) != null ? _options$depth : defaultOptions.depth;
        this.depthId.setValue(depth);
        device.setDepthState(DepthState.WRITEDEPTH);
      } else {
        this.depthId.setValue(1);
        device.setDepthState(DepthState.NODEPTH);
      }

      // setup stencil clear
      if (flags & CLEARFLAG_STENCIL && renderTarget.stencil) {
        Debug.warnOnce("ClearRenderer does not support stencil clear at the moment");
      }

      // render 4 verticies without vertex buffer
      device.setShader(this.shader);
      const bindGroup = this.bindGroup;
      if (bindGroup.defaultUniformBuffer) {
        bindGroup.defaultUniformBuffer.update();
      }
      bindGroup.update();
      device.setBindGroup(BINDGROUP_MESH, bindGroup);
      device.draw(primitive);
      DebugGraphics.popGpuMarker(device);
    }
  }
}

export { WebgpuClearRenderer };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LWNsZWFyLXJlbmRlcmVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvcGxhdGZvcm0vZ3JhcGhpY3Mvd2ViZ3B1L3dlYmdwdS1jbGVhci1yZW5kZXJlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWJ1ZywgRGVidWdIZWxwZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29yZS9kZWJ1Zy5qc1wiO1xuaW1wb3J0IHsgQmluZEJ1ZmZlckZvcm1hdCwgQmluZEdyb3VwRm9ybWF0IH0gZnJvbSBcIi4uL2JpbmQtZ3JvdXAtZm9ybWF0LmpzXCI7XG5pbXBvcnQgeyBVbmlmb3JtQnVmZmVyRm9ybWF0LCBVbmlmb3JtRm9ybWF0IH0gZnJvbSBcIi4uL3VuaWZvcm0tYnVmZmVyLWZvcm1hdC5qc1wiO1xuaW1wb3J0IHsgQmxlbmRTdGF0ZSB9IGZyb20gXCIuLi9ibGVuZC1zdGF0ZS5qc1wiO1xuaW1wb3J0IHtcbiAgICBQUklNSVRJVkVfVFJJU1RSSVAsIFNIQURFUkxBTkdVQUdFX1dHU0wsIFNIQURFUlNUQUdFX0ZSQUdNRU5ULCBTSEFERVJTVEFHRV9WRVJURVgsXG4gICAgVU5JRk9STVRZUEVfRkxPQVQsIFVOSUZPUk1UWVBFX1ZFQzQsIFVOSUZPUk1fQlVGRkVSX0RFRkFVTFRfU0xPVF9OQU1FLCBCSU5ER1JPVVBfTUVTSCwgQ0xFQVJGTEFHX0NPTE9SLCBDTEVBUkZMQUdfREVQVEgsIENMRUFSRkxBR19TVEVOQ0lMXG59IGZyb20gXCIuLi9jb25zdGFudHMuanNcIjtcbmltcG9ydCB7IFNoYWRlciB9IGZyb20gXCIuLi9zaGFkZXIuanNcIjtcbmltcG9ydCB7IEJpbmRHcm91cCB9IGZyb20gXCIuLi9iaW5kLWdyb3VwLmpzXCI7XG5pbXBvcnQgeyBVbmlmb3JtQnVmZmVyIH0gZnJvbSBcIi4uL3VuaWZvcm0tYnVmZmVyLmpzXCI7XG5pbXBvcnQgeyBEZWJ1Z0dyYXBoaWNzIH0gZnJvbSBcIi4uL2RlYnVnLWdyYXBoaWNzLmpzXCI7XG5pbXBvcnQgeyBEZXB0aFN0YXRlIH0gZnJvbSBcIi4uL2RlcHRoLXN0YXRlLmpzXCI7XG5cbmNvbnN0IHByaW1pdGl2ZSA9IHtcbiAgICB0eXBlOiBQUklNSVRJVkVfVFJJU1RSSVAsXG4gICAgYmFzZTogMCxcbiAgICBjb3VudDogNCxcbiAgICBpbmRleGVkOiBmYWxzZVxufTtcblxuLyoqXG4gKiBBIFdlYkdQVSBoZWxwZXIgY2xhc3MgaW1wbGVtZW50aW5nIGEgdmlld3BvcnQgY2xlYXIgb3BlcmF0aW9uLiBXaGVuIHJlbmRlcmluZyB0byBhIHRleHR1cmUsXG4gKiB0aGUgd2hvbGUgc3VyZmFjZSBjYW4gYmUgY2xlYXJlZCB1c2luZyBsb2FkT3AsIGJ1dCBpZiBvbmx5IGEgdmlld3BvcnQgbmVlZHMgdG8gYmUgY2xlYXJlZCwgb3IgaWZcbiAqIGl0IG5lZWRzIHRvIGJlIGNsZWFyZWQgbGF0ZXIgZHVyaW5nIHRoZSByZW5kZXJpbmcsIHRoaXMgbmVlZCB0byBiZSBhcmNoaWV2ZWQgYnkgcmVuZGVyaW5nIGEgcXVhZC5cbiAqIFRoaXMgY2xhc3MgcmVuZGVycyBhIGZ1bGwtc2NyZWVuIHF1YWQsIGFuZCBleHBlY3RzIHRoZSB2aWV3cG9ydCAvIHNjaXNzb3IgdG8gYmUgc2V0IHVwIHRvIGNsaXBcbiAqIGl0IHRvIG9ubHkgcmVxdWlyZWQgYXJlYS5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIFdlYmdwdUNsZWFyUmVuZGVyZXIge1xuICAgIGNvbnN0cnVjdG9yKGRldmljZSkge1xuXG4gICAgICAgIC8vIHNoYWRlciB0aGF0IGNhbiB3cml0ZSBvdXQgY29sb3IgYW5kIGRlcHRoIHZhbHVlc1xuICAgICAgICBjb25zdCBjb2RlID0gYFxuXG4gICAgICAgICAgICBzdHJ1Y3QgdWJfbWVzaCB7XG4gICAgICAgICAgICAgICAgY29sb3IgOiB2ZWM0ZixcbiAgICAgICAgICAgICAgICBkZXB0aDogZjMyXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEBncm91cCgwKSBAYmluZGluZygwKSB2YXI8dW5pZm9ybT4gdWJNZXNoIDogdWJfbWVzaDtcblxuICAgICAgICAgICAgdmFyPHByaXZhdGU+IHBvcyA6IGFycmF5PHZlYzJmLCA0PiA9IGFycmF5PHZlYzJmLCA0PihcbiAgICAgICAgICAgICAgICB2ZWMyKC0xLjAsIDEuMCksIHZlYzIoMS4wLCAxLjApLFxuICAgICAgICAgICAgICAgIHZlYzIoLTEuMCwgLTEuMCksIHZlYzIoMS4wLCAtMS4wKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgc3RydWN0IFZlcnRleE91dHB1dCB7XG4gICAgICAgICAgICAgICAgQGJ1aWx0aW4ocG9zaXRpb24pIHBvc2l0aW9uIDogdmVjNGZcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQHZlcnRleFxuICAgICAgICAgICAgZm4gdmVydGV4TWFpbihAYnVpbHRpbih2ZXJ0ZXhfaW5kZXgpIHZlcnRleEluZGV4IDogdTMyKSAtPiBWZXJ0ZXhPdXRwdXQge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgOiBWZXJ0ZXhPdXRwdXQ7XG4gICAgICAgICAgICAgICAgb3V0cHV0LnBvc2l0aW9uID0gdmVjNChwb3NbdmVydGV4SW5kZXhdLCB1Yk1lc2guZGVwdGgsIDEuMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQGZyYWdtZW50XG4gICAgICAgICAgICBmbiBmcmFnbWVudE1haW4oKSAtPiBAbG9jYXRpb24oMCkgdmVjNGYge1xuICAgICAgICAgICAgICAgIHJldHVybiB1Yk1lc2guY29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIGA7XG5cbiAgICAgICAgdGhpcy5zaGFkZXIgPSBuZXcgU2hhZGVyKGRldmljZSwge1xuICAgICAgICAgICAgbmFtZTogJ1dlYkdQVUNsZWFyUmVuZGVyZXJTaGFkZXInLFxuICAgICAgICAgICAgc2hhZGVyTGFuZ3VhZ2U6IFNIQURFUkxBTkdVQUdFX1dHU0wsXG4gICAgICAgICAgICB2c2hhZGVyOiBjb2RlLFxuICAgICAgICAgICAgZnNoYWRlcjogY29kZVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyB1bmlmb3Jtc1xuICAgICAgICB0aGlzLnVuaWZvcm1CdWZmZXIgPSBuZXcgVW5pZm9ybUJ1ZmZlcihkZXZpY2UsIG5ldyBVbmlmb3JtQnVmZmVyRm9ybWF0KGRldmljZSwgW1xuICAgICAgICAgICAgbmV3IFVuaWZvcm1Gb3JtYXQoJ2NvbG9yJywgVU5JRk9STVRZUEVfVkVDNCksXG4gICAgICAgICAgICBuZXcgVW5pZm9ybUZvcm1hdCgnZGVwdGgnLCBVTklGT1JNVFlQRV9GTE9BVClcbiAgICAgICAgXSkpO1xuXG4gICAgICAgIC8vIGZvcm1hdCBvZiB0aGUgYmluZCBncm91cFxuICAgICAgICBjb25zdCBiaW5kR3JvdXBGb3JtYXQgPSBuZXcgQmluZEdyb3VwRm9ybWF0KGRldmljZSwgW1xuICAgICAgICAgICAgbmV3IEJpbmRCdWZmZXJGb3JtYXQoVU5JRk9STV9CVUZGRVJfREVGQVVMVF9TTE9UX05BTUUsIFNIQURFUlNUQUdFX1ZFUlRFWCB8IFNIQURFUlNUQUdFX0ZSQUdNRU5UKVxuICAgICAgICBdKTtcblxuICAgICAgICAvLyBiaW5kIGdyb3VwXG4gICAgICAgIHRoaXMuYmluZEdyb3VwID0gbmV3IEJpbmRHcm91cChkZXZpY2UsIGJpbmRHcm91cEZvcm1hdCwgdGhpcy51bmlmb3JtQnVmZmVyKTtcbiAgICAgICAgRGVidWdIZWxwZXIuc2V0TmFtZSh0aGlzLmJpbmRHcm91cCwgYENsZWFyUmVuZGVyZXItQmluZEdyb3VwXyR7dGhpcy5iaW5kR3JvdXAuaWR9YCk7XG5cbiAgICAgICAgLy8gdW5pZm9ybSBkYXRhXG4gICAgICAgIHRoaXMuY29sb3JEYXRhID0gbmV3IEZsb2F0MzJBcnJheSg0KTtcbiAgICAgICAgdGhpcy5jb2xvcklkID0gZGV2aWNlLnNjb3BlLnJlc29sdmUoJ2NvbG9yJyk7XG4gICAgICAgIHRoaXMuZGVwdGhJZCA9IGRldmljZS5zY29wZS5yZXNvbHZlKCdkZXB0aCcpO1xuICAgIH1cblxuICAgIGNsZWFyKGRldmljZSwgcmVuZGVyVGFyZ2V0LCBvcHRpb25zLCBkZWZhdWx0T3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCBkZWZhdWx0T3B0aW9ucztcblxuICAgICAgICBjb25zdCBmbGFncyA9IG9wdGlvbnMuZmxhZ3MgPz8gZGVmYXVsdE9wdGlvbnMuZmxhZ3M7XG4gICAgICAgIGlmIChmbGFncyAhPT0gMCkge1xuXG4gICAgICAgICAgICBEZWJ1Z0dyYXBoaWNzLnB1c2hHcHVNYXJrZXIoZGV2aWNlLCAnQ0xFQVItUkVOREVSRVInKTtcblxuICAgICAgICAgICAgLy8gc2V0dXAgY2xlYXIgY29sb3JcbiAgICAgICAgICAgIGlmICgoZmxhZ3MgJiBDTEVBUkZMQUdfQ09MT1IpICYmIHJlbmRlclRhcmdldC5jb2xvckJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gb3B0aW9ucy5jb2xvciA/PyBkZWZhdWx0T3B0aW9ucy5jb2xvcjtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yRGF0YS5zZXQoY29sb3IpO1xuXG4gICAgICAgICAgICAgICAgZGV2aWNlLnNldEJsZW5kU3RhdGUoQmxlbmRTdGF0ZS5ERUZBVUxUKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGV2aWNlLnNldEJsZW5kU3RhdGUoQmxlbmRTdGF0ZS5OT1dSSVRFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29sb3JJZC5zZXRWYWx1ZSh0aGlzLmNvbG9yRGF0YSk7XG5cbiAgICAgICAgICAgIC8vIHNldHVwIGRlcHRoIGNsZWFyXG4gICAgICAgICAgICBpZiAoKGZsYWdzICYgQ0xFQVJGTEFHX0RFUFRIKSAmJiByZW5kZXJUYXJnZXQuZGVwdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXB0aCA9IG9wdGlvbnMuZGVwdGggPz8gZGVmYXVsdE9wdGlvbnMuZGVwdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXB0aElkLnNldFZhbHVlKGRlcHRoKTtcbiAgICAgICAgICAgICAgICBkZXZpY2Uuc2V0RGVwdGhTdGF0ZShEZXB0aFN0YXRlLldSSVRFREVQVEgpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVwdGhJZC5zZXRWYWx1ZSgxKTtcbiAgICAgICAgICAgICAgICBkZXZpY2Uuc2V0RGVwdGhTdGF0ZShEZXB0aFN0YXRlLk5PREVQVEgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzZXR1cCBzdGVuY2lsIGNsZWFyXG4gICAgICAgICAgICBpZiAoKGZsYWdzICYgQ0xFQVJGTEFHX1NURU5DSUwpICYmIHJlbmRlclRhcmdldC5zdGVuY2lsKSB7XG4gICAgICAgICAgICAgICAgRGVidWcud2Fybk9uY2UoXCJDbGVhclJlbmRlcmVyIGRvZXMgbm90IHN1cHBvcnQgc3RlbmNpbCBjbGVhciBhdCB0aGUgbW9tZW50XCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZW5kZXIgNCB2ZXJ0aWNpZXMgd2l0aG91dCB2ZXJ0ZXggYnVmZmVyXG4gICAgICAgICAgICBkZXZpY2Uuc2V0U2hhZGVyKHRoaXMuc2hhZGVyKTtcblxuICAgICAgICAgICAgY29uc3QgYmluZEdyb3VwID0gdGhpcy5iaW5kR3JvdXA7XG4gICAgICAgICAgICBpZiAoYmluZEdyb3VwLmRlZmF1bHRVbmlmb3JtQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgYmluZEdyb3VwLmRlZmF1bHRVbmlmb3JtQnVmZmVyLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmluZEdyb3VwLnVwZGF0ZSgpO1xuICAgICAgICAgICAgZGV2aWNlLnNldEJpbmRHcm91cChCSU5ER1JPVVBfTUVTSCwgYmluZEdyb3VwKTtcblxuICAgICAgICAgICAgZGV2aWNlLmRyYXcocHJpbWl0aXZlKTtcblxuICAgICAgICAgICAgRGVidWdHcmFwaGljcy5wb3BHcHVNYXJrZXIoZGV2aWNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgV2ViZ3B1Q2xlYXJSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbInByaW1pdGl2ZSIsInR5cGUiLCJQUklNSVRJVkVfVFJJU1RSSVAiLCJiYXNlIiwiY291bnQiLCJpbmRleGVkIiwiV2ViZ3B1Q2xlYXJSZW5kZXJlciIsImNvbnN0cnVjdG9yIiwiZGV2aWNlIiwiY29kZSIsInNoYWRlciIsIlNoYWRlciIsIm5hbWUiLCJzaGFkZXJMYW5ndWFnZSIsIlNIQURFUkxBTkdVQUdFX1dHU0wiLCJ2c2hhZGVyIiwiZnNoYWRlciIsInVuaWZvcm1CdWZmZXIiLCJVbmlmb3JtQnVmZmVyIiwiVW5pZm9ybUJ1ZmZlckZvcm1hdCIsIlVuaWZvcm1Gb3JtYXQiLCJVTklGT1JNVFlQRV9WRUM0IiwiVU5JRk9STVRZUEVfRkxPQVQiLCJiaW5kR3JvdXBGb3JtYXQiLCJCaW5kR3JvdXBGb3JtYXQiLCJCaW5kQnVmZmVyRm9ybWF0IiwiVU5JRk9STV9CVUZGRVJfREVGQVVMVF9TTE9UX05BTUUiLCJTSEFERVJTVEFHRV9WRVJURVgiLCJTSEFERVJTVEFHRV9GUkFHTUVOVCIsImJpbmRHcm91cCIsIkJpbmRHcm91cCIsIkRlYnVnSGVscGVyIiwic2V0TmFtZSIsImlkIiwiY29sb3JEYXRhIiwiRmxvYXQzMkFycmF5IiwiY29sb3JJZCIsInNjb3BlIiwicmVzb2x2ZSIsImRlcHRoSWQiLCJjbGVhciIsInJlbmRlclRhcmdldCIsIm9wdGlvbnMiLCJkZWZhdWx0T3B0aW9ucyIsImZsYWdzIiwiRGVidWdHcmFwaGljcyIsInB1c2hHcHVNYXJrZXIiLCJDTEVBUkZMQUdfQ09MT1IiLCJjb2xvckJ1ZmZlciIsImNvbG9yIiwic2V0Iiwic2V0QmxlbmRTdGF0ZSIsIkJsZW5kU3RhdGUiLCJERUZBVUxUIiwiTk9XUklURSIsInNldFZhbHVlIiwiQ0xFQVJGTEFHX0RFUFRIIiwiZGVwdGgiLCJzZXREZXB0aFN0YXRlIiwiRGVwdGhTdGF0ZSIsIldSSVRFREVQVEgiLCJOT0RFUFRIIiwiQ0xFQVJGTEFHX1NURU5DSUwiLCJzdGVuY2lsIiwiRGVidWciLCJ3YXJuT25jZSIsInNldFNoYWRlciIsImRlZmF1bHRVbmlmb3JtQnVmZmVyIiwidXBkYXRlIiwic2V0QmluZEdyb3VwIiwiQklOREdST1VQX01FU0giLCJkcmF3IiwicG9wR3B1TWFya2VyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBY0EsTUFBTUEsU0FBUyxHQUFHO0FBQ2RDLEVBQUFBLElBQUksRUFBRUMsa0JBQWtCO0FBQ3hCQyxFQUFBQSxJQUFJLEVBQUUsQ0FBQztBQUNQQyxFQUFBQSxLQUFLLEVBQUUsQ0FBQztBQUNSQyxFQUFBQSxPQUFPLEVBQUUsS0FBQTtBQUNiLENBQUMsQ0FBQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQyxtQkFBbUIsQ0FBQztFQUN0QkMsV0FBVyxDQUFDQyxNQUFNLEVBQUU7QUFFaEI7QUFDQSxJQUFBLE1BQU1DLElBQUksR0FBSSxDQUFBO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUyxDQUFBLENBQUE7QUFFRCxJQUFBLElBQUksQ0FBQ0MsTUFBTSxHQUFHLElBQUlDLE1BQU0sQ0FBQ0gsTUFBTSxFQUFFO0FBQzdCSSxNQUFBQSxJQUFJLEVBQUUsMkJBQTJCO0FBQ2pDQyxNQUFBQSxjQUFjLEVBQUVDLG1CQUFtQjtBQUNuQ0MsTUFBQUEsT0FBTyxFQUFFTixJQUFJO0FBQ2JPLE1BQUFBLE9BQU8sRUFBRVAsSUFBQUE7QUFDYixLQUFDLENBQUMsQ0FBQTs7QUFFRjtBQUNBLElBQUEsSUFBSSxDQUFDUSxhQUFhLEdBQUcsSUFBSUMsYUFBYSxDQUFDVixNQUFNLEVBQUUsSUFBSVcsbUJBQW1CLENBQUNYLE1BQU0sRUFBRSxDQUMzRSxJQUFJWSxhQUFhLENBQUMsT0FBTyxFQUFFQyxnQkFBZ0IsQ0FBQyxFQUM1QyxJQUFJRCxhQUFhLENBQUMsT0FBTyxFQUFFRSxpQkFBaUIsQ0FBQyxDQUNoRCxDQUFDLENBQUMsQ0FBQTs7QUFFSDtBQUNBLElBQUEsTUFBTUMsZUFBZSxHQUFHLElBQUlDLGVBQWUsQ0FBQ2hCLE1BQU0sRUFBRSxDQUNoRCxJQUFJaUIsZ0JBQWdCLENBQUNDLGdDQUFnQyxFQUFFQyxrQkFBa0IsR0FBR0Msb0JBQW9CLENBQUMsQ0FDcEcsQ0FBQyxDQUFBOztBQUVGO0FBQ0EsSUFBQSxJQUFJLENBQUNDLFNBQVMsR0FBRyxJQUFJQyxTQUFTLENBQUN0QixNQUFNLEVBQUVlLGVBQWUsRUFBRSxJQUFJLENBQUNOLGFBQWEsQ0FBQyxDQUFBO0FBQzNFYyxJQUFBQSxXQUFXLENBQUNDLE9BQU8sQ0FBQyxJQUFJLENBQUNILFNBQVMsRUFBRyxDQUEwQix3QkFBQSxFQUFBLElBQUksQ0FBQ0EsU0FBUyxDQUFDSSxFQUFHLEVBQUMsQ0FBQyxDQUFBOztBQUVuRjtBQUNBLElBQUEsSUFBSSxDQUFDQyxTQUFTLEdBQUcsSUFBSUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ3BDLElBQUksQ0FBQ0MsT0FBTyxHQUFHNUIsTUFBTSxDQUFDNkIsS0FBSyxDQUFDQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDNUMsSUFBSSxDQUFDQyxPQUFPLEdBQUcvQixNQUFNLENBQUM2QixLQUFLLENBQUNDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUNoRCxHQUFBO0VBRUFFLEtBQUssQ0FBQ2hDLE1BQU0sRUFBRWlDLFlBQVksRUFBRUMsT0FBTyxFQUFFQyxjQUFjLEVBQUU7QUFBQSxJQUFBLElBQUEsY0FBQSxDQUFBO0lBQ2pERCxPQUFPLEdBQUdBLE9BQU8sSUFBSUMsY0FBYyxDQUFBO0lBRW5DLE1BQU1DLEtBQUsscUJBQUdGLE9BQU8sQ0FBQ0UsS0FBSyxLQUFJRCxJQUFBQSxHQUFBQSxjQUFBQSxHQUFBQSxjQUFjLENBQUNDLEtBQUssQ0FBQTtJQUNuRCxJQUFJQSxLQUFLLEtBQUssQ0FBQyxFQUFFO0FBRWJDLE1BQUFBLGFBQWEsQ0FBQ0MsYUFBYSxDQUFDdEMsTUFBTSxFQUFFLGdCQUFnQixDQUFDLENBQUE7O0FBRXJEO0FBQ0EsTUFBQSxJQUFLb0MsS0FBSyxHQUFHRyxlQUFlLElBQUtOLFlBQVksQ0FBQ08sV0FBVyxFQUFFO0FBQUEsUUFBQSxJQUFBLGNBQUEsQ0FBQTtRQUN2RCxNQUFNQyxLQUFLLHFCQUFHUCxPQUFPLENBQUNPLEtBQUssS0FBSU4sSUFBQUEsR0FBQUEsY0FBQUEsR0FBQUEsY0FBYyxDQUFDTSxLQUFLLENBQUE7QUFDbkQsUUFBQSxJQUFJLENBQUNmLFNBQVMsQ0FBQ2dCLEdBQUcsQ0FBQ0QsS0FBSyxDQUFDLENBQUE7QUFFekJ6QyxRQUFBQSxNQUFNLENBQUMyQyxhQUFhLENBQUNDLFVBQVUsQ0FBQ0MsT0FBTyxDQUFDLENBQUE7QUFDNUMsT0FBQyxNQUFNO0FBQ0g3QyxRQUFBQSxNQUFNLENBQUMyQyxhQUFhLENBQUNDLFVBQVUsQ0FBQ0UsT0FBTyxDQUFDLENBQUE7QUFDNUMsT0FBQTtNQUNBLElBQUksQ0FBQ2xCLE9BQU8sQ0FBQ21CLFFBQVEsQ0FBQyxJQUFJLENBQUNyQixTQUFTLENBQUMsQ0FBQTs7QUFFckM7QUFDQSxNQUFBLElBQUtVLEtBQUssR0FBR1ksZUFBZSxJQUFLZixZQUFZLENBQUNnQixLQUFLLEVBQUU7QUFBQSxRQUFBLElBQUEsY0FBQSxDQUFBO1FBQ2pELE1BQU1BLEtBQUsscUJBQUdmLE9BQU8sQ0FBQ2UsS0FBSyxLQUFJZCxJQUFBQSxHQUFBQSxjQUFBQSxHQUFBQSxjQUFjLENBQUNjLEtBQUssQ0FBQTtBQUNuRCxRQUFBLElBQUksQ0FBQ2xCLE9BQU8sQ0FBQ2dCLFFBQVEsQ0FBQ0UsS0FBSyxDQUFDLENBQUE7QUFDNUJqRCxRQUFBQSxNQUFNLENBQUNrRCxhQUFhLENBQUNDLFVBQVUsQ0FBQ0MsVUFBVSxDQUFDLENBQUE7QUFFL0MsT0FBQyxNQUFNO0FBQ0gsUUFBQSxJQUFJLENBQUNyQixPQUFPLENBQUNnQixRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDeEIvQyxRQUFBQSxNQUFNLENBQUNrRCxhQUFhLENBQUNDLFVBQVUsQ0FBQ0UsT0FBTyxDQUFDLENBQUE7QUFDNUMsT0FBQTs7QUFFQTtBQUNBLE1BQUEsSUFBS2pCLEtBQUssR0FBR2tCLGlCQUFpQixJQUFLckIsWUFBWSxDQUFDc0IsT0FBTyxFQUFFO0FBQ3JEQyxRQUFBQSxLQUFLLENBQUNDLFFBQVEsQ0FBQyw0REFBNEQsQ0FBQyxDQUFBO0FBQ2hGLE9BQUE7O0FBRUE7QUFDQXpELE1BQUFBLE1BQU0sQ0FBQzBELFNBQVMsQ0FBQyxJQUFJLENBQUN4RCxNQUFNLENBQUMsQ0FBQTtBQUU3QixNQUFBLE1BQU1tQixTQUFTLEdBQUcsSUFBSSxDQUFDQSxTQUFTLENBQUE7TUFDaEMsSUFBSUEsU0FBUyxDQUFDc0Msb0JBQW9CLEVBQUU7QUFDaEN0QyxRQUFBQSxTQUFTLENBQUNzQyxvQkFBb0IsQ0FBQ0MsTUFBTSxFQUFFLENBQUE7QUFDM0MsT0FBQTtNQUNBdkMsU0FBUyxDQUFDdUMsTUFBTSxFQUFFLENBQUE7QUFDbEI1RCxNQUFBQSxNQUFNLENBQUM2RCxZQUFZLENBQUNDLGNBQWMsRUFBRXpDLFNBQVMsQ0FBQyxDQUFBO0FBRTlDckIsTUFBQUEsTUFBTSxDQUFDK0QsSUFBSSxDQUFDdkUsU0FBUyxDQUFDLENBQUE7QUFFdEI2QyxNQUFBQSxhQUFhLENBQUMyQixZQUFZLENBQUNoRSxNQUFNLENBQUMsQ0FBQTtBQUN0QyxLQUFBO0FBQ0osR0FBQTtBQUNKOzs7OyJ9
