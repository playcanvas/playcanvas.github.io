import { Debug, DebugHelper } from '../../../core/debug.js';
import { SAMPLETYPE_FLOAT, SAMPLETYPE_UNFILTERABLE_FLOAT, SAMPLETYPE_DEPTH } from '../constants.js';
import { WebgpuUtils } from './webgpu-utils.js';

const samplerTypes = [];
samplerTypes[SAMPLETYPE_FLOAT] = 'filtering';
samplerTypes[SAMPLETYPE_UNFILTERABLE_FLOAT] = 'non-filtering';
samplerTypes[SAMPLETYPE_DEPTH] = 'comparison';
const sampleTypes = [];
sampleTypes[SAMPLETYPE_FLOAT] = 'float';
sampleTypes[SAMPLETYPE_UNFILTERABLE_FLOAT] = 'unfilterable-float';
sampleTypes[SAMPLETYPE_DEPTH] = 'depth';

/**
 * A WebGPU implementation of the BindGroupFormat, which is a wrapper over GPUBindGroupLayout.
 *
 * @ignore
 */
class WebgpuBindGroupFormat {
  /**
   * @param {import('../bind-group-format.js').BindGroupFormat} bindGroupFormat - Bind group format.
   */
  constructor(bindGroupFormat) {
    /** @type {import('./webgpu-graphics-device.js').WebgpuGraphicsDevice} */
    const device = bindGroupFormat.device;
    const {
      key,
      descr
    } = this.createDescriptor(bindGroupFormat);

    /**
     * Unique key, used for caching
     *
     * @type {string}
     */
    this.key = key;

    // keep descr in debug mode
    Debug.call(() => {
      this.descr = descr;
    });

    /**
     * @type {GPUBindGroupLayout}
     * @private
     */
    this.bindGroupLayout = device.wgpu.createBindGroupLayout(descr);
    DebugHelper.setLabel(this.bindGroupLayout, bindGroupFormat.name);
  }
  destroy() {
    this.bindGroupLayout = null;
  }
  loseContext() {
    // this.bindGroupLayout = null;
  }

  /**
   * Returns texture binding slot.
   *
   * @param {import('../bind-group-format.js').BindGroupFormat} bindGroupFormat - Bind group format.
   * @param {number} index - The index of the texture.
   * @returns {number} - The slot index.
   */
  getTextureSlot(bindGroupFormat, index) {
    // each texture takes 2 slots (texture, sampler) and those are added after uniform buffers
    return bindGroupFormat.bufferFormats.length + index * 2;
  }

  /**
   * @param {any} bindGroupFormat - The format of the bind group.
   * @returns {any} Returns the bind group descriptor.
   */
  createDescriptor(bindGroupFormat) {
    // all WebGPU bindings:
    // - buffer: GPUBufferBindingLayout, resource type is GPUBufferBinding
    // - sampler: GPUSamplerBindingLayout, resource type is GPUSampler
    // - texture: GPUTextureBindingLayout, resource type is GPUTextureView
    // - storageTexture: GPUStorageTextureBindingLayout, resource type is GPUTextureView
    // - externalTexture: GPUExternalTextureBindingLayout, resource type is GPUExternalTexture
    const entries = [];

    // generate unique key
    let key = '';
    let index = 0;
    bindGroupFormat.bufferFormats.forEach(bufferFormat => {
      const visibility = WebgpuUtils.shaderStage(bufferFormat.visibility);
      key += `#${index}U:${visibility}`;
      entries.push({
        binding: index++,
        visibility: visibility,
        buffer: {
          type: 'uniform',
          // "uniform", "storage", "read-only-storage"

          // whether this binding requires a dynamic offset
          hasDynamicOffset: false

          // defaults to 0 meaning no validation, can do early size validation using it
          // minBindingSize
        }
      });
    });

    bindGroupFormat.textureFormats.forEach(textureFormat => {
      const visibility = WebgpuUtils.shaderStage(textureFormat.visibility);

      // texture
      const sampleType = textureFormat.sampleType;
      const viewDimension = textureFormat.textureDimension;
      const multisampled = false;
      const gpuSampleType = sampleTypes[sampleType];
      Debug.assert(gpuSampleType);
      key += `#${index}T:${visibility}-${gpuSampleType}-${viewDimension}-${multisampled}`;
      entries.push({
        binding: index++,
        visibility: visibility,
        texture: {
          // Indicates the type required for texture views bound to this binding.
          // "float", "unfilterable-float", "depth", "sint", "uint",
          sampleType: gpuSampleType,
          // Indicates the required dimension for texture views bound to this binding.
          // "1d", "2d", "2d-array", "cube", "cube-array", "3d"
          viewDimension: viewDimension,
          // Indicates whether or not texture views bound to this binding must be multisampled
          multisampled: multisampled
        }
      });

      // sampler
      const gpuSamplerType = samplerTypes[sampleType];
      Debug.assert(gpuSamplerType);
      key += `#${index}S:${visibility}-${gpuSamplerType}`;
      entries.push({
        binding: index++,
        visibility: visibility,
        sampler: {
          // Indicates the required type of a sampler bound to this bindings
          // 'filtering', 'non-filtering', 'comparison'
          type: gpuSamplerType
        }
      });
    });

    /** @type {GPUBindGroupLayoutDescriptor} */
    const descr = {
      entries: entries
    };
    return {
      key,
      descr
    };
  }
}

export { WebgpuBindGroupFormat };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LWJpbmQtZ3JvdXAtZm9ybWF0LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvcGxhdGZvcm0vZ3JhcGhpY3Mvd2ViZ3B1L3dlYmdwdS1iaW5kLWdyb3VwLWZvcm1hdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWJ1ZywgRGVidWdIZWxwZXIgfSBmcm9tICcuLi8uLi8uLi9jb3JlL2RlYnVnLmpzJztcbmltcG9ydCB7IFNBTVBMRVRZUEVfRkxPQVQsIFNBTVBMRVRZUEVfVU5GSUxURVJBQkxFX0ZMT0FULCBTQU1QTEVUWVBFX0RFUFRIIH0gZnJvbSAnLi4vY29uc3RhbnRzLmpzJztcblxuaW1wb3J0IHsgV2ViZ3B1VXRpbHMgfSBmcm9tICcuL3dlYmdwdS11dGlscy5qcyc7XG5cbmNvbnN0IHNhbXBsZXJUeXBlcyA9IFtdO1xuc2FtcGxlclR5cGVzW1NBTVBMRVRZUEVfRkxPQVRdID0gJ2ZpbHRlcmluZyc7XG5zYW1wbGVyVHlwZXNbU0FNUExFVFlQRV9VTkZJTFRFUkFCTEVfRkxPQVRdID0gJ25vbi1maWx0ZXJpbmcnO1xuc2FtcGxlclR5cGVzW1NBTVBMRVRZUEVfREVQVEhdID0gJ2NvbXBhcmlzb24nO1xuXG5jb25zdCBzYW1wbGVUeXBlcyA9IFtdO1xuc2FtcGxlVHlwZXNbU0FNUExFVFlQRV9GTE9BVF0gPSAnZmxvYXQnO1xuc2FtcGxlVHlwZXNbU0FNUExFVFlQRV9VTkZJTFRFUkFCTEVfRkxPQVRdID0gJ3VuZmlsdGVyYWJsZS1mbG9hdCc7XG5zYW1wbGVUeXBlc1tTQU1QTEVUWVBFX0RFUFRIXSA9ICdkZXB0aCc7XG5cbi8qKlxuICogQSBXZWJHUFUgaW1wbGVtZW50YXRpb24gb2YgdGhlIEJpbmRHcm91cEZvcm1hdCwgd2hpY2ggaXMgYSB3cmFwcGVyIG92ZXIgR1BVQmluZEdyb3VwTGF5b3V0LlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgV2ViZ3B1QmluZEdyb3VwRm9ybWF0IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYmluZC1ncm91cC1mb3JtYXQuanMnKS5CaW5kR3JvdXBGb3JtYXR9IGJpbmRHcm91cEZvcm1hdCAtIEJpbmQgZ3JvdXAgZm9ybWF0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGJpbmRHcm91cEZvcm1hdCkge1xuXG4gICAgICAgIC8qKiBAdHlwZSB7aW1wb3J0KCcuL3dlYmdwdS1ncmFwaGljcy1kZXZpY2UuanMnKS5XZWJncHVHcmFwaGljc0RldmljZX0gKi9cbiAgICAgICAgY29uc3QgZGV2aWNlID0gYmluZEdyb3VwRm9ybWF0LmRldmljZTtcblxuICAgICAgICBjb25zdCB7IGtleSwgZGVzY3IgfSA9IHRoaXMuY3JlYXRlRGVzY3JpcHRvcihiaW5kR3JvdXBGb3JtYXQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVbmlxdWUga2V5LCB1c2VkIGZvciBjYWNoaW5nXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcblxuICAgICAgICAvLyBrZWVwIGRlc2NyIGluIGRlYnVnIG1vZGVcbiAgICAgICAgRGVidWcuY2FsbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRlc2NyID0gZGVzY3I7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7R1BVQmluZEdyb3VwTGF5b3V0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5iaW5kR3JvdXBMYXlvdXQgPSBkZXZpY2Uud2dwdS5jcmVhdGVCaW5kR3JvdXBMYXlvdXQoZGVzY3IpO1xuICAgICAgICBEZWJ1Z0hlbHBlci5zZXRMYWJlbCh0aGlzLmJpbmRHcm91cExheW91dCwgYmluZEdyb3VwRm9ybWF0Lm5hbWUpO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuYmluZEdyb3VwTGF5b3V0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBsb3NlQ29udGV4dCgpIHtcbiAgICAgICAgLy8gdGhpcy5iaW5kR3JvdXBMYXlvdXQgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGV4dHVyZSBiaW5kaW5nIHNsb3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYmluZC1ncm91cC1mb3JtYXQuanMnKS5CaW5kR3JvdXBGb3JtYXR9IGJpbmRHcm91cEZvcm1hdCAtIEJpbmQgZ3JvdXAgZm9ybWF0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBpbmRleCBvZiB0aGUgdGV4dHVyZS5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFRoZSBzbG90IGluZGV4LlxuICAgICAqL1xuICAgIGdldFRleHR1cmVTbG90KGJpbmRHcm91cEZvcm1hdCwgaW5kZXgpIHtcbiAgICAgICAgLy8gZWFjaCB0ZXh0dXJlIHRha2VzIDIgc2xvdHMgKHRleHR1cmUsIHNhbXBsZXIpIGFuZCB0aG9zZSBhcmUgYWRkZWQgYWZ0ZXIgdW5pZm9ybSBidWZmZXJzXG4gICAgICAgIHJldHVybiBiaW5kR3JvdXBGb3JtYXQuYnVmZmVyRm9ybWF0cy5sZW5ndGggKyBpbmRleCAqIDI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHthbnl9IGJpbmRHcm91cEZvcm1hdCAtIFRoZSBmb3JtYXQgb2YgdGhlIGJpbmQgZ3JvdXAuXG4gICAgICogQHJldHVybnMge2FueX0gUmV0dXJucyB0aGUgYmluZCBncm91cCBkZXNjcmlwdG9yLlxuICAgICAqL1xuICAgIGNyZWF0ZURlc2NyaXB0b3IoYmluZEdyb3VwRm9ybWF0KSB7XG4gICAgICAgIC8vIGFsbCBXZWJHUFUgYmluZGluZ3M6XG4gICAgICAgIC8vIC0gYnVmZmVyOiBHUFVCdWZmZXJCaW5kaW5nTGF5b3V0LCByZXNvdXJjZSB0eXBlIGlzIEdQVUJ1ZmZlckJpbmRpbmdcbiAgICAgICAgLy8gLSBzYW1wbGVyOiBHUFVTYW1wbGVyQmluZGluZ0xheW91dCwgcmVzb3VyY2UgdHlwZSBpcyBHUFVTYW1wbGVyXG4gICAgICAgIC8vIC0gdGV4dHVyZTogR1BVVGV4dHVyZUJpbmRpbmdMYXlvdXQsIHJlc291cmNlIHR5cGUgaXMgR1BVVGV4dHVyZVZpZXdcbiAgICAgICAgLy8gLSBzdG9yYWdlVGV4dHVyZTogR1BVU3RvcmFnZVRleHR1cmVCaW5kaW5nTGF5b3V0LCByZXNvdXJjZSB0eXBlIGlzIEdQVVRleHR1cmVWaWV3XG4gICAgICAgIC8vIC0gZXh0ZXJuYWxUZXh0dXJlOiBHUFVFeHRlcm5hbFRleHR1cmVCaW5kaW5nTGF5b3V0LCByZXNvdXJjZSB0eXBlIGlzIEdQVUV4dGVybmFsVGV4dHVyZVxuICAgICAgICBjb25zdCBlbnRyaWVzID0gW107XG5cbiAgICAgICAgLy8gZ2VuZXJhdGUgdW5pcXVlIGtleVxuICAgICAgICBsZXQga2V5ID0gJyc7XG5cbiAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgYmluZEdyb3VwRm9ybWF0LmJ1ZmZlckZvcm1hdHMuZm9yRWFjaCgoYnVmZmVyRm9ybWF0KSA9PiB7XG5cbiAgICAgICAgICAgIGNvbnN0IHZpc2liaWxpdHkgPSBXZWJncHVVdGlscy5zaGFkZXJTdGFnZShidWZmZXJGb3JtYXQudmlzaWJpbGl0eSk7XG4gICAgICAgICAgICBrZXkgKz0gYCMke2luZGV4fVU6JHt2aXNpYmlsaXR5fWA7XG5cbiAgICAgICAgICAgIGVudHJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgYmluZGluZzogaW5kZXgrKyxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmlsaXR5LFxuXG4gICAgICAgICAgICAgICAgYnVmZmVyOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3VuaWZvcm0nLCAvLyBcInVuaWZvcm1cIiwgXCJzdG9yYWdlXCIsIFwicmVhZC1vbmx5LXN0b3JhZ2VcIlxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZXRoZXIgdGhpcyBiaW5kaW5nIHJlcXVpcmVzIGEgZHluYW1pYyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgaGFzRHluYW1pY09mZnNldDogZmFsc2VcblxuICAgICAgICAgICAgICAgICAgICAvLyBkZWZhdWx0cyB0byAwIG1lYW5pbmcgbm8gdmFsaWRhdGlvbiwgY2FuIGRvIGVhcmx5IHNpemUgdmFsaWRhdGlvbiB1c2luZyBpdFxuICAgICAgICAgICAgICAgICAgICAvLyBtaW5CaW5kaW5nU2l6ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBiaW5kR3JvdXBGb3JtYXQudGV4dHVyZUZvcm1hdHMuZm9yRWFjaCgodGV4dHVyZUZvcm1hdCkgPT4ge1xuXG4gICAgICAgICAgICBjb25zdCB2aXNpYmlsaXR5ID0gV2ViZ3B1VXRpbHMuc2hhZGVyU3RhZ2UodGV4dHVyZUZvcm1hdC52aXNpYmlsaXR5KTtcblxuICAgICAgICAgICAgLy8gdGV4dHVyZVxuICAgICAgICAgICAgY29uc3Qgc2FtcGxlVHlwZSA9IHRleHR1cmVGb3JtYXQuc2FtcGxlVHlwZTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXdEaW1lbnNpb24gPSB0ZXh0dXJlRm9ybWF0LnRleHR1cmVEaW1lbnNpb247XG4gICAgICAgICAgICBjb25zdCBtdWx0aXNhbXBsZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgY29uc3QgZ3B1U2FtcGxlVHlwZSA9IHNhbXBsZVR5cGVzW3NhbXBsZVR5cGVdO1xuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KGdwdVNhbXBsZVR5cGUpO1xuXG4gICAgICAgICAgICBrZXkgKz0gYCMke2luZGV4fVQ6JHt2aXNpYmlsaXR5fS0ke2dwdVNhbXBsZVR5cGV9LSR7dmlld0RpbWVuc2lvbn0tJHttdWx0aXNhbXBsZWR9YDtcblxuICAgICAgICAgICAgZW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiBpbmRleCsrLFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IHZpc2liaWxpdHksXG4gICAgICAgICAgICAgICAgdGV4dHVyZToge1xuICAgICAgICAgICAgICAgICAgICAvLyBJbmRpY2F0ZXMgdGhlIHR5cGUgcmVxdWlyZWQgZm9yIHRleHR1cmUgdmlld3MgYm91bmQgdG8gdGhpcyBiaW5kaW5nLlxuICAgICAgICAgICAgICAgICAgICAvLyBcImZsb2F0XCIsIFwidW5maWx0ZXJhYmxlLWZsb2F0XCIsIFwiZGVwdGhcIiwgXCJzaW50XCIsIFwidWludFwiLFxuICAgICAgICAgICAgICAgICAgICBzYW1wbGVUeXBlOiBncHVTYW1wbGVUeXBlLFxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEluZGljYXRlcyB0aGUgcmVxdWlyZWQgZGltZW5zaW9uIGZvciB0ZXh0dXJlIHZpZXdzIGJvdW5kIHRvIHRoaXMgYmluZGluZy5cbiAgICAgICAgICAgICAgICAgICAgLy8gXCIxZFwiLCBcIjJkXCIsIFwiMmQtYXJyYXlcIiwgXCJjdWJlXCIsIFwiY3ViZS1hcnJheVwiLCBcIjNkXCJcbiAgICAgICAgICAgICAgICAgICAgdmlld0RpbWVuc2lvbjogdmlld0RpbWVuc2lvbixcblxuICAgICAgICAgICAgICAgICAgICAvLyBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdGV4dHVyZSB2aWV3cyBib3VuZCB0byB0aGlzIGJpbmRpbmcgbXVzdCBiZSBtdWx0aXNhbXBsZWRcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlzYW1wbGVkOiBtdWx0aXNhbXBsZWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gc2FtcGxlclxuICAgICAgICAgICAgY29uc3QgZ3B1U2FtcGxlclR5cGUgPSBzYW1wbGVyVHlwZXNbc2FtcGxlVHlwZV07XG4gICAgICAgICAgICBEZWJ1Zy5hc3NlcnQoZ3B1U2FtcGxlclR5cGUpO1xuXG4gICAgICAgICAgICBrZXkgKz0gYCMke2luZGV4fVM6JHt2aXNpYmlsaXR5fS0ke2dwdVNhbXBsZXJUeXBlfWA7XG5cbiAgICAgICAgICAgIGVudHJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgYmluZGluZzogaW5kZXgrKyxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmlsaXR5LFxuICAgICAgICAgICAgICAgIHNhbXBsZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSW5kaWNhdGVzIHRoZSByZXF1aXJlZCB0eXBlIG9mIGEgc2FtcGxlciBib3VuZCB0byB0aGlzIGJpbmRpbmdzXG4gICAgICAgICAgICAgICAgICAgIC8vICdmaWx0ZXJpbmcnLCAnbm9uLWZpbHRlcmluZycsICdjb21wYXJpc29uJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBncHVTYW1wbGVyVHlwZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiogQHR5cGUge0dQVUJpbmRHcm91cExheW91dERlc2NyaXB0b3J9ICovXG4gICAgICAgIGNvbnN0IGRlc2NyID0ge1xuICAgICAgICAgICAgZW50cmllczogZW50cmllc1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXksXG4gICAgICAgICAgICBkZXNjclxuICAgICAgICB9O1xuICAgIH1cbn1cblxuZXhwb3J0IHsgV2ViZ3B1QmluZEdyb3VwRm9ybWF0IH07XG4iXSwibmFtZXMiOlsic2FtcGxlclR5cGVzIiwiU0FNUExFVFlQRV9GTE9BVCIsIlNBTVBMRVRZUEVfVU5GSUxURVJBQkxFX0ZMT0FUIiwiU0FNUExFVFlQRV9ERVBUSCIsInNhbXBsZVR5cGVzIiwiV2ViZ3B1QmluZEdyb3VwRm9ybWF0IiwiY29uc3RydWN0b3IiLCJiaW5kR3JvdXBGb3JtYXQiLCJkZXZpY2UiLCJrZXkiLCJkZXNjciIsImNyZWF0ZURlc2NyaXB0b3IiLCJEZWJ1ZyIsImNhbGwiLCJiaW5kR3JvdXBMYXlvdXQiLCJ3Z3B1IiwiY3JlYXRlQmluZEdyb3VwTGF5b3V0IiwiRGVidWdIZWxwZXIiLCJzZXRMYWJlbCIsIm5hbWUiLCJkZXN0cm95IiwibG9zZUNvbnRleHQiLCJnZXRUZXh0dXJlU2xvdCIsImluZGV4IiwiYnVmZmVyRm9ybWF0cyIsImxlbmd0aCIsImVudHJpZXMiLCJmb3JFYWNoIiwiYnVmZmVyRm9ybWF0IiwidmlzaWJpbGl0eSIsIldlYmdwdVV0aWxzIiwic2hhZGVyU3RhZ2UiLCJwdXNoIiwiYmluZGluZyIsImJ1ZmZlciIsInR5cGUiLCJoYXNEeW5hbWljT2Zmc2V0IiwidGV4dHVyZUZvcm1hdHMiLCJ0ZXh0dXJlRm9ybWF0Iiwic2FtcGxlVHlwZSIsInZpZXdEaW1lbnNpb24iLCJ0ZXh0dXJlRGltZW5zaW9uIiwibXVsdGlzYW1wbGVkIiwiZ3B1U2FtcGxlVHlwZSIsImFzc2VydCIsInRleHR1cmUiLCJncHVTYW1wbGVyVHlwZSIsInNhbXBsZXIiXSwibWFwcGluZ3MiOiI7Ozs7QUFLQSxNQUFNQSxZQUFZLEdBQUcsRUFBRSxDQUFBO0FBQ3ZCQSxZQUFZLENBQUNDLGdCQUFnQixDQUFDLEdBQUcsV0FBVyxDQUFBO0FBQzVDRCxZQUFZLENBQUNFLDZCQUE2QixDQUFDLEdBQUcsZUFBZSxDQUFBO0FBQzdERixZQUFZLENBQUNHLGdCQUFnQixDQUFDLEdBQUcsWUFBWSxDQUFBO0FBRTdDLE1BQU1DLFdBQVcsR0FBRyxFQUFFLENBQUE7QUFDdEJBLFdBQVcsQ0FBQ0gsZ0JBQWdCLENBQUMsR0FBRyxPQUFPLENBQUE7QUFDdkNHLFdBQVcsQ0FBQ0YsNkJBQTZCLENBQUMsR0FBRyxvQkFBb0IsQ0FBQTtBQUNqRUUsV0FBVyxDQUFDRCxnQkFBZ0IsQ0FBQyxHQUFHLE9BQU8sQ0FBQTs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1FLHFCQUFxQixDQUFDO0FBQ3hCO0FBQ0o7QUFDQTtFQUNJQyxXQUFXQSxDQUFDQyxlQUFlLEVBQUU7QUFFekI7QUFDQSxJQUFBLE1BQU1DLE1BQU0sR0FBR0QsZUFBZSxDQUFDQyxNQUFNLENBQUE7SUFFckMsTUFBTTtNQUFFQyxHQUFHO0FBQUVDLE1BQUFBLEtBQUFBO0FBQU0sS0FBQyxHQUFHLElBQUksQ0FBQ0MsZ0JBQWdCLENBQUNKLGVBQWUsQ0FBQyxDQUFBOztBQUU3RDtBQUNSO0FBQ0E7QUFDQTtBQUNBO0lBQ1EsSUFBSSxDQUFDRSxHQUFHLEdBQUdBLEdBQUcsQ0FBQTs7QUFFZDtJQUNBRyxLQUFLLENBQUNDLElBQUksQ0FBQyxNQUFNO01BQ2IsSUFBSSxDQUFDSCxLQUFLLEdBQUdBLEtBQUssQ0FBQTtBQUN0QixLQUFDLENBQUMsQ0FBQTs7QUFFRjtBQUNSO0FBQ0E7QUFDQTtJQUNRLElBQUksQ0FBQ0ksZUFBZSxHQUFHTixNQUFNLENBQUNPLElBQUksQ0FBQ0MscUJBQXFCLENBQUNOLEtBQUssQ0FBQyxDQUFBO0lBQy9ETyxXQUFXLENBQUNDLFFBQVEsQ0FBQyxJQUFJLENBQUNKLGVBQWUsRUFBRVAsZUFBZSxDQUFDWSxJQUFJLENBQUMsQ0FBQTtBQUNwRSxHQUFBO0FBRUFDLEVBQUFBLE9BQU9BLEdBQUc7SUFDTixJQUFJLENBQUNOLGVBQWUsR0FBRyxJQUFJLENBQUE7QUFDL0IsR0FBQTtBQUVBTyxFQUFBQSxXQUFXQSxHQUFHO0FBQ1Y7QUFBQSxHQUFBOztBQUdKO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLGNBQWNBLENBQUNmLGVBQWUsRUFBRWdCLEtBQUssRUFBRTtBQUNuQztJQUNBLE9BQU9oQixlQUFlLENBQUNpQixhQUFhLENBQUNDLE1BQU0sR0FBR0YsS0FBSyxHQUFHLENBQUMsQ0FBQTtBQUMzRCxHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0VBQ0laLGdCQUFnQkEsQ0FBQ0osZUFBZSxFQUFFO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtJQUNBLE1BQU1tQixPQUFPLEdBQUcsRUFBRSxDQUFBOztBQUVsQjtJQUNBLElBQUlqQixHQUFHLEdBQUcsRUFBRSxDQUFBO0lBRVosSUFBSWMsS0FBSyxHQUFHLENBQUMsQ0FBQTtBQUNiaEIsSUFBQUEsZUFBZSxDQUFDaUIsYUFBYSxDQUFDRyxPQUFPLENBQUVDLFlBQVksSUFBSztNQUVwRCxNQUFNQyxVQUFVLEdBQUdDLFdBQVcsQ0FBQ0MsV0FBVyxDQUFDSCxZQUFZLENBQUNDLFVBQVUsQ0FBQyxDQUFBO0FBQ25FcEIsTUFBQUEsR0FBRyxJQUFLLENBQUEsQ0FBQSxFQUFHYyxLQUFNLENBQUEsRUFBQSxFQUFJTSxVQUFXLENBQUMsQ0FBQSxDQUFBO01BRWpDSCxPQUFPLENBQUNNLElBQUksQ0FBQztRQUNUQyxPQUFPLEVBQUVWLEtBQUssRUFBRTtBQUNoQk0sUUFBQUEsVUFBVSxFQUFFQSxVQUFVO0FBRXRCSyxRQUFBQSxNQUFNLEVBQUU7QUFFSkMsVUFBQUEsSUFBSSxFQUFFLFNBQVM7QUFBRTs7QUFFakI7QUFDQUMsVUFBQUEsZ0JBQWdCLEVBQUUsS0FBQTs7QUFFbEI7QUFDQTtBQUNKLFNBQUE7QUFDSixPQUFDLENBQUMsQ0FBQTtBQUNOLEtBQUMsQ0FBQyxDQUFBOztBQUVGN0IsSUFBQUEsZUFBZSxDQUFDOEIsY0FBYyxDQUFDVixPQUFPLENBQUVXLGFBQWEsSUFBSztNQUV0RCxNQUFNVCxVQUFVLEdBQUdDLFdBQVcsQ0FBQ0MsV0FBVyxDQUFDTyxhQUFhLENBQUNULFVBQVUsQ0FBQyxDQUFBOztBQUVwRTtBQUNBLE1BQUEsTUFBTVUsVUFBVSxHQUFHRCxhQUFhLENBQUNDLFVBQVUsQ0FBQTtBQUMzQyxNQUFBLE1BQU1DLGFBQWEsR0FBR0YsYUFBYSxDQUFDRyxnQkFBZ0IsQ0FBQTtNQUNwRCxNQUFNQyxZQUFZLEdBQUcsS0FBSyxDQUFBO0FBRTFCLE1BQUEsTUFBTUMsYUFBYSxHQUFHdkMsV0FBVyxDQUFDbUMsVUFBVSxDQUFDLENBQUE7QUFDN0MzQixNQUFBQSxLQUFLLENBQUNnQyxNQUFNLENBQUNELGFBQWEsQ0FBQyxDQUFBO01BRTNCbEMsR0FBRyxJQUFLLENBQUdjLENBQUFBLEVBQUFBLEtBQU0sQ0FBSU0sRUFBQUEsRUFBQUEsVUFBVyxDQUFHYyxDQUFBQSxFQUFBQSxhQUFjLENBQUdILENBQUFBLEVBQUFBLGFBQWMsQ0FBR0UsQ0FBQUEsRUFBQUEsWUFBYSxDQUFDLENBQUEsQ0FBQTtNQUVuRmhCLE9BQU8sQ0FBQ00sSUFBSSxDQUFDO1FBQ1RDLE9BQU8sRUFBRVYsS0FBSyxFQUFFO0FBQ2hCTSxRQUFBQSxVQUFVLEVBQUVBLFVBQVU7QUFDdEJnQixRQUFBQSxPQUFPLEVBQUU7QUFDTDtBQUNBO0FBQ0FOLFVBQUFBLFVBQVUsRUFBRUksYUFBYTtBQUV6QjtBQUNBO0FBQ0FILFVBQUFBLGFBQWEsRUFBRUEsYUFBYTtBQUU1QjtBQUNBRSxVQUFBQSxZQUFZLEVBQUVBLFlBQUFBO0FBQ2xCLFNBQUE7QUFDSixPQUFDLENBQUMsQ0FBQTs7QUFFRjtBQUNBLE1BQUEsTUFBTUksY0FBYyxHQUFHOUMsWUFBWSxDQUFDdUMsVUFBVSxDQUFDLENBQUE7QUFDL0MzQixNQUFBQSxLQUFLLENBQUNnQyxNQUFNLENBQUNFLGNBQWMsQ0FBQyxDQUFBO0FBRTVCckMsTUFBQUEsR0FBRyxJQUFLLENBQUdjLENBQUFBLEVBQUFBLEtBQU0sS0FBSU0sVUFBVyxDQUFBLENBQUEsRUFBR2lCLGNBQWUsQ0FBQyxDQUFBLENBQUE7TUFFbkRwQixPQUFPLENBQUNNLElBQUksQ0FBQztRQUNUQyxPQUFPLEVBQUVWLEtBQUssRUFBRTtBQUNoQk0sUUFBQUEsVUFBVSxFQUFFQSxVQUFVO0FBQ3RCa0IsUUFBQUEsT0FBTyxFQUFFO0FBQ0w7QUFDQTtBQUNBWixVQUFBQSxJQUFJLEVBQUVXLGNBQUFBO0FBQ1YsU0FBQTtBQUNKLE9BQUMsQ0FBQyxDQUFBO0FBQ04sS0FBQyxDQUFDLENBQUE7O0FBRUY7QUFDQSxJQUFBLE1BQU1wQyxLQUFLLEdBQUc7QUFDVmdCLE1BQUFBLE9BQU8sRUFBRUEsT0FBQUE7S0FDWixDQUFBO0lBRUQsT0FBTztNQUNIakIsR0FBRztBQUNIQyxNQUFBQSxLQUFBQTtLQUNILENBQUE7QUFDTCxHQUFBO0FBQ0o7Ozs7In0=
