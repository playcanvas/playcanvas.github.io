/**
 * @license
 * PlayCanvas Engine v1.57.1 revision 256dd83c2 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../core/debug.js';
import { Color } from '../math/color.js';
import { Curve } from '../math/curve.js';
import { CurveSet } from '../math/curve-set.js';
import { Vec2 } from '../math/vec2.js';
import { Vec3 } from '../math/vec3.js';
import { Vec4 } from '../math/vec4.js';
import { GraphNode } from '../scene/graph-node.js';
import { Asset } from '../asset/asset.js';
import './script-type.js';

const components = ['x', 'y', 'z', 'w'];
const vecLookup = [undefined, undefined, Vec2, Vec3, Vec4];

function rawToValue(app, args, value, old) {
  switch (args.type) {
    case 'boolean':
      return !!value;

    case 'number':
      if (typeof value === 'number') {
        return value;
      } else if (typeof value === 'string') {
        const v = parseInt(value, 10);
        if (isNaN(v)) return null;
        return v;
      } else if (typeof value === 'boolean') {
        return 0 + value;
      }

      return null;

    case 'json':
      {
        const result = {};

        if (Array.isArray(args.schema)) {
          if (!value || typeof value !== 'object') {
            value = {};
          }

          for (let i = 0; i < args.schema.length; i++) {
            const field = args.schema[i];
            if (!field.name) continue;

            if (field.array) {
              result[field.name] = [];
              const arr = Array.isArray(value[field.name]) ? value[field.name] : [];

              for (let j = 0; j < arr.length; j++) {
                result[field.name].push(rawToValue(app, field, arr[j]));
              }
            } else {
              const val = value.hasOwnProperty(field.name) ? value[field.name] : field.default;
              result[field.name] = rawToValue(app, field, val);
            }
          }
        }

        return result;
      }

    case 'asset':
      if (value instanceof Asset) {
        return value;
      } else if (typeof value === 'number') {
        return app.assets.get(value) || null;
      } else if (typeof value === 'string') {
        return app.assets.get(parseInt(value, 10)) || null;
      }

      return null;

    case 'entity':
      if (value instanceof GraphNode) {
        return value;
      } else if (typeof value === 'string') {
        return app.getEntityFromIndex(value);
      }

      return null;

    case 'rgb':
    case 'rgba':
      if (value instanceof Color) {
        if (old instanceof Color) {
          old.copy(value);
          return old;
        }

        return value.clone();
      } else if (value instanceof Array && value.length >= 3 && value.length <= 4) {
        for (let i = 0; i < value.length; i++) {
          if (typeof value[i] !== 'number') return null;
        }

        if (!old) old = new Color();
        old.r = value[0];
        old.g = value[1];
        old.b = value[2];
        old.a = value.length === 3 ? 1 : value[3];
        return old;
      } else if (typeof value === 'string' && /#([0-9abcdef]{2}){3,4}/i.test(value)) {
        if (!old) old = new Color();
        old.fromString(value);
        return old;
      }

      return null;

    case 'vec2':
    case 'vec3':
    case 'vec4':
      {
        const len = parseInt(args.type.slice(3), 10);
        const vecType = vecLookup[len];

        if (value instanceof vecType) {
          if (old instanceof vecType) {
            old.copy(value);
            return old;
          }

          return value.clone();
        } else if (value instanceof Array && value.length === len) {
          for (let i = 0; i < value.length; i++) {
            if (typeof value[i] !== 'number') return null;
          }

          if (!old) old = new vecType();

          for (let i = 0; i < len; i++) old[components[i]] = value[i];

          return old;
        }

        return null;
      }

    case 'curve':
      if (value) {
        let curve;

        if (value instanceof Curve || value instanceof CurveSet) {
          curve = value.clone();
        } else {
          const CurveType = value.keys[0] instanceof Array ? CurveSet : Curve;
          curve = new CurveType(value.keys);
          curve.type = value.type;
        }

        return curve;
      }

      break;
  }

  return value;
}

class ScriptAttributes {
  constructor(scriptType) {
    this.scriptType = scriptType;
    this.index = {};
  }

  add(name, args) {
    if (this.index[name]) {
      Debug.warn(`attribute '${name}' is already defined for script type '${this.scriptType.name}'`);
      return;
    } else if (ScriptAttributes.reservedNames.has(name)) {
      Debug.warn(`attribute '${name}' is a reserved attribute name`);
      return;
    }

    this.index[name] = args;
    Object.defineProperty(this.scriptType.prototype, name, {
      get: function () {
        return this.__attributes[name];
      },
      set: function (raw) {
        const evt = 'attr';
        const evtName = 'attr:' + name;
        const old = this.__attributes[name];
        let oldCopy = old;

        if (old && args.type !== 'json' && old.clone) {
          if (this._callbacks[evt] || this._callbacks[evtName]) {
            oldCopy = old.clone();
          }
        }

        if (args.array) {
          this.__attributes[name] = [];

          if (raw) {
            for (let i = 0, len = raw.length; i < len; i++) {
              this.__attributes[name].push(rawToValue(this.app, args, raw[i], old ? old[i] : null));
            }
          }
        } else {
          this.__attributes[name] = rawToValue(this.app, args, raw, old);
        }

        this.fire(evt, name, this.__attributes[name], oldCopy);
        this.fire(evtName, this.__attributes[name], oldCopy);
      }
    });
  }

  remove(name) {
    if (!this.index[name]) return false;
    delete this.index[name];
    delete this.scriptType.prototype[name];
    return true;
  }

  has(name) {
    return !!this.index[name];
  }

  get(name) {
    return this.index[name] || null;
  }

}

ScriptAttributes.reservedNames = new Set(['app', 'entity', 'enabled', '_enabled', '_enabledOld', '_destroyed', '__attributes', '__attributesRaw', '__scriptType', '__executionOrder', '_callbacks', 'has', 'get', 'on', 'off', 'fire', 'once', 'hasEvent']);

export { ScriptAttributes };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyaXB0LWF0dHJpYnV0ZXMuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zY3JpcHQvc2NyaXB0LWF0dHJpYnV0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuLi9jb3JlL2RlYnVnLmpzJztcblxuaW1wb3J0IHsgQ29sb3IgfSBmcm9tICcuLi9tYXRoL2NvbG9yLmpzJztcbmltcG9ydCB7IEN1cnZlIH0gZnJvbSAnLi4vbWF0aC9jdXJ2ZS5qcyc7XG5pbXBvcnQgeyBDdXJ2ZVNldCB9IGZyb20gJy4uL21hdGgvY3VydmUtc2V0LmpzJztcbmltcG9ydCB7IFZlYzIgfSBmcm9tICcuLi9tYXRoL3ZlYzIuanMnO1xuaW1wb3J0IHsgVmVjMyB9IGZyb20gJy4uL21hdGgvdmVjMy5qcyc7XG5pbXBvcnQgeyBWZWM0IH0gZnJvbSAnLi4vbWF0aC92ZWM0LmpzJztcblxuaW1wb3J0IHsgR3JhcGhOb2RlIH0gZnJvbSAnLi4vc2NlbmUvZ3JhcGgtbm9kZS5qcyc7XG5cbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vYXNzZXQvYXNzZXQuanMnO1xuXG4vKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMgKi9cbmltcG9ydCB7IFNjcmlwdFR5cGUgfSBmcm9tICcuL3NjcmlwdC10eXBlLmpzJztcblxuY29uc3QgY29tcG9uZW50cyA9IFsneCcsICd5JywgJ3onLCAndyddO1xuY29uc3QgdmVjTG9va3VwID0gW3VuZGVmaW5lZCwgdW5kZWZpbmVkLCBWZWMyLCBWZWMzLCBWZWM0XTtcblxuZnVuY3Rpb24gcmF3VG9WYWx1ZShhcHAsIGFyZ3MsIHZhbHVlLCBvbGQpIHtcbiAgICBzd2l0Y2ggKGFyZ3MudHlwZSkge1xuICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgICAgIHJldHVybiAhIXZhbHVlO1xuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2ID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odikpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiAwICsgdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgY2FzZSAnanNvbic6IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhcmdzLnNjaGVtYSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3Muc2NoZW1hLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gYXJncy5zY2hlbWFbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICghZmllbGQubmFtZSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkLmFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbZmllbGQubmFtZV0gPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJyID0gQXJyYXkuaXNBcnJheSh2YWx1ZVtmaWVsZC5uYW1lXSkgPyB2YWx1ZVtmaWVsZC5uYW1lXSA6IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFyci5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtmaWVsZC5uYW1lXS5wdXNoKHJhd1RvVmFsdWUoYXBwLCBmaWVsZCwgYXJyW2pdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2UgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZCBhcyBpdCdzIHBhc3NlZCBpbnRvIHJhd1RvVmFsdWUgb3RoZXJ3aXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2UgdGhlIGRlZmF1bHQgZmllbGQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IHZhbHVlLmhhc093blByb3BlcnR5KGZpZWxkLm5hbWUpID8gdmFsdWVbZmllbGQubmFtZV0gOiBmaWVsZC5kZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2ZpZWxkLm5hbWVdID0gcmF3VG9WYWx1ZShhcHAsIGZpZWxkLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2Fzc2V0JzpcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFzc2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcC5hc3NldHMuZ2V0KHZhbHVlKSB8fCBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcC5hc3NldHMuZ2V0KHBhcnNlSW50KHZhbHVlLCAxMCkpIHx8IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgY2FzZSAnZW50aXR5JzpcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEdyYXBoTm9kZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcHAuZ2V0RW50aXR5RnJvbUluZGV4KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICBjYXNlICdyZ2InOlxuICAgICAgICBjYXNlICdyZ2JhJzpcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIENvbG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9sZCBpbnN0YW5jZW9mIENvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9sZC5jb3B5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmNsb25lKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgJiYgdmFsdWUubGVuZ3RoID49IDMgJiYgdmFsdWUubGVuZ3RoIDw9IDQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWVbaV0gIT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghb2xkKSBvbGQgPSBuZXcgQ29sb3IoKTtcblxuICAgICAgICAgICAgICAgIG9sZC5yID0gdmFsdWVbMF07XG4gICAgICAgICAgICAgICAgb2xkLmcgPSB2YWx1ZVsxXTtcbiAgICAgICAgICAgICAgICBvbGQuYiA9IHZhbHVlWzJdO1xuICAgICAgICAgICAgICAgIG9sZC5hID0gKHZhbHVlLmxlbmd0aCA9PT0gMykgPyAxIDogdmFsdWVbM107XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gb2xkO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIC8jKFswLTlhYmNkZWZdezJ9KXszLDR9L2kudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9sZClcbiAgICAgICAgICAgICAgICAgICAgb2xkID0gbmV3IENvbG9yKCk7XG5cbiAgICAgICAgICAgICAgICBvbGQuZnJvbVN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICBjYXNlICd2ZWMyJzpcbiAgICAgICAgY2FzZSAndmVjMyc6XG4gICAgICAgIGNhc2UgJ3ZlYzQnOiB7XG4gICAgICAgICAgICBjb25zdCBsZW4gPSBwYXJzZUludChhcmdzLnR5cGUuc2xpY2UoMyksIDEwKTtcbiAgICAgICAgICAgIGNvbnN0IHZlY1R5cGUgPSB2ZWNMb29rdXBbbGVuXTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgdmVjVHlwZSkge1xuICAgICAgICAgICAgICAgIGlmIChvbGQgaW5zdGFuY2VvZiB2ZWNUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9sZC5jb3B5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmNsb25lKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgJiYgdmFsdWUubGVuZ3RoID09PSBsZW4pIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWVbaV0gIT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghb2xkKSBvbGQgPSBuZXcgdmVjVHlwZSgpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKylcbiAgICAgICAgICAgICAgICAgICAgb2xkW2NvbXBvbmVudHNbaV1dID0gdmFsdWVbaV07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gb2xkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnY3VydmUnOlxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbGV0IGN1cnZlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEN1cnZlIHx8IHZhbHVlIGluc3RhbmNlb2YgQ3VydmVTZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VydmUgPSB2YWx1ZS5jbG9uZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IEN1cnZlVHlwZSA9IHZhbHVlLmtleXNbMF0gaW5zdGFuY2VvZiBBcnJheSA/IEN1cnZlU2V0IDogQ3VydmU7XG4gICAgICAgICAgICAgICAgICAgIGN1cnZlID0gbmV3IEN1cnZlVHlwZSh2YWx1ZS5rZXlzKTtcbiAgICAgICAgICAgICAgICAgICAgY3VydmUudHlwZSA9IHZhbHVlLnR5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjdXJ2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuLyoqXG4gKiBDb250YWluZXIgb2YgU2NyaXB0IEF0dHJpYnV0ZSBkZWZpbml0aW9ucy4gSW1wbGVtZW50cyBhbiBpbnRlcmZhY2UgdG8gYWRkL3JlbW92ZSBhdHRyaWJ1dGVzIGFuZFxuICogc3RvcmUgdGhlaXIgZGVmaW5pdGlvbiBmb3IgYSB7QGxpbmsgU2NyaXB0VHlwZX0uIE5vdGU6IEFuIGluc3RhbmNlIG9mIFNjcmlwdEF0dHJpYnV0ZXMgaXNcbiAqIGNyZWF0ZWQgYXV0b21hdGljYWxseSBieSBlYWNoIHtAbGluayBTY3JpcHRUeXBlfS5cbiAqL1xuY2xhc3MgU2NyaXB0QXR0cmlidXRlcyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFNjcmlwdEF0dHJpYnV0ZXMgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0NsYXNzPFNjcmlwdFR5cGU+fSBzY3JpcHRUeXBlIC0gU2NyaXB0IFR5cGUgdGhhdCBhdHRyaWJ1dGVzIHJlbGF0ZSB0by5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzY3JpcHRUeXBlKSB7XG4gICAgICAgIHRoaXMuc2NyaXB0VHlwZSA9IHNjcmlwdFR5cGU7XG4gICAgICAgIHRoaXMuaW5kZXggPSB7fTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcmVzZXJ2ZWROYW1lcyA9IG5ldyBTZXQoW1xuICAgICAgICAnYXBwJywgJ2VudGl0eScsICdlbmFibGVkJywgJ19lbmFibGVkJywgJ19lbmFibGVkT2xkJywgJ19kZXN0cm95ZWQnLFxuICAgICAgICAnX19hdHRyaWJ1dGVzJywgJ19fYXR0cmlidXRlc1JhdycsICdfX3NjcmlwdFR5cGUnLCAnX19leGVjdXRpb25PcmRlcicsXG4gICAgICAgICdfY2FsbGJhY2tzJywgJ2hhcycsICdnZXQnLCAnb24nLCAnb2ZmJywgJ2ZpcmUnLCAnb25jZScsICdoYXNFdmVudCdcbiAgICBdKTtcblxuICAgIC8qKlxuICAgICAqIEFkZCBBdHRyaWJ1dGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIE5hbWUgb2YgYW4gYXR0cmlidXRlLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBhcmdzIC0gT2JqZWN0IHdpdGggQXJndW1lbnRzIGZvciBhbiBhdHRyaWJ1dGUuXG4gICAgICogQHBhcmFtIHsoXCJib29sZWFuXCJ8XCJudW1iZXJcInxcInN0cmluZ1wifFwianNvblwifFwiYXNzZXRcInxcImVudGl0eVwifFwicmdiXCJ8XCJyZ2JhXCJ8XCJ2ZWMyXCJ8XCJ2ZWMzXCJ8XCJ2ZWM0XCJ8XCJjdXJ2ZVwiKX0gYXJncy50eXBlIC0gVHlwZVxuICAgICAqIG9mIGFuIGF0dHJpYnV0ZSB2YWx1ZS4gIENhbiBiZTpcbiAgICAgKlxuICAgICAqIC0gXCJhc3NldFwiXG4gICAgICogLSBcImJvb2xlYW5cIlxuICAgICAqIC0gXCJjdXJ2ZVwiXG4gICAgICogLSBcImVudGl0eVwiXG4gICAgICogLSBcImpzb25cIlxuICAgICAqIC0gXCJudW1iZXJcIlxuICAgICAqIC0gXCJyZ2JcIlxuICAgICAqIC0gXCJyZ2JhXCJcbiAgICAgKiAtIFwic3RyaW5nXCJcbiAgICAgKiAtIFwidmVjMlwiXG4gICAgICogLSBcInZlYzNcIlxuICAgICAqIC0gXCJ2ZWM0XCJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gW2FyZ3MuZGVmYXVsdF0gLSBEZWZhdWx0IGF0dHJpYnV0ZSB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2FyZ3MudGl0bGVdIC0gVGl0bGUgZm9yIEVkaXRvcidzIGZvciBmaWVsZCBVSS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2FyZ3MuZGVzY3JpcHRpb25dIC0gRGVzY3JpcHRpb24gZm9yIEVkaXRvcidzIGZvciBmaWVsZCBVSS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xzdHJpbmdbXX0gW2FyZ3MucGxhY2Vob2xkZXJdIC0gUGxhY2Vob2xkZXIgZm9yIEVkaXRvcidzIGZvciBmaWVsZCBVSS5cbiAgICAgKiBGb3IgbXVsdGktZmllbGQgdHlwZXMsIHN1Y2ggYXMgdmVjMiwgdmVjMywgYW5kIG90aGVycyB1c2UgYXJyYXkgb2Ygc3RyaW5ncy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFthcmdzLmFycmF5XSAtIElmIGF0dHJpYnV0ZSBjYW4gaG9sZCBzaW5nbGUgb3IgbXVsdGlwbGUgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJncy5zaXplXSAtIElmIGF0dHJpYnV0ZSBpcyBhcnJheSwgbWF4aW11bSBudW1iZXIgb2YgdmFsdWVzIGNhbiBiZSBzZXQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthcmdzLm1pbl0gLSBNaW5pbXVtIHZhbHVlIGZvciB0eXBlICdudW1iZXInLCBpZiBtYXggYW5kIG1pbiBkZWZpbmVkLCBzbGlkZXJcbiAgICAgKiB3aWxsIGJlIHJlbmRlcmVkIGluIEVkaXRvcidzIFVJLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJncy5tYXhdIC0gTWF4aW11bSB2YWx1ZSBmb3IgdHlwZSAnbnVtYmVyJywgaWYgbWF4IGFuZCBtaW4gZGVmaW5lZCwgc2xpZGVyXG4gICAgICogd2lsbCBiZSByZW5kZXJlZCBpbiBFZGl0b3IncyBVSS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyZ3MucHJlY2lzaW9uXSAtIExldmVsIG9mIHByZWNpc2lvbiBmb3IgZmllbGQgdHlwZSAnbnVtYmVyJyB3aXRoIGZsb2F0aW5nXG4gICAgICogdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJncy5zdGVwXSAtIFN0ZXAgdmFsdWUgZm9yIHR5cGUgJ251bWJlcicuIFRoZSBhbW91bnQgdXNlZCB0byBpbmNyZW1lbnQgdGhlXG4gICAgICogdmFsdWUgd2hlbiB1c2luZyB0aGUgYXJyb3cga2V5cyBpbiB0aGUgRWRpdG9yJ3MgVUkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFthcmdzLmFzc2V0VHlwZV0gLSBOYW1lIG9mIGFzc2V0IHR5cGUgdG8gYmUgdXNlZCBpbiAnYXNzZXQnIHR5cGUgYXR0cmlidXRlXG4gICAgICogcGlja2VyIGluIEVkaXRvcidzIFVJLCBkZWZhdWx0cyB0byAnKicgKGFsbCkuXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gW2FyZ3MuY3VydmVzXSAtIExpc3Qgb2YgbmFtZXMgZm9yIEN1cnZlcyBmb3IgZmllbGQgdHlwZSAnY3VydmUnLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbYXJncy5jb2xvcl0gLSBTdHJpbmcgb2YgY29sb3IgY2hhbm5lbHMgZm9yIEN1cnZlcyBmb3IgZmllbGQgdHlwZSAnY3VydmUnLFxuICAgICAqIGNhbiBiZSBhbnkgY29tYmluYXRpb24gb2YgYHJnYmFgIGNoYXJhY3RlcnMuIERlZmluaW5nIHRoaXMgcHJvcGVydHkgd2lsbCByZW5kZXIgR3JhZGllbnQgaW5cbiAgICAgKiBFZGl0b3IncyBmaWVsZCBVSS5cbiAgICAgKiBAcGFyYW0ge29iamVjdFtdfSBbYXJncy5lbnVtXSAtIExpc3Qgb2YgZml4ZWQgY2hvaWNlcyBmb3IgZmllbGQsIGRlZmluZWQgYXMgYXJyYXkgb2Ygb2JqZWN0cyxcbiAgICAgKiB3aGVyZSBrZXkgaW4gb2JqZWN0IGlzIGEgdGl0bGUgb2YgYW4gb3B0aW9uLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0W119IFthcmdzLnNjaGVtYV0gLSBMaXN0IG9mIGF0dHJpYnV0ZXMgZm9yIHR5cGUgJ2pzb24nLiBFYWNoIGF0dHJpYnV0ZVxuICAgICAqIGRlc2NyaXB0aW9uIGlzIGFuIG9iamVjdCB3aXRoIHRoZSBzYW1lIHByb3BlcnRpZXMgYXMgcmVndWxhciBzY3JpcHQgYXR0cmlidXRlcyBidXQgd2l0aCBhblxuICAgICAqIGFkZGVkICduYW1lJyBmaWVsZCB0byBzcGVjaWZ5IHRoZSBuYW1lIG9mIGVhY2ggYXR0cmlidXRlIGluIHRoZSBKU09OLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogUGxheWVyQ29udHJvbGxlci5hdHRyaWJ1dGVzLmFkZCgnZnVsbE5hbWUnLCB7XG4gICAgICogICAgIHR5cGU6ICdzdHJpbmcnXG4gICAgICogfSk7XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBQbGF5ZXJDb250cm9sbGVyLmF0dHJpYnV0ZXMuYWRkKCdzcGVlZCcsIHtcbiAgICAgKiAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICogICAgIHRpdGxlOiAnU3BlZWQnLFxuICAgICAqICAgICBwbGFjZWhvbGRlcjogJ2ttL2gnLFxuICAgICAqICAgICBkZWZhdWx0OiAyMi4yXG4gICAgICogfSk7XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBQbGF5ZXJDb250cm9sbGVyLmF0dHJpYnV0ZXMuYWRkKCdyZXNvbHV0aW9uJywge1xuICAgICAqICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgKiAgICAgZGVmYXVsdDogMzIsXG4gICAgICogICAgIGVudW06IFtcbiAgICAgKiAgICAgICAgIHsgJzMyeDMyJzogMzIgfSxcbiAgICAgKiAgICAgICAgIHsgJzY0eDY0JzogNjQgfSxcbiAgICAgKiAgICAgICAgIHsgJzEyOHgxMjgnOiAxMjggfVxuICAgICAqICAgICBdXG4gICAgICogfSk7XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBQbGF5ZXJDb250cm9sbGVyLmF0dHJpYnV0ZXMuYWRkKCdjb25maWcnLCB7XG4gICAgICogICAgIHR5cGU6ICdqc29uJyxcbiAgICAgKiAgICAgc2NoZW1hOiBbe1xuICAgICAqICAgICAgICAgbmFtZTogJ3NwZWVkJyxcbiAgICAgKiAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAqICAgICAgICAgdGl0bGU6ICdTcGVlZCcsXG4gICAgICogICAgICAgICBwbGFjZWhvbGRlcjogJ2ttL2gnLFxuICAgICAqICAgICAgICAgZGVmYXVsdDogMjIuMlxuICAgICAqICAgICB9LCB7XG4gICAgICogICAgICAgICBuYW1lOiAncmVzb2x1dGlvbicsXG4gICAgICogICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgKiAgICAgICAgIGRlZmF1bHQ6IDMyLFxuICAgICAqICAgICAgICAgZW51bTogW1xuICAgICAqICAgICAgICAgICAgIHsgJzMyeDMyJzogMzIgfSxcbiAgICAgKiAgICAgICAgICAgICB7ICc2NHg2NCc6IDY0IH0sXG4gICAgICogICAgICAgICAgICAgeyAnMTI4eDEyOCc6IDEyOCB9XG4gICAgICogICAgICAgICBdXG4gICAgICogICAgIH1dXG4gICAgICogfSk7XG4gICAgICovXG4gICAgYWRkKG5hbWUsIGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5kZXhbbmFtZV0pIHtcbiAgICAgICAgICAgIERlYnVnLndhcm4oYGF0dHJpYnV0ZSAnJHtuYW1lfScgaXMgYWxyZWFkeSBkZWZpbmVkIGZvciBzY3JpcHQgdHlwZSAnJHt0aGlzLnNjcmlwdFR5cGUubmFtZX0nYCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAoU2NyaXB0QXR0cmlidXRlcy5yZXNlcnZlZE5hbWVzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgRGVidWcud2FybihgYXR0cmlidXRlICcke25hbWV9JyBpcyBhIHJlc2VydmVkIGF0dHJpYnV0ZSBuYW1lYCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluZGV4W25hbWVdID0gYXJncztcblxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5zY3JpcHRUeXBlLnByb3RvdHlwZSwgbmFtZSwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19hdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHJhdykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV2dCA9ICdhdHRyJztcbiAgICAgICAgICAgICAgICBjb25zdCBldnROYW1lID0gJ2F0dHI6JyArIG5hbWU7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBvbGQgPSB0aGlzLl9fYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAvLyBrZWVwIGNvcHkgb2Ygb2xkIGZvciB0aGUgZXZlbnQgYmVsb3dcbiAgICAgICAgICAgICAgICBsZXQgb2xkQ29weSA9IG9sZDtcbiAgICAgICAgICAgICAgICAvLyBqc29uIHR5cGVzIG1pZ2h0IGhhdmUgYSAnY2xvbmUnIGZpZWxkIGluIHRoZWlyXG4gICAgICAgICAgICAgICAgLy8gc2NoZW1hIHNvIG1ha2Ugc3VyZSBpdCdzIG5vdCB0aGF0XG4gICAgICAgICAgICAgICAgaWYgKG9sZCAmJiBhcmdzLnR5cGUgIT09ICdqc29uJyAmJiBvbGQuY2xvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgYW4gZXZlbnQgaGFuZGxlciBpcyB0aGVyZVxuICAgICAgICAgICAgICAgICAgICAvLyBiZWZvcmUgY2xvbmluZyBmb3IgcGVyZm9ybWFuY2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrc1tldnRdIHx8IHRoaXMuX2NhbGxiYWNrc1tldnROYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkQ29weSA9IG9sZC5jbG9uZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gY29udmVydCB0byBhcHByb3ByaWF0ZSB0eXBlXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MuYXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX2F0dHJpYnV0ZXNbbmFtZV0gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHJhdy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX19hdHRyaWJ1dGVzW25hbWVdLnB1c2gocmF3VG9WYWx1ZSh0aGlzLmFwcCwgYXJncywgcmF3W2ldLCBvbGQgPyBvbGRbaV0gOiBudWxsKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9fYXR0cmlidXRlc1tuYW1lXSA9IHJhd1RvVmFsdWUodGhpcy5hcHAsIGFyZ3MsIHJhdywgb2xkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoZXZ0LCBuYW1lLCB0aGlzLl9fYXR0cmlidXRlc1tuYW1lXSwgb2xkQ29weSk7XG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKGV2dE5hbWUsIHRoaXMuX19hdHRyaWJ1dGVzW25hbWVdLCBvbGRDb3B5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIEF0dHJpYnV0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gTmFtZSBvZiBhbiBhdHRyaWJ1dGUuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgcmVtb3ZlZCBvciBmYWxzZSBpZiBub3QgZGVmaW5lZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIFBsYXllckNvbnRyb2xsZXIuYXR0cmlidXRlcy5yZW1vdmUoJ2Z1bGxOYW1lJyk7XG4gICAgICovXG4gICAgcmVtb3ZlKG5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmluZGV4W25hbWVdKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGRlbGV0ZSB0aGlzLmluZGV4W25hbWVdO1xuICAgICAgICBkZWxldGUgdGhpcy5zY3JpcHRUeXBlLnByb3RvdHlwZVtuYW1lXTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IGlmIEF0dHJpYnV0ZSBpcyBhZGRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gTmFtZSBvZiBhbiBhdHRyaWJ1dGUuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgQXR0cmlidXRlIGlzIGRlZmluZWQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBpZiAoUGxheWVyQ29udHJvbGxlci5hdHRyaWJ1dGVzLmhhcygnZnVsbE5hbWUnKSkge1xuICAgICAqICAgICAvLyBhdHRyaWJ1dGUgZnVsbE5hbWUgaXMgZGVmaW5lZFxuICAgICAqIH1cbiAgICAgKi9cbiAgICBoYXMobmFtZSkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmluZGV4W25hbWVdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBvYmplY3Qgd2l0aCBhdHRyaWJ1dGUgYXJndW1lbnRzLiBOb3RlOiBDaGFuZ2luZyBhcmd1bWVudCBwcm9wZXJ0aWVzIHdpbGwgbm90IGFmZmVjdFxuICAgICAqIGV4aXN0aW5nIFNjcmlwdCBJbnN0YW5jZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIE5hbWUgb2YgYW4gYXR0cmlidXRlLlxuICAgICAqIEByZXR1cm5zIHs/b2JqZWN0fSBBcmd1bWVudHMgd2l0aCBhdHRyaWJ1dGUgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGNoYW5naW5nIGRlZmF1bHQgdmFsdWUgZm9yIGFuIGF0dHJpYnV0ZSAnZnVsbE5hbWUnXG4gICAgICogdmFyIGF0dHIgPSBQbGF5ZXJDb250cm9sbGVyLmF0dHJpYnV0ZXMuZ2V0KCdmdWxsTmFtZScpO1xuICAgICAqIGlmIChhdHRyKSBhdHRyLmRlZmF1bHQgPSAnVW5rbm93bic7XG4gICAgICovXG4gICAgZ2V0KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhbbmFtZV0gfHwgbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCB7IFNjcmlwdEF0dHJpYnV0ZXMgfTtcbiJdLCJuYW1lcyI6WyJjb21wb25lbnRzIiwidmVjTG9va3VwIiwidW5kZWZpbmVkIiwiVmVjMiIsIlZlYzMiLCJWZWM0IiwicmF3VG9WYWx1ZSIsImFwcCIsImFyZ3MiLCJ2YWx1ZSIsIm9sZCIsInR5cGUiLCJ2IiwicGFyc2VJbnQiLCJpc05hTiIsInJlc3VsdCIsIkFycmF5IiwiaXNBcnJheSIsInNjaGVtYSIsImkiLCJsZW5ndGgiLCJmaWVsZCIsIm5hbWUiLCJhcnJheSIsImFyciIsImoiLCJwdXNoIiwidmFsIiwiaGFzT3duUHJvcGVydHkiLCJkZWZhdWx0IiwiQXNzZXQiLCJhc3NldHMiLCJnZXQiLCJHcmFwaE5vZGUiLCJnZXRFbnRpdHlGcm9tSW5kZXgiLCJDb2xvciIsImNvcHkiLCJjbG9uZSIsInIiLCJnIiwiYiIsImEiLCJ0ZXN0IiwiZnJvbVN0cmluZyIsImxlbiIsInNsaWNlIiwidmVjVHlwZSIsImN1cnZlIiwiQ3VydmUiLCJDdXJ2ZVNldCIsIkN1cnZlVHlwZSIsImtleXMiLCJTY3JpcHRBdHRyaWJ1dGVzIiwiY29uc3RydWN0b3IiLCJzY3JpcHRUeXBlIiwiaW5kZXgiLCJhZGQiLCJEZWJ1ZyIsIndhcm4iLCJyZXNlcnZlZE5hbWVzIiwiaGFzIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJfX2F0dHJpYnV0ZXMiLCJzZXQiLCJyYXciLCJldnQiLCJldnROYW1lIiwib2xkQ29weSIsIl9jYWxsYmFja3MiLCJmaXJlIiwicmVtb3ZlIiwiU2V0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBLE1BQU1BLFVBQVUsR0FBRyxDQUFDLEdBQUQsRUFBTSxHQUFOLEVBQVcsR0FBWCxFQUFnQixHQUFoQixDQUFuQixDQUFBO0FBQ0EsTUFBTUMsU0FBUyxHQUFHLENBQUNDLFNBQUQsRUFBWUEsU0FBWixFQUF1QkMsSUFBdkIsRUFB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
