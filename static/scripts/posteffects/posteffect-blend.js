function BlendEffect(e){pc.PostEffect.call(this,e),this.shader=new pc.Shader(e,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+e.precision+" float;","","uniform float uMixRatio;","uniform sampler2D uColorBuffer;","uniform sampler2D uBlendMap;","","varying vec2 vUv0;","","void main(void)","{","    vec4 texel1 = texture2D(uColorBuffer, vUv0);","    vec4 texel2 = texture2D(uBlendMap, vUv0);","    gl_FragColor = mix(texel1, texel2, uMixRatio);","}"].join("\n")}),this.mixRatio=.5,this.blendMap=new pc.Texture(e),this.blendMap.name="pe-blend"}BlendEffect.prototype=Object.create(pc.PostEffect.prototype),BlendEffect.prototype.constructor=BlendEffect,Object.assign(BlendEffect.prototype,{render:function(e,t,i){var o=this.device,a=o.scope;a.resolve("uMixRatio").setValue(this.mixRatio),a.resolve("uColorBuffer").setValue(e.colorBuffer),a.resolve("uBlendMap").setValue(this.blendMap),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.shader,i)}});var Blend=pc.createScript("blend");Blend.attributes.add("mixRatio",{type:"number",default:.5,min:0,max:1,title:"Mix Ratio"}),Blend.attributes.add("blendMap",{type:"asset",assetType:"texture",title:"Blend Map"}),Blend.prototype.initialize=function(){this.effect=new BlendEffect(this.app.graphicsDevice),this.effect.mixRatio=this.mixRatio,this.blendMap&&(this.effect.blendMap=this.blendMap.resource);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)})),this.on("attr:mixRatio",(function(e){this.effect.mixRatio=e}),this),this.on("attr:blendMap",(function(e){this.effect.blendMap=e?e.resource:null}),this)};